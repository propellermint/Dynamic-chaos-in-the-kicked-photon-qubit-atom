\documentclass[11pt]{article}

    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    
    \usepackage{iftex}
    \ifPDFTeX
    	\usepackage[T1]{fontenc}
    	\usepackage{mathpazo}
    \else
    	\usepackage{fontspec}
    \fi

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range
    \makeatletter % fix for old versions of grffile with XeLaTeX
    \@ifpackagelater{grffile}{2019/11/01}
    {
      % Do nothing on new versions
    }
    {
      \def\Gread@@xetex#1{%
        \IfFileExists{"\Gin@base".bb}%
        {\Gread@eps{\Gin@base.bb}}%
        {\Gread@@xetex@aux#1}%
      }
    }
    \makeatother
    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % common color for the border for error outputs.
    \definecolor{outerrorbackground}{HTML}{FFDFDF}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{Lab\_work}
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb. 
    \makeatletter
        \newbox\Wrappedcontinuationbox 
        \newbox\Wrappedvisiblespacebox 
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}} 
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}} 
        \newcommand*\Wrappedcontinuationindent {3ex } 
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox} 
        % Take advantage of the already applied Pygments mark-up to insert 
        % potential linebreaks for TeX processing. 
        %        {, <, #, %, $, ' and ": go to next line. 
        %        _, }, ^, &, >, - and ~: stay at end of broken line. 
        % Use of \textquotesingle for straight quote. 
        \newcommand*\Wrappedbreaksatspecials {% 
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}% 
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}% 
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}% 
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}% 
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}% 
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}% 
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}% 
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}% 
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}% 
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}% 
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}% 
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}% 
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}% 
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}% 
        } 
        % Some characters . , ; ? ! / are not pygmentized. 
        % This macro makes them "active" and they will insert potential linebreaks 
        \newcommand*\Wrappedbreaksatpunct {% 
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}% 
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}% 
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}% 
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}% 
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}% 
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}% 
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}% 
            \catcode`\.\active
            \catcode`\,\active 
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active 
            \lccode`\~`\~ 	
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%
        
        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active 	
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}
    
    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        {\ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\begin{document}
    
    \maketitle
    
    

    
    В данной работе проводится качественный анализ поведения нелинейного
осциллятора. Осциллятор Дуффинга является классическим примером
нелинейной системы, наглядно иллюстрирующий возникновение хаотического
движения. Уравнение в общем случае имеет вид:

\begin{equation}
\ddot{x} + 2 \gamma \dot{x} + \omega^2 x + \beta x^3 = F \cos(\Omega t)
\end{equation}

\hypertarget{ux443ux440ux430ux432ux43dux438ux435-ux434ux443ux444ux444ux438ux43dux433ux430}{%
\section{1. Уравние
Дуффинга}\label{ux443ux440ux430ux432ux43dux438ux435-ux434ux443ux444ux444ux438ux43dux433ux430}}

Рассматривая линейные системы вида

\[ 2 \gamma  \dot{x}+ \omega^2 x  +\ddot{x}=0,\]

можно объяснить лишь узкий спектр явлений происходящих в природе. В
общем случае система подчинается нелинейной системе дифференциальных
уравнений. Однако важные результаты можно получить и на примере
уравнения (2) путем учета зависимости собственной частоты от амплитуды
колебаний. Получим:

\[\omega^2 x \left(\alpha x^2+1\right)+ \gamma \dot{x}+\ddot{x}=0.\]

Уравнение вида (3) с кубической нелинейностью может описывать, например,
математический маятник при небольших углах отклонения, груз и пружину с
нелинейной жесткостью, частицу в поле с потенциалом
\(U=\dfrac{\alpha x^2}{2}+\dfrac{\beta x^4}{4}\) и т.д.

\hypertarget{ux441ux432ux43eux431ux43eux434ux43dux44bux435-ux43aux43eux43bux435ux431ux430ux43dux438ux44f}{%
\section{2. Свободные
колебания}\label{ux441ux432ux43eux431ux43eux434ux43dux44bux435-ux43aux43eux43bux435ux431ux430ux43dux438ux44f}}

Начнем анализ с исследования свободной системы, описываемой уравнением

\[ \ddot{x} + \gamma \dot{x} + \omega^2 x + \beta x^3=0.\]

Сделаем следующую замену: \(\dot{x}=y\). Тогда уравнение (4) запишется в
виде:

\(\left\{ \begin{array}{cc}  \dot{x} = & y \\  \dot{y} = & -\beta x^3 - \omega^2 x -\gamma y \end{array} \right.\)

Эта система двух дифференциальных уравнений первого порядка однозначно
задает движение осциллятора в момент времени t при заданных начальных
условиях. Фазовое пространство представляет собой плоскость

\hypertarget{ux43fux43eux43bux43eux436ux435ux43dux438ux44f-ux440ux430ux432ux43dux43eux432ux435ux441ux438ux44f}{%
\subsection{2.1 Положения
равновесия}\label{ux43fux43eux43bux43eux436ux435ux43dux438ux44f-ux440ux430ux432ux43dux43eux432ux435ux441ux438ux44f}}

Положения равновесия определятся следующей системой алгебраических
уравнений:

\(\left\{ \begin{array}{cc}  0 =& y \\  0 =& -\beta x^3 - \omega^2 x -\gamma y \end{array} \right.\)

Решая данную систему уравнений, получаем:

\begin{array}{cc}
P_1: \{x=0,y=0\} \\
P_2: \left\{x=i \sqrt{\dfrac{\omega^2 }{\gamma}},y=0\right\} \\ 
P_3: \left\{x=-i \sqrt{\dfrac{\omega^2 }{\gamma}},y=0\right\} .
\end{array}

Заметим, что три положения равновесия существуют лишь тогда, когда
\(\omega\) и \(\gamma\) будут разных знаков. При стремлении значений
параметра \(\beta\) к нулю (переход к линейному осциллятору) точки
\(P_2\) и \(P_3\) уходят в \(\pm \infty\) и остается только одно
положение равновесия.

Поясним выше сказанное на примере консервативной системы с уравнением:

\[ \beta x^3 + \omega^2 x +\ddot{x}=0 \]

Ей соответствует гамильтониан вида:
\(H=\frac{\omega^2 u^2 }{2}+\frac{u^4}{4}+\frac{v^2}{2}\). Поскольку
решения лежат на линиях уровня \(H\), изобразим фазовый портрет:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{1}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}\PYZpc{}matplotlib notebook}
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{import} \PY{n+nn}{cmath} \PY{k}{as} \PY{n+nn}{cm}
\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}


\PY{n}{list1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.20}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mf}{0.16}\PY{p}{,} \PY{l+m+mf}{0.05}\PY{p}{)}
\PY{n}{list2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mf}{1.2}\PY{p}{,} \PY{l+m+mf}{0.2}\PY{p}{)}
\PY{n}{listt} \PY{o}{=} \PY{n}{list1} \PY{o}{+} \PY{n}{list2}
\PY{n}{omega} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{2}

\PY{k}{def} \PY{n+nf}{H}\PY{p}{(}\PY{n}{u}\PY{p}{,} \PY{n}{v}\PY{p}{,} \PY{n}{omega}\PY{p}{)}\PY{p}{:} 
    \PY{k}{return} \PY{o}{\PYZhy{}}\PY{n}{u}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{*} \PY{n}{omega}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{/} \PY{l+m+mi}{2} \PY{o}{+} \PY{n}{u}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{4} \PY{o}{/} \PY{l+m+mi}{4} \PY{o}{+} \PY{n}{v}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{/} \PY{l+m+mi}{2}

\PY{n}{u} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{)}
\PY{n}{v} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{)}

\PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{meshgrid}\PY{p}{(}\PY{n}{u}\PY{p}{,} \PY{n}{v}\PY{p}{)}
\PY{n}{Z} \PY{o}{=} \PY{n}{H}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{Y}\PY{p}{,} \PY{n}{omega}\PY{p}{)}

\PY{c+c1}{\PYZsh{}plt.figure(figsize=(10,8), dpi=150)}
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}x\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}p\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{Y}\PY{p}{,} \PY{n}{Z}\PY{p}{,} \PY{n}{listt}\PY{p}{,} \PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{black}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{real}\PY{p}{(}\PY{l+m+mi}{1}\PY{n}{j} \PY{o}{*} \PY{n}{cm}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{omega}\PY{o}{/}\PY{l+m+mf}{1.0}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{real}\PY{p}{(}\PY{l+m+mi}{1}\PY{n}{j} \PY{o}{*} \PY{n}{cm}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{omega}\PY{o}{/}\PY{l+m+mf}{1.0}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{beta = 1, omega = }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{omega}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{autoscale}\PY{p}{(}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_1_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{ux445ux430ux440ux430ux43aux442ux435ux440-ux43fux43eux43bux43eux436ux435ux43dux438ux439-ux440ux430ux432ux43dux43eux432ux435ux441ux438ux44f}{%
\subsection{Характер положений
равновесия}\label{ux445ux430ux440ux430ux43aux442ux435ux440-ux43fux43eux43bux43eux436ux435ux43dux438ux439-ux440ux430ux432ux43dux43eux432ux435ux441ux438ux44f}}

Исследуем характер положений равновесия следующей системы в зависимости
от параметров осциллятора:

\[
\left\{
\begin{array}{cc}
 0 = & y \\
 0 = & -\beta x^3 - \omega^2 x -\gamma y 
\end{array} \right. .
\]

Для решения поставленной задачи последовательно линеаризуем систему в
окрестности каждого из положений равновесия \(P_1\) и \(P_2\) (\(P_3\)
аналогично): \[
\begin{array}{cc}
P_1: \left\{
\begin{array}{cc}
 \dot{x} = & y \\
 \dot{y} = &  -\omega^2 x -\gamma y 
\end{array} \right. \\
P_2: \left\{
\begin{array}{cc}
 \dot{u} = & v \\
 \dot{v} = &  2 \omega^2 u -\gamma v 
\end{array} \right.
\end{array} .
\]

где \(u = x - i \sqrt{\frac{\omega^2 }{\beta}} \text{, v = y.}\) Корни
характеристического уравнения имеют вид:

\[\begin{array}{cc}
P_1: \lambda _{1,2}^1=-\dfrac{\gamma }{2}\pm \sqrt{\dfrac{\gamma ^2}{4}-\omega }, \\
P_2: \lambda _{1,2}^2=-\dfrac{\gamma }{2}\pm \sqrt{\dfrac{\gamma ^2}{4}+2 \omega} .
\end{array}
\]

Рассмотрим только грубые положения равновесия (поведение фазовых
траекторий в окрестности грубого положения равновесия качественно
совпадает с поведением фазовых траекторий линеаризованной системы в этой
точке).

\hypertarget{ux441ux43bux443ux447ux430ux439-a-sign-omega2-beta-0}{%
\subsubsection{\texorpdfstring{Случай A: sign
\(\omega^2 \beta >0\)}{Случай A: sign \textbackslash omega\^{}2 \textbackslash beta \textgreater0}}\label{ux441ux43bux443ux447ux430ux439-a-sign-omega2-beta-0}}

Существует только одно положение равновесия в соответствие с (4).

\hypertarget{i-beta-0-omega2-0.}{%
\subsubsection{\texorpdfstring{I)
\(\beta <0, \omega^2 <0\).}{I) \textbackslash beta \textless0, \textbackslash omega\^{}2 \textless0.}}\label{i-beta-0-omega2-0.}}

\(\lambda _1^1 \text{Re}>0, \lambda _2^1 \text{Re}<0 \Rightarrow\)
положение равновесия типа седло. Рассуждение справедливо для любых
\(\gamma\).

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{2}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{widgets} \PY{k+kn}{import} \PY{n}{Slider}

\PY{n}{Y}\PY{p}{,} \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mgrid}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{150}\PY{n}{j}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{150}\PY{n}{j}\PY{p}{]}

\PY{n}{gamma} \PY{o}{=} \PY{l+m+mf}{0.1}
\PY{n}{U} \PY{o}{=} \PY{n}{Y}
\PY{n}{V} \PY{o}{=} \PY{k}{lambda} \PY{n}{gamma}\PY{p}{:} \PY{n}{gamma} \PY{o}{*} \PY{n}{Y} \PY{o}{+} \PY{l+m+mi}{1} \PY{o}{*} \PY{n}{X} \PY{o}{+} \PY{l+m+mi}{1} \PY{o}{*} \PY{n}{X}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{3}

\PY{n}{title} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{omega\PYZca{}2 = }\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{beta = \PYZhy{} 1, }\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{gamma\PYZdl{} = }\PY{l+s+si}{\PYZob{}:.3f\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}


\PY{k}{def} \PY{n+nf}{draw\PYZus{}streamplot}\PY{p}{(}\PY{n}{gamma}\PY{p}{,} \PY{n}{ax}\PY{p}{)}\PY{p}{:}
    \PY{n}{stream} \PY{o}{=} \PY{n}{ax}\PY{o}{.}\PY{n}{streamplot}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{Y}\PY{p}{,} \PY{n}{U}\PY{p}{,} \PY{n}{V}\PY{p}{(}\PY{n}{gamma}\PY{p}{)}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{U}\PY{p}{,} \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{coolwarm}\PY{p}{,} \PY{n}{density}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
    \PY{n}{ax}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

    \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}x\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}p\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{n}{title}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{gamma}\PY{p}{)}\PY{p}{)}
    \PY{n}{ax}\PY{o}{.}\PY{n}{autoscale}\PY{p}{(}\PY{p}{)}
    \PY{k}{return} \PY{n}{stream}
    
    
\PY{k}{def} \PY{n+nf}{update}\PY{p}{(}\PY{n}{val}\PY{p}{)}\PY{p}{:}
    \PY{n}{ax}\PY{o}{.}\PY{n}{cla}\PY{p}{(}\PY{p}{)}
    \PY{n}{draw\PYZus{}streamplot}\PY{p}{(}\PY{n}{val}\PY{p}{,}\PY{n}{ax}\PY{p}{)}
    \PY{n}{fig}\PY{o}{.}\PY{n}{canvas}\PY{o}{.}\PY{n}{draw\PYZus{}idle}\PY{p}{(}\PY{p}{)}
    
\PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{p}{)}

\PY{n}{stream} \PY{o}{=} \PY{n}{draw\PYZus{}streamplot}\PY{p}{(}\PY{n}{gamma}\PY{p}{,} \PY{n}{ax}\PY{p}{)}
\PY{n}{ax}\PY{o}{.}\PY{n}{figure}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{stream}\PY{o}{.}\PY{n}{lines}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{)}

\PY{n}{fig}\PY{o}{.}\PY{n}{subplots\PYZus{}adjust}\PY{p}{(}\PY{n}{top}\PY{o}{=}\PY{l+m+mf}{0.8}\PY{p}{)}
\PY{n}{axcolor} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lightgoldenrodyellow}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{bbox} \PY{o}{=} \PY{n}{ax}\PY{o}{.}\PY{n}{get\PYZus{}position}\PY{p}{(}\PY{p}{)}
\PY{n}{axbeta} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}axes}\PY{p}{(}\PY{p}{[}\PY{n}{bbox}\PY{o}{.}\PY{n}{x0}\PY{p}{,} \PY{n}{bbox}\PY{o}{.}\PY{n}{y1}\PY{o}{+}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{bbox}\PY{o}{.}\PY{n}{width}\PY{p}{,} \PY{l+m+mf}{0.03}\PY{p}{]}\PY{p}{,} \PY{n}{facecolor}\PY{o}{=}\PY{n}{axcolor}\PY{p}{)}
\PY{n}{sbeta} \PY{o}{=} \PY{n}{Slider}\PY{p}{(}\PY{n}{axbeta}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mf}{0.0}\PY{p}{,} \PY{l+m+mf}{2.0}\PY{p}{,} \PY{n}{valinit}\PY{o}{=}\PY{n}{gamma}\PY{p}{,} \PY{n}{valstep}\PY{o}{=}\PY{l+m+mf}{0.1}\PY{p}{)}
\PY{n}{sbeta}\PY{o}{.}\PY{n}{on\PYZus{}changed}\PY{p}{(}\PY{n}{update}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_3_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{ii-beta-0-omega2-0.}{%
\subsubsection{\texorpdfstring{II)
\(\beta > 0, \omega^2 > 0\).}{II) \textbackslash beta \textgreater{} 0, \textbackslash omega\^{}2 \textgreater{} 0.}}\label{ii-beta-0-omega2-0.}}

\(\gamma \in \left(-\infty ,-2 \omega \right)\) - неустойчивый узел

\(\gamma \in \left(-2 \omega, 0 \right)\) - неустойчивый фокус

\(\gamma \in \left(0 ,2 \omega \right)\) - устойчивый фокус

\(\gamma \in \left(2 \omega, + \infty \right)\) - устойчивый узел

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{3}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}plt.figure(figsize=(10,8), dpi=150)}
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
\PY{n}{Y}\PY{p}{,} \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mgrid}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{150}\PY{n}{j}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{150}\PY{n}{j}\PY{p}{]}

\PY{n}{gamma} \PY{o}{=} \PY{l+m+mf}{0.5}
\PY{n}{U} \PY{o}{=} \PY{n}{Y}
\PY{n}{V} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{n}{gamma} \PY{o}{*} \PY{n}{Y} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1} \PY{o}{*} \PY{n}{X} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1} \PY{o}{*} \PY{n}{X}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{3}

\PY{n}{plt}\PY{o}{.}\PY{n}{streamplot}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{Y}\PY{p}{,} \PY{n}{U}\PY{p}{,} \PY{n}{V}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{U}\PY{p}{,} \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{coolwarm}\PY{p}{,} \PY{n}{density}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}\PY{p}{;}

\PY{k}{if} \PY{n}{gamma} \PY{o}{\PYZlt{}} \PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{p}{:}
    \PY{n}{plt}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{l+m+mf}{0.3}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Неустойчивый узел}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{11}\PY{p}{)}
    
\PY{k}{if} \PY{o}{\PYZhy{}}\PY{l+m+mi}{2} \PY{o}{\PYZlt{}} \PY{n}{gamma} \PY{o}{\PYZlt{}} \PY{l+m+mi}{0}\PY{p}{:}
    \PY{n}{plt}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{l+m+mf}{0.3}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Неустойчивый фокус}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{11}\PY{p}{)}
    
\PY{k}{if} \PY{l+m+mi}{0} \PY{o}{\PYZlt{}} \PY{n}{gamma} \PY{o}{\PYZlt{}} \PY{l+m+mi}{2}\PY{p}{:}
    \PY{n}{plt}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{l+m+mf}{0.3}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Устойчивый фокус}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{11}\PY{p}{)}
    
\PY{k}{if} \PY{n}{gamma} \PY{o}{\PYZgt{}} \PY{l+m+mi}{2}\PY{p}{:}
    \PY{n}{plt}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{l+m+mf}{0.3}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Устойчивый узел}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{11}\PY{p}{)}


\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{} }\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{beta = }\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{omega\PYZca{}2 = 1, }\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{gamma = \PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{gamma}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{autoscale}\PY{p}{(}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_5_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{ux441ux43bux443ux447ux430ux439-ux431-sign-omega2-beta-0}{%
\subsubsection{\texorpdfstring{Случай Б: sign
\(\omega^2 \beta < 0\)}{Случай Б: sign \textbackslash omega\^{}2 \textbackslash beta \textless{} 0}}\label{ux441ux43bux443ux447ux430ux439-ux431-sign-omega2-beta-0}}

Существует 3 положения равновесия в соответствии с (4).

\hypertarget{i-beta-0-omega2-0.}{%
\subsubsection{\texorpdfstring{I)
\(\beta < 0, \omega^2 > 0\).}{I) \textbackslash beta \textless{} 0, \textbackslash omega\^{}2 \textgreater{} 0.}}\label{i-beta-0-omega2-0.}}

\[
\begin{array}{cc}
\gamma \in \left(-\infty ,-2 \omega \right): \left\{
\begin{array}{cc}
 P1  : & \text{неустойчивый узел}  \\
 P2  : & \text{седло}
\end{array} \right. \\
\gamma \in \left(-2 \omega, 0 \right): \left\{
\begin{array}{cc}
 P1  : & \text{неустойчивый фокус}  \\
 P2  : & \text{седло}
\end{array} \right. \\ 
\gamma \in \left(0 ,2 \omega \right): \left\{
\begin{array}{cc}
 P1  : & \text{устойчивый фокус}  \\
 P2  : & \text{седло}
\end{array} \right. \\
\gamma \in \left(2 \omega, + \infty \right): \left\{
\begin{array}{cc}
 P1  : & \text{устойчивый узел}  \\
 P2  : & \text{седло}
\end{array} \right.
\end{array}
\].

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{4}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}plt.figure(figsize=(10,8), dpi=150)}
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
\PY{n}{Y}\PY{p}{,} \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mgrid}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{:}\PY{l+m+mi}{150}\PY{n}{j}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{:}\PY{l+m+mi}{150}\PY{n}{j}\PY{p}{]}

\PY{n}{gamma} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{3}
\PY{n}{U} \PY{o}{=} \PY{n}{Y}
\PY{n}{V} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{n}{gamma} \PY{o}{*} \PY{n}{Y} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1} \PY{o}{*} \PY{n}{X} \PY{o}{+} \PY{l+m+mi}{1} \PY{o}{*} \PY{n}{X}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{3}

\PY{n}{plt}\PY{o}{.}\PY{n}{streamplot}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{Y}\PY{p}{,} \PY{n}{U}\PY{p}{,} \PY{n}{V}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{U}\PY{p}{,} \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{coolwarm}\PY{p}{,} \PY{n}{density}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{real}\PY{p}{(}\PY{l+m+mi}{1}\PY{n}{j} \PY{o}{*} \PY{n}{cm}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{real}\PY{p}{(}\PY{l+m+mi}{1}\PY{n}{j} \PY{o}{*} \PY{n}{cm}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{k}{if} \PY{n}{gamma} \PY{o}{\PYZlt{}} \PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{p}{:}
    \PY{n}{plt}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{l+m+mf}{0.3}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Неустойчивый узел}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{11}\PY{p}{)}
    
\PY{k}{if} \PY{o}{\PYZhy{}}\PY{l+m+mi}{2} \PY{o}{\PYZlt{}} \PY{n}{gamma} \PY{o}{\PYZlt{}} \PY{l+m+mi}{0}\PY{p}{:}
    \PY{n}{plt}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{l+m+mf}{0.3}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Неустойчивый фокус}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{11}\PY{p}{)}
    
\PY{k}{if} \PY{l+m+mi}{0} \PY{o}{\PYZlt{}} \PY{n}{gamma} \PY{o}{\PYZlt{}} \PY{l+m+mi}{2}\PY{p}{:}
    \PY{n}{plt}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{l+m+mf}{0.3}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Устойчивый фокус}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{11}\PY{p}{)}
    
\PY{k}{if} \PY{n}{gamma} \PY{o}{\PYZgt{}} \PY{l+m+mi}{2}\PY{p}{:}
    \PY{n}{plt}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{l+m+mf}{0.3}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Устойчивый узел}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{11}\PY{p}{)}
    
    
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.07}\PY{p}{,} \PY{l+m+mf}{0.9}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{0.07}\PY{p}{,} \PY{l+m+mf}{0.45}\PY{p}{]}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{1.5}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Седла}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{11}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mf}{1.3}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.07}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mf}{0.37}\PY{p}{]}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{}plt.savefig(\PYZdq{}out.png\PYZdq{})}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}x\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}p\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{} }\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{beta = \PYZhy{}1, }\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{omega\PYZca{}2 = 1, }\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{gamma = \PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{gamma}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{autoscale}\PY{p}{(}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_7_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{ii-beta-0-omega2-0.}{%
\subsubsection{\texorpdfstring{II)
\(\beta > 0, \omega^2 < 0\).}{II) \textbackslash beta \textgreater{} 0, \textbackslash omega\^{}2 \textless{} 0.}}\label{ii-beta-0-omega2-0.}}

\[
\begin{array}{cc}
\gamma \in \left(-\infty ,-2 \omega \right): \left\{
\begin{array}{cc}
 P1  : & \text{неустойчивый узел}  \\
 P2  : & \text{седло}
\end{array} \right. \\
\gamma \in \left(-2 \omega, 0 \right): \left\{
\begin{array}{cc}
 P1  : & \text{неустойчивый фокус}  \\
 P2  : & \text{седло}
\end{array} \right. \\ 
\gamma \in \left(0 ,2 \omega \right): \left\{
\begin{array}{cc}
 P1  : & \text{устойчивый фокус}  \\
 P2  : & \text{седло}
\end{array} \right. \\
\gamma \in \left(2 \omega, + \infty \right): \left\{
\begin{array}{cc}
 P1  : & \text{устойчивый узел}  \\
 P2  : & \text{седло}
\end{array} \right.
\end{array}.
\]

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{5}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}plt.figure(figsize=(10,8), dpi=150)}
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
\PY{n}{Y}\PY{p}{,} \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mgrid}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{:}\PY{l+m+mi}{150}\PY{n}{j}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{:}\PY{l+m+mi}{150}\PY{n}{j}\PY{p}{]}

\PY{n}{gamma} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{3}
\PY{n}{U} \PY{o}{=} \PY{n}{Y}
\PY{n}{V} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{n}{gamma} \PY{o}{*} \PY{n}{Y} \PY{o}{+} \PY{l+m+mi}{1} \PY{o}{*} \PY{n}{X} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1} \PY{o}{*} \PY{n}{X}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{3}

\PY{n}{plt}\PY{o}{.}\PY{n}{streamplot}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{Y}\PY{p}{,} \PY{n}{U}\PY{p}{,} \PY{n}{V}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{U}\PY{p}{,} \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{coolwarm}\PY{p}{,} \PY{n}{density}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{real}\PY{p}{(}\PY{l+m+mi}{1}\PY{n}{j} \PY{o}{*} \PY{n}{cm}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{real}\PY{p}{(}\PY{l+m+mi}{1}\PY{n}{j} \PY{o}{*} \PY{n}{cm}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{k}{if} \PY{n}{gamma} \PY{o}{\PYZlt{}} \PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{p}{:}
    \PY{n}{plt}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{l+m+mf}{0.3}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Неустойчивый узел}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{11}\PY{p}{)}
    
\PY{k}{if} \PY{o}{\PYZhy{}}\PY{l+m+mi}{2} \PY{o}{\PYZlt{}} \PY{n}{gamma} \PY{o}{\PYZlt{}} \PY{l+m+mi}{0}\PY{p}{:}
    \PY{n}{plt}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{l+m+mf}{0.3}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Неустойчивый фокус}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{11}\PY{p}{)}
    
\PY{k}{if} \PY{l+m+mi}{0} \PY{o}{\PYZlt{}} \PY{n}{gamma} \PY{o}{\PYZlt{}} \PY{l+m+mi}{2}\PY{p}{:}
    \PY{n}{plt}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{l+m+mf}{0.3}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Устойчивый фокус}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{11}\PY{p}{)}
    
\PY{k}{if} \PY{n}{gamma} \PY{o}{\PYZgt{}} \PY{l+m+mi}{2}\PY{p}{:}
    \PY{n}{plt}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{l+m+mf}{0.3}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Устойчивый узел}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{11}\PY{p}{)}
    
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.07}\PY{p}{,} \PY{l+m+mf}{0.9}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{0.07}\PY{p}{,} \PY{l+m+mf}{0.45}\PY{p}{]}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{1.5}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Седла}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{11}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mf}{1.3}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.07}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mf}{0.37}\PY{p}{]}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{out.png}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}x\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}p\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{} }\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{beta = 1, }\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{omega\PYZca{}2 =\PYZhy{}1, }\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{gamma = \PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{gamma}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{autoscale}\PY{p}{(}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_9_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{ux430ux43dux430ux43bux438ux442ux438ux447ux435ux441ux43aux43eux435-ux438-ux447ux438ux441ux43bux435ux43dux43dux43eux435-ux440ux435ux448ux435ux43dux438ux44f-ux434ux43bux44f-ux43bux438ux43dux435ux439ux43dux43eux433ux43e-ux43eux441ux446ux438ux43bux43bux44fux442ux43eux440ux430}{%
\subsection{2.2. Аналитическое и численное решения для линейного
осциллятора}\label{ux430ux43dux430ux43bux438ux442ux438ux447ux435ux441ux43aux43eux435-ux438-ux447ux438ux441ux43bux435ux43dux43dux43eux435-ux440ux435ux448ux435ux43dux438ux44f-ux434ux43bux44f-ux43bux438ux43dux435ux439ux43dux43eux433ux43e-ux43eux441ux446ux438ux43bux43bux44fux442ux43eux440ux430}}

Чтобы не нарушать целостность повествования, для начала рассмотрим
свободные колебания линейного осциллятора, затем изучим динамику
вынужденных колебаний, постепенно добавляя трение и внешнее воздействие.

\hypertarget{ux441ux43bux443ux447ux430ux439-ux441ux432ux43eux431ux43eux434ux43dux44bux445-ux43aux43eux43bux435ux431ux430ux43dux438ux439-ux431ux435ux437-ux437ux430ux442ux443ux445ux430ux43dux438ux44f}{%
\subsubsection{2.2.1. Случай свободных колебаний без
затухания}\label{ux441ux43bux443ux447ux430ux439-ux441ux432ux43eux431ux43eux434ux43dux44bux445-ux43aux43eux43bux435ux431ux430ux43dux438ux439-ux431ux435ux437-ux437ux430ux442ux443ux445ux430ux43dux438ux44f}}

Свободная динамика системы описывается следующим уравнением:

\begin{equation}
    \omega_{0}^{2} x  +\ddot{x}=0.
\end{equation}

Решением данного уравнения является суперпозиция двух тригонометрических
функций:

\begin{align}
    x(t) = & A \cos(w_0 t) + B \sin(w_0 t), \\
    p(t) = & \dot{x} = -A \omega_0 \sin(w_0 t) + B \omega_0 \cos(w_0 t),
\end{align}

где коэффициенты A, B находятся из начальных условий: \$ x(0) = x\_0 =
A, p(0) = p\_0 = B \omega\_0\$.

Данный случай не представляет особого интереса с точки зрения
исследования динамики системы.

\hypertarget{ux441ux43bux443ux447ux430ux439-ux441ux432ux43eux431ux43eux434ux43dux44bux445-ux43aux43eux43bux435ux431ux430ux43dux438ux439-ux441-ux437ux430ux442ux443ux445ux430ux43dux438ux435ux43c}{%
\subsubsection{2.2.2. Случай свободных колебаний с
затуханием}\label{ux441ux43bux443ux447ux430ux439-ux441ux432ux43eux431ux43eux434ux43dux44bux445-ux43aux43eux43bux435ux431ux430ux43dux438ux439-ux441-ux437ux430ux442ux443ux445ux430ux43dux438ux435ux43c}}

Учтем наличие диссипации в системе:

\begin{equation}
    \omega_{0}^{2} x + 2 \gamma \dot{x}  +\ddot{x} = 0.
\end{equation}

Следуя общим правилам решения линейных дифференциальных уравнений с
постоянными коэффициентами, составляем характеристическое уравнение,
полагая \(x = e^{\lambda t}\):

\begin{equation}
    \lambda^2 + 2\gamma \lambda + \omega_0^2 = 0
\end{equation}

Общее решение примет вид:

\begin{equation}
    \lambda_{1,2} = -\gamma \pm \sqrt{\gamma^2 - \omega_0^2}
\end{equation}

Здесь следует различать три случая: коэффициент затухания меньше
собственной частоты колебаний (\(\gamma < \omega_0\)),
\(\gamma > \omega_0, \gamma = \omega_0\).

\hypertarget{ux441ux43bux443ux447ux430ux439-mathbfgamma-omega_0}{%
\paragraph{\texorpdfstring{Случай
\(\mathbf{\gamma < \omega_0}\)}{Случай \textbackslash mathbf\{\textbackslash gamma \textless{} \textbackslash omega\_0\}}}\label{ux441ux43bux443ux447ux430ux439-mathbfgamma-omega_0}}

Введем новую переменную: \(\omega = \sqrt{\omega_0^2 - \gamma^2}.\)
Решение имеет вид гармонических колебаний с экспоненциально убывающей
амплитудой:

\begin{align}
    x(t) = & e^{-\gamma t} (A \cos(w t) + B \sin(w t)), \\
    p(t) = & -\gamma e^{-\gamma t} (A \cos(w t) + B \sin(w t)) + 
        e^{-\gamma t} (- A \omega \sin(w t) + B \omega \cos(w t)),
\end{align}

\[ A = x_0, B = \dfrac{p_0 + \gamma x_0}{\omega}. \] Если
\(\gamma \ll \omega_0\), то за время одного периода
\(T = 2 \pi / \omega\) амплитуда затухающих колебаний почти не менятся.
В этом случае имеет смысл рассматривать средние за период квадраты
координаты и импульса, принебрегая изменением значением
\(e^{-\gamma t}\). Эти средние квадраты пропорциональны
\(e^{-2 \gamma t}\). Поэтому энергия системы убывает по закону:

\begin{equation}
    E = E_0 e^{-2 \gamma t},
\end{equation} где \(E_0\) - начальная энергия системы.

\hypertarget{ux441ux43bux443ux447ux430ux439-mathbfgamma-omega_0-1}{%
\paragraph{\texorpdfstring{Случай
\(\mathbf{\gamma > \omega_0}\)}{Случай \textbackslash mathbf\{\textbackslash gamma \textgreater{} \textbackslash omega\_0\}}}\label{ux441ux43bux443ux447ux430ux439-mathbfgamma-omega_0-1}}

\(\omega = \sqrt{\gamma^2 - \omega_0^2}.\)

\begin{align}
    x(t) = & A e^{(\omega - \gamma) t} + B e^{-(\omega + \gamma) t}, \\
    p(t) = & A (\omega - \gamma) e^{(\omega - \gamma) t} - B (\omega + \gamma) e^{-(\omega + \gamma) t},
\end{align}

\[ A = \dfrac{x_0}{2} + \dfrac{p_0 - \gamma x_0}{2 \omega}, 
B = \dfrac{x_0}{2} - \dfrac{p_0 - \gamma x_0}{2 \omega}. \]

При большом трении движение состоит в убывании \(|x|\), т.е. в
ассимптотическом приближении к положению равновесия при
\(t \longrightarrow \infty\). Такое движение называется апериодическим
затуханием.

\hypertarget{ux441ux43bux443ux447ux430ux439-mathbfgamma-omega_0-2}{%
\paragraph{\texorpdfstring{Случай
\(\mathbf{\gamma = \omega_0}\)}{Случай \textbackslash mathbf\{\textbackslash gamma = \textbackslash omega\_0\}}}\label{ux441ux43bux443ux447ux430ux439-mathbfgamma-omega_0-2}}

\(\omega = \omega_0.\)

\begin{align}
    x(t) = & (A + B t) e^{-\gamma t}, \\
    p(t) = & -\gamma (A + B t) e^{-\gamma t} + B e^{-\gamma t},
\end{align}

\[ A = x_0, 
B = p_0 + \gamma x_0. \]

Данный случай также является апериодическим затуханием.

Ниже мы предоставим код программы и графики.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{6}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{scipy} \PY{k}{as} \PY{n+nn}{sp}
\PY{k+kn}{from} \PY{n+nn}{tqdm} \PY{k+kn}{import} \PY{n}{trange}\PY{p}{,} \PY{n}{notebook}
\PY{k+kn}{from} \PY{n+nn}{odeintw} \PY{k+kn}{import} \PY{n}{odeintw}


\PY{c+c1}{\PYZsh{}  Численное решение}
\PY{k}{def} \PY{n+nf}{diff\PYZus{}eq}\PY{p}{(}\PY{n}{z}\PY{p}{,} \PY{n}{t}\PY{p}{)}\PY{p}{:}
    \PY{n}{q}\PY{p}{,} \PY{n}{p} \PY{o}{=} \PY{n}{z}
    \PY{k}{return} \PY{p}{[}\PY{n}{p}\PY{p}{,} \PY{n}{F}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{o}{/}\PY{n}{T} \PY{o}{*} \PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{Fm}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{l+m+mi}{3}\PY{o}{*}\PY{n}{OMEGA} \PY{o}{*} \PY{n}{t}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{n}{p} \PY{o}{+} \PY{n}{k}\PY{o}{*}\PY{p}{(}\PY{n}{omega0}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{*} \PY{n}{q} \PY{o}{\PYZhy{}} \PY{n}{beta} \PY{o}{*} \PY{n}{q}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{3}\PY{p}{]}


\PY{c+c1}{\PYZsh{}  Аналитическое решение для построения уравнений движения}
\PY{k}{def} \PY{n+nf}{motion\PYZus{}analytical}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{x0}\PY{p}{,} \PY{n}{p0}\PY{p}{,} \PY{n}{omega0}\PY{p}{,} \PY{n}{gamma}\PY{p}{,} \PY{n}{F}\PY{p}{,} \PY{n}{Fm}\PY{p}{,} \PY{n}{OMEGA}\PY{p}{)}\PY{p}{:}
    
    \PY{k+kn}{import} \PY{n+nn}{numpy}
    
    \PY{c+c1}{\PYZsh{}  linear spectrum}
    \PY{k}{if} \PY{n}{gamma} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{omega} \PY{o}{=} \PY{n}{omega0}
        
        \PY{n}{C} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{F}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{D} \PY{o}{=} \PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{F}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{C1} \PY{o}{=} \PY{l+m+mi}{6}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{Fm}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{l+m+mi}{9}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{36}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{D1} \PY{o}{=} \PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{l+m+mi}{9}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{Fm}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{l+m+mi}{9}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{36}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        
        \PY{n}{A} \PY{o}{=} \PY{n}{x0} \PY{o}{\PYZhy{}} \PY{n}{D} \PY{o}{\PYZhy{}} \PY{n}{D1}
        \PY{n}{B} \PY{o}{=} \PY{p}{(}\PY{n}{p0} \PY{o}{\PYZhy{}} \PY{n}{C}\PY{o}{*}\PY{n}{OMEGA} \PY{o}{\PYZhy{}} \PY{l+m+mi}{3}\PY{o}{*}\PY{n}{C1}\PY{o}{*}\PY{n}{OMEGA}\PY{p}{)} \PY{o}{/} \PY{n}{omega}
        
        \PY{k}{return} \PY{p}{[}\PY{n}{A} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{omega} \PY{o}{*} \PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{B}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{omega}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} 
                \PY{n}{D}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{C}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{o}{+} \PY{n}{D1}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{l+m+mi}{3}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{C1}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{l+m+mi}{3}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{p}{,}
               \PY{o}{\PYZhy{}}\PY{n}{omega}\PY{o}{*}\PY{n}{A} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{omega} \PY{o}{*} \PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{B}\PY{o}{*}\PY{n}{omega}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{omega}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{n}{D}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)} 
                \PY{o}{+} \PY{n}{OMEGA}\PY{o}{*}\PY{n}{C}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{\PYZhy{}} 
               \PY{l+m+mi}{3}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{C1}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{l+m+mi}{3}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{l+m+mi}{3}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{D1}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{l+m+mi}{3}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{p}{]}
    
    \PY{c+c1}{\PYZsh{}  gamma \PYZlt{} w0}
    \PY{k}{elif} \PY{n}{gamma} \PY{o}{\PYZlt{}} \PY{n}{omega0} \PY{o+ow}{and} \PY{n}{F} \PY{o}{==} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{Fm} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{omega} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{k}{return} \PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{x0}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{omega}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{p}{(}\PY{n}{p0} \PY{o}{+} \PY{n}{gamma}\PY{o}{*}\PY{n}{x0}\PY{p}{)}\PY{o}{/}\PY{n}{omega}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{omega}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{p}{)}\PY{p}{,}
               \PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{x0}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{omega}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{p}{(}\PY{n}{p0} \PY{o}{+} \PY{n}{gamma}\PY{o}{*}\PY{n}{x0}\PY{p}{)}\PY{o}{/}\PY{n}{omega}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{omega}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{p}{)} \PY{o}{+} 
               \PY{n}{omega}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{o}{\PYZhy{}}\PY{n}{x0}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{omega}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{p}{(}\PY{n}{p0} \PY{o}{+} \PY{n}{gamma}\PY{o}{*}\PY{n}{x0}\PY{p}{)}\PY{o}{/}\PY{n}{omega}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{omega}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{p}{)}\PY{p}{]}
    
    \PY{c+c1}{\PYZsh{}  gamma \PYZgt{} w0}
    \PY{k}{elif} \PY{n}{gamma} \PY{o}{\PYZgt{}} \PY{n}{omega0} \PY{o+ow}{and} \PY{n}{F} \PY{o}{==} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{Fm} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{omega} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}  \PY{p}{)}
        \PY{k}{return} \PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{o}{*}\PY{n}{t} \PY{o}{+} \PY{n}{omega}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{x0}\PY{o}{/}\PY{l+m+mi}{2} \PY{o}{+} \PY{p}{(}\PY{n}{gamma}\PY{o}{*}\PY{n}{x0} \PY{o}{+} \PY{n}{p0}\PY{p}{)}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{omega}\PY{p}{)} \PY{p}{)} \PY{o}{+} 
                \PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{o}{*}\PY{n}{t} \PY{o}{\PYZhy{}} \PY{n}{omega}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{x0}\PY{o}{/}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{p}{(}\PY{n}{gamma}\PY{o}{*}\PY{n}{x0} \PY{o}{+} \PY{n}{p0}\PY{p}{)}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{omega}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                \PY{p}{(}\PY{n}{omega} \PY{o}{\PYZhy{}} \PY{n}{gamma}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{o}{*}\PY{n}{t} \PY{o}{+} \PY{n}{omega}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{x0}\PY{o}{/}\PY{l+m+mi}{2} \PY{o}{+} \PY{p}{(}\PY{n}{gamma}\PY{o}{*}\PY{n}{x0} \PY{o}{+} \PY{n}{p0}\PY{p}{)}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{omega}\PY{p}{)} \PY{p}{)} \PY{o}{\PYZhy{}} 
                \PY{p}{(}\PY{n}{omega} \PY{o}{+} \PY{n}{gamma}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{o}{*}\PY{n}{t} \PY{o}{\PYZhy{}} \PY{n}{omega}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{x0}\PY{o}{/}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{p}{(}\PY{n}{gamma}\PY{o}{*}\PY{n}{x0} \PY{o}{+} \PY{n}{p0}\PY{p}{)}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{omega}\PY{p}{)} \PY{p}{)}\PY{p}{]}
    
    \PY{c+c1}{\PYZsh{}  gamma = w0}
    \PY{k}{elif} \PY{n}{gamma} \PY{o}{==} \PY{n}{omega0} \PY{o+ow}{and} \PY{n}{F} \PY{o}{==} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{Fm} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{omega} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}  \PY{p}{)}
        \PY{k}{return} \PY{p}{[}\PY{p}{(} \PY{n}{x0} \PY{o}{+} \PY{p}{(}\PY{n}{gamma}\PY{o}{*}\PY{n}{x0} \PY{o}{+} \PY{n}{p0}\PY{p}{)}\PY{o}{*}\PY{n}{t} \PY{p}{)} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{p}{,}
               \PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{o}{*}\PY{p}{(} \PY{n}{x0} \PY{o}{+} \PY{p}{(}\PY{n}{gamma}\PY{o}{*}\PY{n}{x0} \PY{o}{+} \PY{n}{p0}\PY{p}{)}\PY{o}{*}\PY{n}{t} \PY{p}{)} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{p}{(}\PY{n}{p0} \PY{o}{+} \PY{n}{gamma}\PY{o}{*}\PY{n}{x0}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{p}{]}
    
    
    \PY{c+c1}{\PYZsh{}  gamma \PYZlt{} w0 with force F}
    \PY{k}{elif} \PY{n}{gamma} \PY{o}{\PYZlt{}} \PY{n}{omega0} \PY{o+ow}{and} \PY{n}{F} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{Fm} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{omega} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        
        \PY{n}{C} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{F}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{D} \PY{o}{=} \PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{F}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}

        \PY{n}{A} \PY{o}{=} \PY{n}{x0} \PY{o}{\PYZhy{}} \PY{n}{D}
        \PY{n}{B} \PY{o}{=} \PY{p}{(}\PY{n}{p0} \PY{o}{+} \PY{n}{gamma}\PY{o}{*}\PY{n}{x0} \PY{o}{\PYZhy{}} \PY{n}{gamma}\PY{o}{*}\PY{n}{D} \PY{o}{\PYZhy{}} \PY{n}{C}\PY{o}{*}\PY{n}{OMEGA}\PY{p}{)} \PY{o}{/} \PY{p}{(}\PY{n}{omega}\PY{p}{)}
    
        \PY{k}{return} \PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{n}{A}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{omega}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{B}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{omega}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{p}{)} \PY{o}{+} 
                \PY{n}{D}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{C}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{p}{,}
           \PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{n}{A}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{omega}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{B}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{omega}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{p}{)}
           \PY{o}{+}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{A}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{omega}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{B}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{omega}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{p}{)} \PY{o}{\PYZhy{}}
               \PY{n}{OMEGA}\PY{o}{*}\PY{n}{D}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{OMEGA}\PY{o}{*}\PY{n}{C}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{p}{]}
    
    
    
    \PY{c+c1}{\PYZsh{}  gamma \PYZgt{} w0 with force F}
    \PY{k}{elif} \PY{n}{gamma} \PY{o}{\PYZgt{}} \PY{n}{omega0} \PY{o+ow}{and} \PY{n}{F} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{Fm} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{omega} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        
        \PY{n}{C} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{F}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{D} \PY{o}{=} \PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{F}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        
        \PY{n}{B} \PY{o}{=} \PY{p}{(} \PY{n}{x0}\PY{o}{*}\PY{p}{(}\PY{n}{omega} \PY{o}{\PYZhy{}} \PY{n}{gamma}\PY{p}{)} \PY{o}{+} \PY{n}{D}\PY{o}{*}\PY{p}{(}\PY{n}{gamma} \PY{o}{\PYZhy{}} \PY{n}{omega}\PY{p}{)} \PY{o}{+} \PY{n}{C}\PY{o}{*}\PY{n}{OMEGA} \PY{o}{\PYZhy{}} \PY{n}{p0} \PY{p}{)} \PY{o}{/}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{omega}\PY{p}{)}
        \PY{n}{A} \PY{o}{=} \PY{n}{x0} \PY{o}{\PYZhy{}} \PY{n}{B} \PY{o}{\PYZhy{}} \PY{n}{D}
        
        \PY{k}{return} \PY{p}{[}\PY{n}{A}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma} \PY{o}{+} \PY{n}{omega}\PY{p}{)}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{B}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{p}{(}\PY{n}{gamma} \PY{o}{+} \PY{n}{omega}\PY{p}{)}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} 
                \PY{n}{D}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{C}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{p}{,}
            \PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma} \PY{o}{+} \PY{n}{omega}\PY{p}{)}\PY{o}{*}\PY{n}{A}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma} \PY{o}{+} \PY{n}{omega}\PY{p}{)}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{\PYZhy{}}
                \PY{p}{(}\PY{n}{gamma} \PY{o}{+} \PY{n}{omega}\PY{p}{)}\PY{o}{*}\PY{n}{B}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{p}{(}\PY{n}{gamma} \PY{o}{+} \PY{n}{omega}\PY{p}{)}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{\PYZhy{}}
               \PY{n}{OMEGA}\PY{o}{*}\PY{n}{D}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{OMEGA}\PY{o}{*}\PY{n}{C}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{p}{]}
    
    
    \PY{c+c1}{\PYZsh{}  gamma = w0 with force F}
    \PY{k}{elif} \PY{n}{gamma} \PY{o}{==} \PY{n}{omega0} \PY{o+ow}{and} \PY{n}{F} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{Fm} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{omega} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        
        \PY{n}{C} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{F}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{D} \PY{o}{=} \PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{F}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{A} \PY{o}{=} \PY{n}{x0} \PY{o}{\PYZhy{}} \PY{n}{D}
        \PY{n}{B} \PY{o}{=} \PY{n}{p0} \PY{o}{+} \PY{n}{gamma}\PY{o}{*}\PY{n}{x0} \PY{o}{\PYZhy{}} \PY{n}{gamma}\PY{o}{*}\PY{n}{D} \PY{o}{\PYZhy{}} \PY{n}{C}\PY{o}{*}\PY{n}{OMEGA}
        
        \PY{k}{return} \PY{p}{[}\PY{p}{(}\PY{n}{A}\PY{o}{+}\PY{n}{B}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{D}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{C}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{p}{,}
                \PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{o}{*}\PY{p}{(}\PY{n}{A}\PY{o}{+}\PY{n}{B}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{B}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{\PYZhy{}}
               \PY{n}{OMEGA}\PY{o}{*}\PY{n}{D}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{OMEGA}\PY{o}{*}\PY{n}{C}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{p}{]}
    
    
    \PY{c+c1}{\PYZsh{}  gamma \PYZlt{} w0 with two forces F and Fm}
    \PY{k}{elif} \PY{n}{gamma} \PY{o}{\PYZlt{}} \PY{n}{omega0} \PY{o+ow}{and} \PY{n}{F} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{Fm} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{omega} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        
        \PY{n}{C} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{F}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{D} \PY{o}{=} \PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{F}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{C1} \PY{o}{=} \PY{l+m+mi}{6}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{Fm}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{l+m+mi}{9}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{36}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{D1} \PY{o}{=} \PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{l+m+mi}{9}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{Fm}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{l+m+mi}{9}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{36}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        
        \PY{n}{A} \PY{o}{=} \PY{n}{x0} \PY{o}{\PYZhy{}} \PY{n}{D} \PY{o}{\PYZhy{}} \PY{n}{D1}
        \PY{n}{B} \PY{o}{=} \PY{p}{(}\PY{n}{p0} \PY{o}{+} \PY{n}{gamma}\PY{o}{*}\PY{n}{x0} \PY{o}{\PYZhy{}} \PY{n}{gamma}\PY{o}{*}\PY{n}{D} \PY{o}{\PYZhy{}} \PY{n}{gamma}\PY{o}{*}\PY{n}{D1} \PY{o}{\PYZhy{}} \PY{n}{C}\PY{o}{*}\PY{n}{OMEGA} \PY{o}{\PYZhy{}} \PY{l+m+mi}{3}\PY{o}{*}\PY{n}{C1}\PY{o}{*}\PY{n}{OMEGA}\PY{p}{)} \PY{o}{/} \PY{p}{(}\PY{n}{omega}\PY{p}{)}
    
        \PY{k}{return} \PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{n}{A}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{omega}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{B}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{omega}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{p}{)} \PY{o}{+} 
                \PY{n}{D}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{C}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{D1}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{l+m+mi}{3}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{C1}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{l+m+mi}{3}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{p}{,}
           \PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{n}{A}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{omega}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{B}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{omega}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{p}{)}
           \PY{o}{+}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{A}\PY{o}{*}\PY{n}{omega}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{omega}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{B}\PY{o}{*}\PY{n}{omega}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{omega}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{p}{)} \PY{o}{\PYZhy{}}
               \PY{n}{OMEGA}\PY{o}{*}\PY{n}{D}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{OMEGA}\PY{o}{*}\PY{n}{C}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{\PYZhy{}}
                \PY{l+m+mi}{3}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{D1}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{l+m+mi}{3}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{l+m+mi}{3}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{C1}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{l+m+mi}{3}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{p}{]}
    
    
    \PY{c+c1}{\PYZsh{}  gamma \PYZgt{} w0 with two forces F and Fm}
    \PY{k}{elif} \PY{n}{gamma} \PY{o}{\PYZgt{}} \PY{n}{omega0} \PY{o+ow}{and} \PY{n}{F} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{Fm} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{omega} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        
        \PY{n}{C} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{F}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{D} \PY{o}{=} \PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{F}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{C1} \PY{o}{=} \PY{l+m+mi}{6}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{Fm}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{l+m+mi}{9}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{36}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{D1} \PY{o}{=} \PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{l+m+mi}{9}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{Fm}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{l+m+mi}{9}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{36}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        
        \PY{n}{B} \PY{o}{=} \PY{p}{(} \PY{n}{x0}\PY{o}{*}\PY{p}{(}\PY{n}{omega} \PY{o}{\PYZhy{}} \PY{n}{gamma}\PY{p}{)} \PY{o}{+} \PY{n}{D}\PY{o}{*}\PY{p}{(}\PY{n}{gamma} \PY{o}{\PYZhy{}} \PY{n}{omega}\PY{p}{)} \PY{o}{+} \PY{l+m+mi}{3}\PY{o}{*}\PY{n}{D1}\PY{o}{*}\PY{p}{(}\PY{n}{gamma} \PY{o}{\PYZhy{}} \PY{n}{omega}\PY{p}{)} \PY{o}{+}
             \PY{n}{C}\PY{o}{*}\PY{n}{OMEGA} \PY{o}{+} \PY{l+m+mi}{3}\PY{o}{*}\PY{n}{C1}\PY{o}{*}\PY{n}{OMEGA} \PY{o}{\PYZhy{}} \PY{n}{p0} \PY{p}{)} \PY{o}{/}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{omega}\PY{p}{)}
        \PY{n}{A} \PY{o}{=} \PY{n}{x0} \PY{o}{\PYZhy{}} \PY{n}{B} \PY{o}{\PYZhy{}} \PY{n}{D} \PY{o}{\PYZhy{}} \PY{n}{D1}
        
        \PY{k}{return} \PY{p}{[}\PY{n}{A}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma} \PY{o}{+} \PY{n}{omega}\PY{p}{)}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{B}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{p}{(}\PY{n}{gamma} \PY{o}{+} \PY{n}{omega}\PY{p}{)}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} 
                \PY{n}{D}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{C}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{D1}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{l+m+mi}{3}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{C1}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{l+m+mi}{3}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{p}{,}
                \PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma} \PY{o}{+} \PY{n}{omega}\PY{p}{)}\PY{o}{*}\PY{n}{A}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma} \PY{o}{+} \PY{n}{omega}\PY{p}{)}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{\PYZhy{}}
                \PY{p}{(}\PY{n}{gamma} \PY{o}{+} \PY{n}{omega}\PY{p}{)}\PY{o}{*}\PY{n}{B}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{p}{(}\PY{n}{gamma} \PY{o}{+} \PY{n}{omega}\PY{p}{)}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{\PYZhy{}} 
               \PY{n}{OMEGA}\PY{o}{*}\PY{n}{D}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{OMEGA}\PY{o}{*}\PY{n}{C}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{\PYZhy{}} 
               \PY{l+m+mi}{3}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{C1}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{l+m+mi}{3}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{l+m+mi}{3}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{D1}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{l+m+mi}{3}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{p}{]}
    
    
    \PY{c+c1}{\PYZsh{}  gamma = w0 with two forces F and Fm}
    \PY{k}{elif} \PY{n}{gamma} \PY{o}{==} \PY{n}{omega0} \PY{o+ow}{and} \PY{n}{F} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{Fm} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{omega} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        
        \PY{n}{C} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{F}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{D} \PY{o}{=} \PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{F}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{C1} \PY{o}{=} \PY{l+m+mi}{6}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{Fm}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{l+m+mi}{9}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{36}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{D1} \PY{o}{=} \PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{l+m+mi}{9}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{Fm}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{l+m+mi}{9}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{36}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        
        \PY{n}{A} \PY{o}{=} \PY{n}{x0} \PY{o}{\PYZhy{}} \PY{n}{D} \PY{o}{\PYZhy{}} \PY{n}{D1}
        \PY{n}{B} \PY{o}{=} \PY{n}{p0} \PY{o}{+} \PY{n}{gamma}\PY{o}{*}\PY{n}{x0} \PY{o}{\PYZhy{}} \PY{n}{gamma}\PY{o}{*}\PY{n}{D} \PY{o}{\PYZhy{}} \PY{n}{C}\PY{o}{*}\PY{n}{OMEGA} \PY{o}{\PYZhy{}} \PY{n}{gamma}\PY{o}{*}\PY{n}{D1} \PY{o}{\PYZhy{}} \PY{n}{C1}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{l+m+mi}{3}
        
        \PY{k}{return} \PY{p}{[}\PY{p}{(} \PY{n}{A} \PY{o}{+} \PY{n}{B}\PY{o}{*}\PY{n}{t} \PY{p}{)} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+}
                \PY{n}{D}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{C}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{o}{+} \PY{n}{D1}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{l+m+mi}{3}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{C1}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{l+m+mi}{3}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{p}{,}
               \PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{o}{*}\PY{p}{(} \PY{n}{A} \PY{o}{+} \PY{n}{B}\PY{o}{*}\PY{n}{t} \PY{p}{)} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{B}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{\PYZhy{}} 
               \PY{n}{OMEGA}\PY{o}{*}\PY{n}{D}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{OMEGA}\PY{o}{*}\PY{n}{C}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{\PYZhy{}} 
               \PY{l+m+mi}{3}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{C1}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{l+m+mi}{3}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{l+m+mi}{3}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{D1}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{l+m+mi}{3}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{t}\PY{p}{)}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{7}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}  линейный осциллятор без трения}
\PY{c+c1}{\PYZsh{}  analytical}
\PY{n}{x0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{p0} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{omega0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{gamma} \PY{o}{=} \PY{l+m+mf}{0.0}
\PY{n}{F} \PY{o}{=} \PY{l+m+mf}{0.0}
\PY{n}{Fm} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{OMEGA} \PY{o}{=} \PY{l+m+mf}{1.4}

\PY{n}{t} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{motion\PYZus{}analytical}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{x0}\PY{p}{,} \PY{n}{p0}\PY{p}{,} \PY{n}{omega0}\PY{p}{,} \PY{n}{gamma}\PY{p}{,} \PY{n}{F}\PY{p}{,} \PY{n}{Fm}\PY{p}{,} \PY{n}{OMEGA}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Exact}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}

\PY{c+c1}{\PYZsh{}  numerical}
\PY{n}{T} \PY{o}{=} \PY{l+m+mi}{1} \PY{o}{/} \PY{n}{OMEGA}
\PY{n}{k} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
\PY{n}{beta} \PY{o}{=} \PY{l+m+mf}{0.0}

\PY{n}{z0} \PY{o}{=} \PY{p}{[}\PY{n}{x0}\PY{p}{,} \PY{n}{p0}\PY{p}{]}
\PY{n}{sol1} \PY{o}{=} \PY{n}{odeintw}\PY{p}{(}\PY{n}{diff\PYZus{}eq}\PY{p}{,} \PY{n}{z0}\PY{p}{,} \PY{n}{t}\PY{p}{,} \PY{n}{atol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{rtol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{mxstep}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{num\PYZus{}p} \PY{o}{=} \PY{n}{sol1}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{sol1}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}
\PY{n}{a} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ODEint}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.legend(bbox\PYZus{}to\PYZus{}anchor=(1.05, 1), loc=\PYZsq{}upper left\PYZsq{})}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.xlim([10, 20])}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time series for \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{gamma\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{gamma}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{omega\PYZus{}0\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{omega}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{F}\PY{p}{)} \PY{o}{+}
         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F\PYZus{}m=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{Fm}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Omega=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{OMEGA}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_12_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{8}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}  линейный осциллятор с трением gamma \PYZlt{} omega0}
\PY{c+c1}{\PYZsh{}  analytical}
\PY{n}{x0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{p0} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{omega0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{gamma} \PY{o}{=} \PY{l+m+mf}{0.1}
\PY{n}{F} \PY{o}{=} \PY{l+m+mf}{0.0}
\PY{n}{Fm} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{OMEGA} \PY{o}{=} \PY{l+m+mf}{1.4}

\PY{n}{T} \PY{o}{=} \PY{l+m+mi}{1} \PY{o}{/} \PY{n}{OMEGA}
\PY{n}{k} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
\PY{n}{beta} \PY{o}{=} \PY{l+m+mf}{0.1}

\PY{n}{t} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{motion\PYZus{}analytical}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{x0}\PY{p}{,} \PY{n}{p0}\PY{p}{,} \PY{n}{omega0}\PY{p}{,} \PY{n}{gamma}\PY{p}{,} \PY{n}{F}\PY{p}{,} \PY{n}{Fm}\PY{p}{,} \PY{n}{OMEGA}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Exact}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}

\PY{c+c1}{\PYZsh{}  numerical}
\PY{n}{T} \PY{o}{=} \PY{l+m+mi}{1} \PY{o}{/} \PY{n}{OMEGA}
\PY{n}{k} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
\PY{n}{beta} \PY{o}{=} \PY{l+m+mf}{0.0}

\PY{n}{z0} \PY{o}{=} \PY{p}{[}\PY{n}{x0}\PY{p}{,} \PY{n}{p0}\PY{p}{]}
\PY{n}{sol1} \PY{o}{=} \PY{n}{odeintw}\PY{p}{(}\PY{n}{diff\PYZus{}eq}\PY{p}{,} \PY{n}{z0}\PY{p}{,} \PY{n}{t}\PY{p}{,} \PY{n}{atol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{rtol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{mxstep}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{num\PYZus{}p} \PY{o}{=} \PY{n}{sol1}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{sol1}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}
\PY{n}{a} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ODEint}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.legend(bbox\PYZus{}to\PYZus{}anchor=(1.05, 1), loc=\PYZsq{}upper left\PYZsq{})}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.xlim([10, 20])}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time series for \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{gamma\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{gamma}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{omega\PYZus{}0\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{omega}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{F}\PY{p}{)} \PY{o}{+}
         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F\PYZus{}m=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{Fm}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Omega=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{OMEGA}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_13_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{9}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}  линейный осциллятор с трением gamma \PYZgt{} omega0}
\PY{c+c1}{\PYZsh{}  analytical}
\PY{n}{x0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{p0} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{omega0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{gamma} \PY{o}{=} \PY{l+m+mf}{1.1}
\PY{n}{F} \PY{o}{=} \PY{l+m+mf}{0.0}
\PY{n}{Fm} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{OMEGA} \PY{o}{=} \PY{l+m+mf}{1.4}

\PY{n}{T} \PY{o}{=} \PY{l+m+mi}{1} \PY{o}{/} \PY{n}{OMEGA}
\PY{n}{k} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
\PY{n}{beta} \PY{o}{=} \PY{l+m+mf}{0.1}

\PY{n}{t} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{motion\PYZus{}analytical}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{x0}\PY{p}{,} \PY{n}{p0}\PY{p}{,} \PY{n}{omega0}\PY{p}{,} \PY{n}{gamma}\PY{p}{,} \PY{n}{F}\PY{p}{,} \PY{n}{Fm}\PY{p}{,} \PY{n}{OMEGA}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Exact}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}

\PY{c+c1}{\PYZsh{}  numerical}
\PY{n}{T} \PY{o}{=} \PY{l+m+mi}{1} \PY{o}{/} \PY{n}{OMEGA}
\PY{n}{k} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
\PY{n}{beta} \PY{o}{=} \PY{l+m+mf}{0.0}

\PY{n}{z0} \PY{o}{=} \PY{p}{[}\PY{n}{x0}\PY{p}{,} \PY{n}{p0}\PY{p}{]}
\PY{n}{sol1} \PY{o}{=} \PY{n}{odeintw}\PY{p}{(}\PY{n}{diff\PYZus{}eq}\PY{p}{,} \PY{n}{z0}\PY{p}{,} \PY{n}{t}\PY{p}{,} \PY{n}{atol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{rtol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{mxstep}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{num\PYZus{}p} \PY{o}{=} \PY{n}{sol1}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{sol1}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}
\PY{n}{a} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ODEint}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.legend(bbox\PYZus{}to\PYZus{}anchor=(1.05, 1), loc=\PYZsq{}upper left\PYZsq{})}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.xlim([10, 20])}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time series for \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{gamma\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{gamma}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{omega\PYZus{}0\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{omega}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{F}\PY{p}{)} \PY{o}{+}
         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F\PYZus{}m=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{Fm}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Omega=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{OMEGA}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_14_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{10}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}  линейный осциллятор с трением gamma = omega0}
\PY{c+c1}{\PYZsh{}  analytical}
\PY{n}{x0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{p0} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{omega0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{gamma} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{F} \PY{o}{=} \PY{l+m+mf}{0.0}
\PY{n}{Fm} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{OMEGA} \PY{o}{=} \PY{l+m+mf}{1.4}

\PY{n}{T} \PY{o}{=} \PY{l+m+mi}{1} \PY{o}{/} \PY{n}{OMEGA}
\PY{n}{k} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
\PY{n}{beta} \PY{o}{=} \PY{l+m+mf}{0.1}

\PY{n}{t} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{motion\PYZus{}analytical}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{x0}\PY{p}{,} \PY{n}{p0}\PY{p}{,} \PY{n}{omega0}\PY{p}{,} \PY{n}{gamma}\PY{p}{,} \PY{n}{F}\PY{p}{,} \PY{n}{Fm}\PY{p}{,} \PY{n}{OMEGA}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Exact}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}

\PY{c+c1}{\PYZsh{}  numerical}
\PY{n}{T} \PY{o}{=} \PY{l+m+mi}{1} \PY{o}{/} \PY{n}{OMEGA}
\PY{n}{k} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
\PY{n}{beta} \PY{o}{=} \PY{l+m+mf}{0.0}

\PY{n}{z0} \PY{o}{=} \PY{p}{[}\PY{n}{x0}\PY{p}{,} \PY{n}{p0}\PY{p}{]}
\PY{n}{sol1} \PY{o}{=} \PY{n}{odeintw}\PY{p}{(}\PY{n}{diff\PYZus{}eq}\PY{p}{,} \PY{n}{z0}\PY{p}{,} \PY{n}{t}\PY{p}{,} \PY{n}{atol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{rtol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{mxstep}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{num\PYZus{}p} \PY{o}{=} \PY{n}{sol1}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{sol1}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}
\PY{n}{a} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ODEint}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.legend(bbox\PYZus{}to\PYZus{}anchor=(1.05, 1), loc=\PYZsq{}upper left\PYZsq{})}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.xlim([10, 20])}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time series for \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{gamma\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{gamma}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{omega\PYZus{}0\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{omega}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{F}\PY{p}{)} \PY{o}{+}
         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F\PYZus{}m=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{Fm}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Omega=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{OMEGA}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_15_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Различить гармонический сигнал и колебания затухающего осциллятора можно
и формально математическим способом. Для этого следует воспользоваться
аппаратом преобразования Фурье, которое разлагает произвольную функцию
времени по совокупности гармонических колебаний.

Пусть \(f(t)\) --- функция времени, удовлетворяющая достаточно общим
условиям: Фунция \(f(t)\) должна быть абсолютно интегрируемой в
промежутке \((-\infty, +\infty)\) и на любом конечном интервале
удовлетворять условиям Дирихле, т.е. иметь не более чем конечное число
разрывов первого рода и этот интервал должен допускать разбиение на
конечное число подинтервалов, на которых \(f(t)\) меняется монотонно.
Тогда ее можно представить в виде

\begin{equation}
F(\omega') = \int_{-\infty}^{+\infty} f(t) e^{- i \omega t} dt.
\end{equation}

Функция \(|F(\omega')|^2\) - спектр мощности сигнала. Из него следует,
что для затухающего колебания спектр, вообще говоря, является сплошным:
он состоит из гармонических сигналов со всеми возможными частотами от
\(-\infty\) до \(\infty\). Если затухание мало \(\gamma < \omega\), то
спектр имеет вид двух острых пиков вблизи частот
\(\omega' = \pm \omega\). Доминирующий вклад в полный сигнал дают
спектральные составляющие с частотами, лежащими вблизи этих значений.
Ширина пиков определяется величиной коэффициента затухания \(\gamma\).
Рассмотрим, например, поведение \(|F(\omega')|^2\) вблизи точки
\(\omega' = \omega\). Стоит заметить, что при \(t \in (-\infty, 0)\)
функция \(f(t)\), вообще говоря, не существует по физическим причинам.
Поэтому нижний предел в интеграле следует заменить на \(0\), полагая,
что в момент времени \(t = 0\) функция определяется начальными
условиями.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{11}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{spectrum\PYZus{}density\PYZus{}analytical}\PY{p}{(}\PY{n}{w1}\PY{p}{,} \PY{n}{x0}\PY{p}{,} \PY{n}{p0}\PY{p}{,} \PY{n}{omega0}\PY{p}{,} \PY{n}{gamma}\PY{p}{,} \PY{n}{F}\PY{p}{,} \PY{n}{Fm}\PY{p}{,} \PY{n}{OMEGA}\PY{p}{)}\PY{p}{:}
    
    \PY{c+c1}{\PYZsh{}  linear spectrum}
    \PY{k}{if} \PY{n}{gamma} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{omega} \PY{o}{=} \PY{n}{omega0}
        
        \PY{n}{C} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{F}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{D} \PY{o}{=} \PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{F}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{C1} \PY{o}{=} \PY{l+m+mi}{6}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{Fm}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{l+m+mi}{9}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{36}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{D1} \PY{o}{=} \PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{l+m+mi}{9}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{Fm}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{l+m+mi}{9}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{36}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        
        \PY{n}{A} \PY{o}{=} \PY{n}{x0} \PY{o}{\PYZhy{}} \PY{n}{D} \PY{o}{\PYZhy{}} \PY{n}{D1}
        \PY{n}{B} \PY{o}{=} \PY{p}{(}\PY{n}{p0} \PY{o}{\PYZhy{}} \PY{n}{C}\PY{o}{*}\PY{n}{OMEGA} \PY{o}{\PYZhy{}} \PY{l+m+mi}{3}\PY{o}{*}\PY{n}{C1}\PY{o}{*}\PY{n}{OMEGA}\PY{p}{)} \PY{o}{/} \PY{n}{omega}
        
        \PY{n}{x\PYZus{}w1} \PY{o}{=}  \PY{p}{(} \PY{n}{B} \PY{o}{*} \PY{n}{omega} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{p}{(} \PY{n}{omega} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{*} \PY{p}{(} \PY{n}{w1} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{+} \PYZbs{}
        \PY{p}{(} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{A} \PY{o}{*} \PY{n}{w1} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{p}{(} \PY{n}{omega} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{*} \PY{p}{(} \PY{n}{w1} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PYZbs{}
        \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{n}{C} \PY{o}{*} \PY{n}{OMEGA} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{p}{(} \PY{n}{OMEGA} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{*} \PY{p}{(} \PY{n}{w1} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PYZbs{}
        \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{D} \PY{o}{*} \PY{n}{w1} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{p}{(} \PY{n}{OMEGA} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{*} \PYZbs{}
        \PY{p}{(} \PY{n}{w1} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{l+m+mi}{3} \PY{o}{*} \PY{n}{C1} \PY{o}{*} \PY{n}{OMEGA} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{l+m+mi}{9} \PY{o}{*} \PY{p}{(} \PY{n}{OMEGA} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PYZbs{}
        \PY{p}{)} \PY{o}{+} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{*} \PY{p}{(} \PY{n}{w1} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{+} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{D1} \PY{o}{*} \PY{n}{w1} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PYZbs{}
        \PY{o}{\PYZhy{}}\PY{l+m+mi}{9} \PY{o}{*} \PY{p}{(} \PY{n}{OMEGA} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{n}{w1} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{p}{)} \PY{p}{)} \PY{p}{)} \PY{p}{)} \PY{p}{)}
        
        \PY{k}{return} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{x\PYZus{}w1}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}
    
    \PY{c+c1}{\PYZsh{}  gamma \PYZlt{} w0}
    \PY{k}{elif} \PY{n}{gamma} \PY{o}{\PYZlt{}} \PY{n}{omega0} \PY{o+ow}{and} \PY{n}{F} \PY{o}{==} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{Fm} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{omega} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{x\PYZus{}w1} \PY{o}{=} \PY{p}{(} \PY{p}{(} \PY{p}{(} \PY{n}{omega} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{p}{(} \PY{n}{gamma} \PY{o}{+} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{w1} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{p}{)} \PYZbs{}
            \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{p0} \PY{o}{+} \PY{p}{(} \PY{l+m+mi}{2} \PY{o}{*} \PY{n}{gamma} \PY{o}{*} \PY{n}{x0} \PY{o}{+} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{w1} \PY{o}{*} \PY{n}{x0} \PY{p}{)} \PY{p}{)}
        \PY{k}{return} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{x\PYZus{}w1}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}
    
    \PY{c+c1}{\PYZsh{}  gamma \PYZgt{} w0}
    \PY{k}{elif} \PY{n}{gamma} \PY{o}{\PYZgt{}} \PY{n}{omega0} \PY{o+ow}{and} \PY{n}{F} \PY{o}{==} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{Fm} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{omega} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}  \PY{p}{)}
        \PY{n}{x\PYZus{}w1} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{/}\PY{l+m+mi}{2} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{n}{gamma} \PY{o}{+} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{*} \PY{n}{omega} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{omega} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PYZbs{}
            \PY{n}{gamma} \PY{o}{+} \PY{p}{(} \PY{n}{omega} \PY{o}{+} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{w1} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PYZbs{}
                \PY{p}{)} \PY{o}{*} \PY{n}{w1} \PY{o}{*} \PY{p}{(} \PY{n}{p0} \PY{o}{+} \PY{n}{gamma} \PY{o}{*} \PY{n}{x0} \PY{p}{)} \PY{o}{+} \PY{n}{omega} \PY{o}{*} \PY{p}{(} \PY{l+m+mi}{2} \PY{o}{*} \PY{n}{p0} \PY{o}{+} \PY{p}{(} \PY{l+m+mi}{4} \PY{o}{*} \PY{n}{gamma} \PY{o}{*} \PY{n}{x0} \PY{o}{+} \PYZbs{}
                    \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{w1} \PY{o}{*} \PY{n}{x0} \PY{p}{)} \PY{p}{)} \PY{p}{)}
        \PY{k}{return} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{x\PYZus{}w1}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}
    
    \PY{c+c1}{\PYZsh{}  gamma = w0}
    \PY{k}{elif} \PY{n}{gamma} \PY{o}{==} \PY{n}{omega0} \PY{o+ow}{and} \PY{n}{F} \PY{o}{==} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{Fm} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{omega} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}  \PY{p}{)}
        \PY{n}{x\PYZus{}w1} \PY{o}{=} \PY{p}{(} \PY{p}{(} \PY{n}{gamma} \PY{o}{+} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{w1} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{2} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{p0} \PY{o}{+} \PY{p}{(} \PY{l+m+mi}{2} \PY{o}{*} \PY{n}{gamma} \PY{o}{*} \PY{n}{x0} \PYZbs{}
        \PY{o}{+} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{w1} \PY{o}{*} \PY{n}{x0} \PY{p}{)} \PY{p}{)}
        \PY{k}{return} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{x\PYZus{}w1}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}
    
    
    \PY{c+c1}{\PYZsh{}  gamma \PYZlt{} w0 with force F}
    \PY{k}{elif} \PY{n}{gamma} \PY{o}{\PYZlt{}} \PY{n}{omega0} \PY{o+ow}{and} \PY{n}{F} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{Fm} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{omega} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{C} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{F}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{D} \PY{o}{=} \PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{F}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}

        \PY{n}{A} \PY{o}{=} \PY{n}{x0} \PY{o}{\PYZhy{}} \PY{n}{D}
        \PY{n}{B} \PY{o}{=} \PY{p}{(}\PY{n}{p0} \PY{o}{+} \PY{n}{gamma}\PY{o}{*}\PY{n}{x0} \PY{o}{\PYZhy{}} \PY{n}{gamma}\PY{o}{*}\PY{n}{D} \PY{o}{\PYZhy{}} \PY{n}{C}\PY{o}{*}\PY{n}{OMEGA}\PY{p}{)} \PY{o}{/} \PY{p}{(}\PY{n}{omega}\PY{p}{)}
        \PY{n}{x\PYZus{}w1} \PY{o}{=} \PY{p}{(} \PY{n}{B} \PY{o}{*} \PY{n}{omega} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{p}{(} \PY{n}{omega} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{p}{(} \PY{n}{gamma} \PY{o}{+} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{w1} \PYZbs{}
\PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{n}{A} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{p}{(} \PY{n}{omega} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{p}{(} \PY{n}{gamma} \PY{o}{+} \PYZbs{}
\PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{w1} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{gamma} \PY{o}{+} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PYZbs{}
\PY{o}{*} \PY{n}{w1} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{p}{(} \PY{p}{(} \PY{n}{OMEGA} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{p}{(} \PY{n}{gamma} \PY{o}{+} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{w1} \PY{p}{)} \PYZbs{}
\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{D} \PY{o}{*} \PY{n}{gamma} \PY{o}{+} \PY{p}{(} \PY{n}{C} \PY{o}{*} \PY{n}{OMEGA} \PY{o}{+} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{D} \PYZbs{}
\PY{o}{*} \PY{n}{w1} \PY{p}{)} \PY{p}{)} \PY{p}{)} \PY{p}{)}
        \PY{k}{return} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{x\PYZus{}w1}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}
    
    
    \PY{c+c1}{\PYZsh{}  gamma \PYZgt{} w0 with force F}
    \PY{k}{elif} \PY{n}{gamma} \PY{o}{\PYZgt{}} \PY{n}{omega0} \PY{o+ow}{and} \PY{n}{F} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{Fm} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{omega} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{C} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{F}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{D} \PY{o}{=} \PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{F}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        
        \PY{n}{B} \PY{o}{=} \PY{p}{(} \PY{n}{x0}\PY{o}{*}\PY{p}{(}\PY{n}{omega} \PY{o}{\PYZhy{}} \PY{n}{gamma}\PY{p}{)} \PY{o}{+} \PY{n}{D}\PY{o}{*}\PY{p}{(}\PY{n}{gamma} \PY{o}{\PYZhy{}} \PY{n}{omega}\PY{p}{)} \PY{o}{+} \PY{n}{C}\PY{o}{*}\PY{n}{OMEGA} \PY{o}{\PYZhy{}} \PY{n}{p0} \PY{p}{)} \PY{o}{/}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{omega}\PY{p}{)}
        \PY{n}{A} \PY{o}{=} \PY{n}{x0} \PY{o}{\PYZhy{}} \PY{n}{B} \PY{o}{\PYZhy{}} \PY{n}{D}
        \PY{n}{x\PYZus{}w1} \PY{o}{=} \PY{p}{(} \PY{n}{A} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{n}{gamma} \PY{o}{+} \PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{*} \PY{n}{omega} \PY{o}{+} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{w1} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{+} \PYZbs{}
        \PY{p}{(} \PY{n}{B} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{n}{gamma} \PY{o}{+} \PY{p}{(} \PY{n}{omega} \PY{o}{+} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{w1} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{n}{C} \PY{o}{*} \PYZbs{}
        \PY{n}{OMEGA} \PY{o}{+} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{D} \PY{o}{*} \PY{n}{w1} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{p}{(} \PY{n}{OMEGA} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{*} \PY{p}{(} \PY{n}{w1} \PYZbs{}
        \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{p}{)} \PY{p}{)}
        \PY{k}{return} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{x\PYZus{}w1}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}
    
    
    \PY{c+c1}{\PYZsh{}  gamma = w0 with force F}
    \PY{k}{elif} \PY{n}{gamma} \PY{o}{==} \PY{n}{omega0} \PY{o+ow}{and} \PY{n}{F} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{Fm} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{omega} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        
        \PY{n}{C} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{F}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{D} \PY{o}{=} \PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{F}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{A} \PY{o}{=} \PY{n}{x0} \PY{o}{\PYZhy{}} \PY{n}{D}
        \PY{n}{B} \PY{o}{=} \PY{n}{p0} \PY{o}{+} \PY{n}{gamma}\PY{o}{*}\PY{n}{x0} \PY{o}{\PYZhy{}} \PY{n}{gamma}\PY{o}{*}\PY{n}{D} \PY{o}{\PYZhy{}} \PY{n}{C}\PY{o}{*}\PY{n}{OMEGA}
        
        \PY{n}{x\PYZus{}w1} \PY{o}{=} \PY{p}{(} \PY{p}{(} \PY{n}{B} \PY{o}{+} \PY{n}{A} \PY{o}{*} \PY{p}{(} \PY{n}{gamma} \PY{o}{+} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{w1} \PY{p}{)} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{n}{gamma} \PY{o}{+} \PY{n+nb}{complex}\PY{p}{(} \PYZbs{}
        \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{w1} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{n}{C} \PY{o}{*} \PY{n}{OMEGA} \PY{o}{+} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{D} \PY{o}{*} \PY{n}{w1} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PYZbs{}
        \PY{p}{(} \PY{p}{(} \PY{n}{OMEGA} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{*} \PY{p}{(} \PY{n}{w1} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{p}{)}
        \PY{k}{return} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{x\PYZus{}w1}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}
    
    
    \PY{c+c1}{\PYZsh{}  gamma \PYZlt{} w0 with two forces F and Fm}
    \PY{k}{elif} \PY{n}{gamma} \PY{o}{\PYZlt{}} \PY{n}{omega0} \PY{o+ow}{and} \PY{n}{F} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{Fm} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{omega} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        
        \PY{n}{C} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{F}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{D} \PY{o}{=} \PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{F}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{C1} \PY{o}{=} \PY{l+m+mi}{6}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{Fm}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{l+m+mi}{9}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{36}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{D1} \PY{o}{=} \PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{l+m+mi}{9} \PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{Fm}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{l+m+mi}{9}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{36}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        
        \PY{n}{A} \PY{o}{=} \PY{n}{x0} \PY{o}{\PYZhy{}} \PY{n}{D} \PY{o}{\PYZhy{}} \PY{n}{D1}
        \PY{n}{B} \PY{o}{=} \PY{p}{(}\PY{n}{p0} \PY{o}{+} \PY{n}{gamma}\PY{o}{*}\PY{n}{x0} \PY{o}{\PYZhy{}} \PY{n}{gamma}\PY{o}{*}\PY{n}{D} \PY{o}{\PYZhy{}} \PY{n}{gamma}\PY{o}{*}\PY{n}{D1} \PY{o}{\PYZhy{}} \PY{n}{C}\PY{o}{*}\PY{n}{OMEGA} \PY{o}{\PYZhy{}} \PY{l+m+mi}{3}\PY{o}{*}\PY{n}{C1}\PY{o}{*}\PY{n}{OMEGA}\PY{p}{)} \PY{o}{/} \PY{p}{(}\PY{n}{omega}\PY{p}{)}
        
        \PY{n}{x\PYZus{}w1} \PY{o}{=} \PY{p}{(} \PY{n}{B} \PY{o}{*} \PY{n}{omega} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{p}{(} \PY{n}{omega} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{p}{(} \PY{n}{gamma} \PY{o}{+} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{w1} \PYZbs{}
        \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{n}{A} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{p}{(} \PY{n}{omega} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{p}{(} \PY{n}{gamma} \PY{o}{+} \PYZbs{}
        \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{w1} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{gamma} \PY{o}{+} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PYZbs{}
        \PY{o}{*} \PY{n}{w1} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{p}{(} \PY{p}{(} \PY{p}{(} \PY{n}{OMEGA} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{p}{(} \PY{n}{gamma} \PY{o}{+} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{w1} \PY{p}{)} \PYZbs{}
        \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{D} \PY{o}{*} \PY{n}{gamma} \PY{o}{+} \PY{p}{(} \PY{n}{C} \PY{o}{*} \PY{n}{OMEGA} \PY{o}{+} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{D} \PYZbs{}
        \PY{o}{*} \PY{n}{w1} \PY{p}{)} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{p}{(} \PY{l+m+mi}{9} \PY{o}{*} \PY{p}{(} \PY{n}{OMEGA} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{p}{(} \PY{n}{gamma} \PY{o}{+} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{w1} \PYZbs{}
        \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{D1} \PY{o}{*} \PY{n}{gamma} \PY{o}{+} \PY{p}{(} \PY{l+m+mi}{3} \PY{o}{*} \PY{n}{C1} \PY{o}{*} \PY{n}{OMEGA} \PY{o}{+} \PY{n+nb}{complex}\PY{p}{(} \PYZbs{}
        \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{D1} \PY{o}{*} \PY{n}{w1} \PY{p}{)} \PY{p}{)} \PY{p}{)} \PY{p}{)} \PY{p}{)}
        \PY{k}{return} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{x\PYZus{}w1}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}
    
    
    \PY{c+c1}{\PYZsh{}  gamma \PYZgt{} w0 with two forces F and Fm}
    \PY{k}{elif} \PY{n}{gamma} \PY{o}{\PYZgt{}} \PY{n}{omega0} \PY{o+ow}{and} \PY{n}{F} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{Fm} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{omega} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{C} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{F}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{D} \PY{o}{=} \PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{F}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{C1} \PY{o}{=} \PY{l+m+mi}{6}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{Fm}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{l+m+mi}{9}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{36}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{D1} \PY{o}{=} \PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{l+m+mi}{9}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{Fm}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{l+m+mi}{9}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{36}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        
        \PY{n}{B} \PY{o}{=} \PY{p}{(} \PY{n}{x0}\PY{o}{*}\PY{p}{(}\PY{n}{omega} \PY{o}{\PYZhy{}} \PY{n}{gamma}\PY{p}{)} \PY{o}{+} \PY{n}{D}\PY{o}{*}\PY{p}{(}\PY{n}{gamma} \PY{o}{\PYZhy{}} \PY{n}{omega}\PY{p}{)} \PY{o}{+} \PY{l+m+mi}{3}\PY{o}{*}\PY{n}{D1}\PY{o}{*}\PY{p}{(}\PY{n}{gamma} \PY{o}{\PYZhy{}} \PY{n}{omega}\PY{p}{)} \PY{o}{+}
             \PY{n}{C}\PY{o}{*}\PY{n}{OMEGA} \PY{o}{+} \PY{l+m+mi}{3}\PY{o}{*}\PY{n}{C1}\PY{o}{*}\PY{n}{OMEGA} \PY{o}{\PYZhy{}} \PY{n}{p0} \PY{p}{)} \PY{o}{/}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{omega}\PY{p}{)}
        \PY{n}{A} \PY{o}{=} \PY{n}{x0} \PY{o}{\PYZhy{}} \PY{n}{B} \PY{o}{\PYZhy{}} \PY{n}{D} \PY{o}{\PYZhy{}} \PY{n}{D1}
        
        \PY{n}{x\PYZus{}w1} \PY{o}{=} \PY{p}{(} \PY{n}{A} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{n}{gamma} \PY{o}{+} \PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{*} \PY{n}{omega} \PY{o}{+} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{w1} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{+} \PYZbs{}
        \PY{p}{(} \PY{n}{B} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{n}{gamma} \PY{o}{+} \PY{p}{(} \PY{n}{omega} \PY{o}{+} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{w1} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{n}{C} \PY{o}{*} \PYZbs{}
        \PY{n}{OMEGA} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{p}{(} \PY{n}{OMEGA} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{*} \PY{p}{(} \PY{n}{w1} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PYZbs{}
        \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{D} \PY{o}{*} \PY{n}{w1} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{p}{(} \PY{n}{OMEGA} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{*} \PY{p}{(} \PY{n}{w1} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{p}{)} \PYZbs{}
        \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{l+m+mi}{3} \PY{o}{*} \PY{n}{C1} \PY{o}{*} \PY{n}{OMEGA} \PY{o}{+} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{D1} \PY{o}{*} \PY{n}{w1} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{l+m+mi}{9} \PY{o}{*} \PY{p}{(} \PYZbs{}
        \PY{n}{OMEGA} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{*} \PY{p}{(} \PY{n}{w1} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{p}{)} \PY{p}{)} \PY{p}{)} \PY{p}{)}
        \PY{k}{return} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{x\PYZus{}w1}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}
    
    
    \PY{c+c1}{\PYZsh{}  gamma = w0 with two forces F and Fm}
    \PY{k}{elif} \PY{n}{gamma} \PY{o}{==} \PY{n}{omega0} \PY{o+ow}{and} \PY{n}{F} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{Fm} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{omega} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        
        \PY{n}{C} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{F}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{D} \PY{o}{=} \PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{F}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{4}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{C1} \PY{o}{=} \PY{l+m+mi}{6}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{n}{Fm}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{l+m+mi}{9}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{36}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{D1} \PY{o}{=} \PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{l+m+mi}{9}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{Fm}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{l+m+mi}{9}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{l+m+mi}{36}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        
        \PY{n}{A} \PY{o}{=} \PY{n}{x0} \PY{o}{\PYZhy{}} \PY{n}{D} \PY{o}{\PYZhy{}} \PY{n}{D1}
        \PY{n}{B} \PY{o}{=} \PY{n}{p0} \PY{o}{+} \PY{n}{gamma}\PY{o}{*}\PY{n}{x0} \PY{o}{\PYZhy{}} \PY{n}{gamma}\PY{o}{*}\PY{n}{D} \PY{o}{\PYZhy{}} \PY{n}{C}\PY{o}{*}\PY{n}{OMEGA} \PY{o}{\PYZhy{}} \PY{n}{gamma}\PY{o}{*}\PY{n}{D1} \PY{o}{\PYZhy{}} \PY{n}{C1}\PY{o}{*}\PY{n}{OMEGA}\PY{o}{*}\PY{l+m+mi}{3}
        
        \PY{n}{x\PYZus{}w1} \PY{o}{=} \PY{p}{(} \PY{n}{B} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{n}{gamma} \PY{o}{+} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{w1} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{n}{A} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{n}{gamma} \PY{o}{+} \PYZbs{}
        \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{w1} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{n}{C} \PY{o}{*} \PY{n}{OMEGA} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{p}{(} \PY{n}{OMEGA} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PYZbs{}
        \PY{o}{+} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{*} \PY{p}{(} \PY{n}{w1} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{D} \PY{o}{*} \PY{n}{w1} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{p}{(} \PYZbs{}
        \PY{n}{OMEGA} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{*} \PY{p}{(} \PY{n}{w1} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{l+m+mi}{3} \PY{o}{*} \PY{n}{C1} \PY{o}{*} \PY{n}{OMEGA} \PY{o}{+} \PYZbs{}
        \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{D1} \PY{o}{*} \PY{n}{w1} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{l+m+mi}{9} \PY{o}{*} \PY{p}{(} \PY{n}{OMEGA} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{*} \PY{p}{(} \PY{n}{w1} \PYZbs{}
        \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{p}{)} \PY{p}{)} \PY{p}{)} \PY{p}{)}
        \PY{k}{return} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{x\PYZus{}w1}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{12}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{scipy} \PY{k}{as} \PY{n+nn}{sp}


\PY{c+c1}{\PYZsh{}  линейный осциллятор с трением gamma = omega0}
\PY{c+c1}{\PYZsh{}  analytical}
\PY{n}{x0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{p0} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{omega0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{gamma} \PY{o}{=} \PY{l+m+mf}{0.01}
\PY{n}{F} \PY{o}{=} \PY{l+m+mf}{0.0}
\PY{n}{Fm} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{OMEGA} \PY{o}{=} \PY{l+m+mf}{1.4}


\PY{n}{t} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mf}{0.1}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{o}{/}\PY{n}{omega0}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{motion\PYZus{}analytical}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{x0}\PY{p}{,} \PY{n}{p0}\PY{p}{,} \PY{n}{omega0}\PY{p}{,} \PY{n}{gamma}\PY{p}{,} \PY{n}{F}\PY{p}{,} \PY{n}{Fm}\PY{p}{,} \PY{n}{OMEGA}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Exact}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}


\PY{c+c1}{\PYZsh{}  numerical}
\PY{n}{T} \PY{o}{=} \PY{l+m+mi}{1} \PY{o}{/} \PY{n}{OMEGA}
\PY{n}{k} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
\PY{n}{beta} \PY{o}{=} \PY{l+m+mf}{0.0}

\PY{n}{z0} \PY{o}{=} \PY{p}{[}\PY{n}{x0}\PY{p}{,} \PY{n}{p0}\PY{p}{]}
\PY{n}{sol1} \PY{o}{=} \PY{n}{odeintw}\PY{p}{(}\PY{n}{diff\PYZus{}eq}\PY{p}{,} \PY{n}{z0}\PY{p}{,} \PY{n}{t}\PY{p}{,} \PY{n}{atol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{rtol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{mxstep}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{num\PYZus{}p} \PY{o}{=} \PY{n}{sol1}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{sol1}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}
\PY{n}{a} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ODEint}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.legend(bbox\PYZus{}to\PYZus{}anchor=(1.05, 1), loc=\PYZsq{}upper left\PYZsq{})}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.xlim([10, 20])}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time series for \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{gamma\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{gamma}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{omega\PYZus{}0\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{omega}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{F}\PY{p}{)} \PY{o}{+}
         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F\PYZus{}m=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{Fm}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Omega=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{OMEGA}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{}  spectral density}
\PY{c+c1}{\PYZsh{}  analytical}
\PY{n}{ww} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{analit\PYZus{}psd} \PY{o}{=} \PY{n}{spectrum\PYZus{}density\PYZus{}analytical}\PY{p}{(}\PY{n}{ww}\PY{p}{,} \PY{n}{x0}\PY{p}{,} \PY{n}{p0}\PY{p}{,} \PY{n}{omega0}\PY{p}{,} \PY{n}{gamma}\PY{p}{,} \PY{n}{F}\PY{p}{,} \PY{n}{Fm}\PY{p}{,} \PY{n}{OMEGA}\PY{p}{)}
\PY{n}{analit\PYZus{}psd} \PY{o}{/}\PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{analit\PYZus{}psd}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{ww}\PY{p}{,} \PY{n}{analit\PYZus{}psd}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Exact PSD}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.xticks(np.arange(min(ww), max(ww)+1, 1.0))}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Spectral density for \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{gamma\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{gamma}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}omega\PYZus{}0\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{omega}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{F}\PY{p}{)} \PY{o}{+}
         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F\PYZus{}m=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{Fm}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Omega=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{OMEGA}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.show()}


\PY{c+c1}{\PYZsh{}  numerical}
\PY{n}{signal} \PY{o}{=} \PY{n}{num\PYZus{}q}
\PY{n}{fourier} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{sp}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fft}\PY{p}{(}\PY{n}{signal}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}
\PY{n}{fourier} \PY{o}{/}\PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{fourier}\PY{p}{)}

\PY{n}{n} \PY{o}{=} \PY{n}{signal}\PY{o}{.}\PY{n}{size}
\PY{n}{timestep} \PY{o}{=} \PY{l+m+mf}{0.1}
\PY{n}{freq} \PY{o}{=} \PY{n}{sp}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fftfreq}\PY{p}{(}\PY{n}{n}\PY{p}{,} \PY{n}{d}\PY{o}{=}\PY{n}{timestep}\PY{p}{)}
\PY{n}{mask} \PY{o}{=} \PY{n}{freq}\PY{o}{\PYZgt{}}\PY{o}{=}\PY{l+m+mi}{0}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{freq}\PY{p}{[}\PY{n}{mask}\PY{p}{]}\PY{p}{,} \PY{n}{fourier}\PY{p}{[}\PY{n}{mask}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SciPy PSD}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{markersize}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.plot(freq[\PYZti{}mask], fourier[\PYZti{}mask])  \PYZsh{}  отрицательная часть ввиду симметрии преобразования Фурье}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_18_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_18_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Шириной спектра можно считать величину \(2 \gamma\)

    \hypertarget{ux432ux44bux43dux443ux436ux434ux435ux43dux43dux44bux435-ux43aux43eux43bux435ux431ux430ux43dux438ux44f-ux441-ux442ux440ux435ux43dux438ux435ux43c}{%
\subsubsection{2.2.2. Вынужденные колебания с
трением}\label{ux432ux44bux43dux443ux436ux434ux435ux43dux43dux44bux435-ux43aux43eux43bux435ux431ux430ux43dux438ux44f-ux441-ux442ux440ux435ux43dux438ux435ux43c}}

Учтем наличие диссипации в системе и внешнее воздействие:

\begin{equation}
    \label{1}
    \omega_{0}^{2} x + 2 \gamma \dot{x}  +\ddot{x} = F \cos(\Omega t).
\end{equation}

В данном случае решение уравнение будет представляться суммой решения
соответствующего неоднородного уравнения, которое было найдено выше, и
решения частного неоднородного уравнения. Решение неоднородного
уравнения ищется в виде:

\begin{equation}
    \tilde{x}(t) = C \cos(\Omega t) + D \sin(\Omega t)
\end{equation}

После подстановки в \eqref{1} имеем:

\begin{align}
    \tilde{x}(t) =& C \cos(\Omega t) + D \sin(\Omega t),\\
    \tilde{p}(t) =& -C \Omega \sin(\Omega t) + D \Omega \cos(\Omega t),
\end{align}

\[ C = \dfrac{F (\omega_0^2 - \Omega^2 )}{( (\omega_0^2 - \Omega^2 )^2 + 4\gamma^2 \Omega^2 )}, 
D = \dfrac{2\gamma \Omega F}{( (\omega_0^2 - \Omega^2 )^2 + 4\gamma^2 \Omega^2 )} \].
Константы однородного решения находятся из начальных условий с учетом
частного неоднородного решения.

\hypertarget{ux441ux43bux443ux447ux430ux439-mathbfgamma-omega_0}{%
\paragraph{\texorpdfstring{Случай
\(\mathbf{\gamma < \omega_0}\)}{Случай \textbackslash mathbf\{\textbackslash gamma \textless{} \textbackslash omega\_0\}}}\label{ux441ux43bux443ux447ux430ux439-mathbfgamma-omega_0}}

\begin{align}
    x(t) = & e^{-\gamma t} (A \cos(w t) + B \sin(w t)) + C \cos(\Omega t) + D \sin(\Omega t), \\
    p(t) = & -\gamma e^{-\gamma t} (A \cos(w t) + B \sin(w t)) + 
        e^{-\gamma t} (- A \omega \sin(w t) + B \omega \cos(w t)) -C \Omega \sin(\Omega t) + D \Omega \cos(\Omega t),
\end{align}

\[ A = x_0 - C, B = \dfrac{p_0 + \gamma x_0 - \gamma C - D \Omega}{\omega}. \]

\hypertarget{ux441ux43bux443ux447ux430ux439-mathbfgamma-omega_0-1}{%
\paragraph{\texorpdfstring{Случай
\(\mathbf{\gamma > \omega_0}\)}{Случай \textbackslash mathbf\{\textbackslash gamma \textgreater{} \textbackslash omega\_0\}}}\label{ux441ux43bux443ux447ux430ux439-mathbfgamma-omega_0-1}}

\(\omega = \sqrt{\gamma^2 - \omega_0^2}.\)

\begin{align}
    x(t) = & A e^{(\omega - \gamma) t} + B e^{-(\omega + \gamma) t} + C \cos(\Omega t) + D \sin(\Omega t), \\
    p(t) = & A (\omega - \gamma) e^{(\omega - \gamma) t} - B (\omega + \gamma) e^{-(\omega + \gamma) t} -C \Omega \sin(\Omega t) + D \Omega \cos(\Omega t),
\end{align}

\[ A = x_0 - B - C, 
B = \dfrac{(\omega - \gamma)(x_0 - C) - p_0 + D \Omega}{2 \omega}. \]

\hypertarget{ux441ux43bux443ux447ux430ux439-mathbfgamma-omega_0-2}{%
\paragraph{\texorpdfstring{Случай
\(\mathbf{\gamma = \omega_0}\)}{Случай \textbackslash mathbf\{\textbackslash gamma = \textbackslash omega\_0\}}}\label{ux441ux43bux443ux447ux430ux439-mathbfgamma-omega_0-2}}

\(\omega = \omega_0.\)

\begin{align}
    x(t) = & (A + B t) e^{-\gamma t} + C \cos(\Omega t) + D \sin(\Omega t), \\
    p(t) = & -\gamma (A + B t) e^{-\gamma t} + B e^{-\gamma t} - C \Omega \sin(\Omega t) + D \Omega \cos(\Omega t),
\end{align}

\[ A = x_0 - C, 
B = p_0 + \gamma x_0 - \gamma C - D \Omega. \]

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{13}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{psd}\PY{p}{(}\PY{n}{w1}\PY{p}{)}\PY{p}{:}
    \PY{k}{return} \PY{n+nb}{abs}\PY{p}{(}\PY{p}{(} \PY{p}{(} \PY{n}{gamma} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{*} \PY{n}{omega0} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{gamma} \PY{o}{+} \PY{n}{omega0} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{1}\PY{o}{/}\PY{l+m+mi}{2} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{p}{(} \PY{n}{gamma} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PYZbs{}
\PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{*} \PY{p}{(} \PY{n}{omega0} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{o}{/}\PY{l+m+mi}{2} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{n}{OMEGA} \PY{o}{+} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{*} \PY{n}{w1} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PYZbs{}
\PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{n}{OMEGA} \PY{o}{+} \PY{n}{w1} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{omega0} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{l+m+mi}{2} \PYZbs{}
\PY{o}{*} \PY{n}{gamma} \PY{o}{+} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{w1} \PY{p}{)} \PY{o}{*} \PY{n}{w1} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{F} \PY{o}{*} \PY{n}{w1} \PY{o}{+} \PY{p}{(} \PY{n}{OMEGA} \PY{o}{+} \PYZbs{}
\PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{*} \PY{n}{w1} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{OMEGA} \PY{o}{+} \PY{n}{w1} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{n}{p0} \PY{o}{+} \PY{p}{(} \PY{n+nb}{complex}\PY{p}{(} \PY{l+m+mi}{0}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{2} \PY{p}{)} \PY{o}{*} \PYZbs{}
\PY{n}{gamma} \PY{o}{+} \PY{n}{w1} \PY{p}{)} \PY{o}{*} \PY{n}{x0} \PY{p}{)} \PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}


\PY{c+c1}{\PYZsh{}  вынужденные колебания с трением gamma \PYZlt{} omega0}
\PY{c+c1}{\PYZsh{}  analytical}
\PY{n}{x0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{p0} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{omega0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{gamma} \PY{o}{=} \PY{l+m+mf}{0.01}
\PY{n}{F} \PY{o}{=} \PY{l+m+mf}{0.5}
\PY{n}{Fm} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{OMEGA} \PY{o}{=} \PY{l+m+mf}{1.4}

\PY{n}{t} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mf}{0.1}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{o}{/}\PY{n}{omega0}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{motion\PYZus{}analytical}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{x0}\PY{p}{,} \PY{n}{p0}\PY{p}{,} \PY{n}{omega0}\PY{p}{,} \PY{n}{gamma}\PY{p}{,} \PY{n}{F}\PY{p}{,} \PY{n}{Fm}\PY{p}{,} \PY{n}{OMEGA}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Exact}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}

\PY{c+c1}{\PYZsh{}  numerical}
\PY{n}{T} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi} \PY{o}{/} \PY{n}{OMEGA}
\PY{n}{k} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
\PY{n}{beta} \PY{o}{=} \PY{l+m+mf}{0.0}

\PY{n}{z0} \PY{o}{=} \PY{p}{[}\PY{n}{x0}\PY{p}{,} \PY{n}{p0}\PY{p}{]}
\PY{n}{sol1} \PY{o}{=} \PY{n}{odeintw}\PY{p}{(}\PY{n}{diff\PYZus{}eq}\PY{p}{,} \PY{n}{z0}\PY{p}{,} \PY{n}{t}\PY{p}{,} \PY{n}{atol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{rtol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{mxstep}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{num\PYZus{}p} \PY{o}{=} \PY{n}{sol1}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{sol1}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ODEint}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.legend(bbox\PYZus{}to\PYZus{}anchor=(1.05, 1), loc=\PYZsq{}upper left\PYZsq{})}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.xlim([10, 20])}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time series for \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{gamma\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{gamma}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{omega\PYZus{}0\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{omega}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{F}\PY{p}{)} \PY{o}{+}
         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F\PYZus{}m=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{Fm}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Omega=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{OMEGA}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{}  spectral density}
\PY{c+c1}{\PYZsh{}  analytical}
\PY{n}{nw} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{num\PYZus{}q}\PY{p}{)}
\PY{n}{ww} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mi}{1375}\PY{p}{)}
\PY{n}{analit\PYZus{}psd} \PY{o}{=} \PY{n}{spectrum\PYZus{}density\PYZus{}analytical}\PY{p}{(}\PY{n}{ww}\PY{p}{,} \PY{n}{x0}\PY{p}{,} \PY{n}{p0}\PY{p}{,} \PY{n}{omega0}\PY{p}{,} \PY{n}{gamma}\PY{p}{,} \PY{n}{F}\PY{p}{,} \PY{n}{Fm}\PY{p}{,} \PY{n}{OMEGA}\PY{p}{)}
\PY{c+c1}{\PYZsh{}analit\PYZus{}psd /= np.mean(analit\PYZus{}psd)}
\PY{n}{analit\PYZus{}psd} \PY{o}{/}\PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{analit\PYZus{}psd}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.plot(ww, analit\PYZus{}psd, label=\PYZsq{}Exact PSD 2\PYZsq{}, lw=2)}
\PY{c+c1}{\PYZsh{}plt.xticks(np.arange(min(ww), max(ww)+1, 1.0))}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Spectral density for \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{gamma\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{gamma}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}omega\PYZus{}0\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{omega}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{F}\PY{p}{)} \PY{o}{+}
         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F\PYZus{}m=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{Fm}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Omega=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{OMEGA}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.show()}


\PY{c+c1}{\PYZsh{}  numerical}
\PY{n}{signal} \PY{o}{=} \PY{n}{num\PYZus{}q}
\PY{n}{fourier} \PY{o}{=} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{sp}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fft}\PY{p}{(}\PY{n}{signal}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}
\PY{c+c1}{\PYZsh{}fourier = np.mean(fourier)}
\PY{n}{fourier} \PY{o}{/}\PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{fourier}\PY{p}{)}

\PY{n}{n} \PY{o}{=} \PY{n}{signal}\PY{o}{.}\PY{n}{size}
\PY{n}{timestep} \PY{o}{=} \PY{l+m+mf}{0.1}
\PY{n}{freq} \PY{o}{=} \PY{n}{sp}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fftfreq}\PY{p}{(}\PY{n}{n}\PY{p}{,} \PY{n}{d}\PY{o}{=}\PY{n}{timestep}\PY{p}{)}
\PY{n}{mask} \PY{o}{=} \PY{n}{freq}\PY{o}{\PYZgt{}}\PY{o}{=}\PY{l+m+mi}{0}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{freq}\PY{p}{[}\PY{n}{mask}\PY{p}{]}\PY{p}{,} \PY{n}{fourier}\PY{p}{[}\PY{n}{mask}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SciPy PSD}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.plot(freq[\PYZti{}mask], fourier[\PYZti{}mask])  \PYZsh{}  отрицательная часть ввиду симметрии преобразования Фурье}

\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.xlim([0,3])}

\PY{n}{anl} \PY{o}{=} \PY{n}{psd}\PY{p}{(}\PY{n}{ww}\PY{p}{)}
\PY{n}{anl} \PY{o}{/}\PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{anl}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{ww}\PY{p}{,} \PY{n}{anl}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Exact PSD}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{omega\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}|x( }\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{omega)|\PYZca{}2\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_21_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_21_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    В этом случае наблюдается появление гармоники на частоте \(\Omega\)
вынуждающей силы. При установившемся движении, когда система совершает
вынужденные колебания, ее энергия остается неизменной, в то же время
система от источника внешней силы непрерывно поглощает энергию, которая
диссипируется из-за наличия трения. Обозначим \(I(\Omega)\) количество
энергии, поглощаемой в среднем в единицу времени, как функцию частоты
внешней силы:

\begin{equation}
    I(\Omega) = 2 \overline{F},
\end{equation}

где \(\overline{F}\) - среднее по периоду колебания значение
диссипативной функции. В одномерном случае:
\[ F = \gamma \dot{x}^2 = \gamma b^2 \Omega^2, \] где
\(b = \sqrt{C^2 + D^2}, \tan{(\phi)} = \gamma / \varepsilon, \varepsilon = \Omega - \omega.\)

\begin{equation}
    F = \gamma b^2 \Omega^2 \sin^2(\Omega t + \delta).
\end{equation}

Среднее по времени от квадрата синуса равно \(1/2\), поэтому

\begin{equation}
    I(\varepsilon) = \gamma b^2 \Omega^2 = \dfrac{F^2 \gamma}{4(\varepsilon^2 - \gamma^2)},
\end{equation}

\begin{equation}
    I(0) = \dfrac{F^2}{4 \gamma}.
\end{equation}

Построим резонансную кривую.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{14}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}  вынужденные колебания с трением gamma \PYZlt{} omega0}
\PY{c+c1}{\PYZsh{}  analytical}

\PY{k}{def} \PY{n+nf}{I}\PY{p}{(}\PY{n}{eps}\PY{p}{)}\PY{p}{:}
    \PY{k}{return} \PY{p}{(}\PY{n}{F}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{*} \PY{n}{gamma}\PY{p}{)} \PY{o}{/} \PY{p}{(}\PY{l+m+mi}{4} \PY{o}{*} \PY{p}{(}\PY{n}{eps}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{n}{gamma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}

\PY{n}{x0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{p0} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{omega0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{gammas} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mf}{0.01}\PY{p}{,} \PY{l+m+mf}{0.1}\PY{p}{,} \PY{l+m+mf}{0.02}\PY{p}{)}
\PY{n}{F} \PY{o}{=} \PY{l+m+mf}{0.5}
\PY{n}{Fm} \PY{o}{=} \PY{l+m+mi}{0}

\PY{n}{i} \PY{o}{=} \PY{l+m+mi}{1}
\PY{k}{for} \PY{n}{gamma} \PY{o+ow}{in} \PY{n}{gammas}\PY{p}{:}
    
    
    \PY{n}{I\PYZus{}0} \PY{o}{=} \PY{n}{F}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{/} \PY{l+m+mi}{4} \PY{o}{/}\PY{n}{gamma}

    \PY{n}{epsilons} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{gamma}\PY{p}{,} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{gamma}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{epsilons}\PY{p}{,} \PY{n}{I}\PY{p}{(}\PY{n}{epsilons}\PY{p}{)}\PY{o}{/}\PY{n}{I\PYZus{}0}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{gamma\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{i}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n+nb}{round}\PY{p}{(}\PY{n}{gamma}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{n}{gamma}\PY{p}{,} \PY{n}{gamma}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{I}\PY{p}{(}\PY{n}{gamma}\PY{p}{)}\PY{o}{/}\PY{n}{I\PYZus{}0}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{black}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{n}{gamma}\PY{p}{,} \PY{n}{I}\PY{p}{(}\PY{n}{gamma}\PY{p}{)}\PY{o}{/}\PY{n}{I\PYZus{}0}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{gamma\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{i}\PY{p}{)}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{I}\PY{p}{(}\PY{n}{gamma}\PY{p}{)}\PY{o}{/}\PY{n}{I\PYZus{}0}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{black}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{p}{,} \PY{n}{I}\PY{p}{(}\PY{n}{gamma}\PY{p}{)}\PY{o}{/}\PY{n}{I\PYZus{}0}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}\PYZhy{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{gamma\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{i}\PY{p}{)}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{)}

    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{p}{,} \PY{n}{gamma}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{n}{I}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{p}{)}\PY{o}{/}\PY{n}{I\PYZus{}0}\PY{p}{,} \PY{n}{I}\PY{p}{(}\PY{n}{gamma}\PY{p}{)}\PY{o}{/}\PY{n}{I\PYZus{}0}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{black}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{I}\PY{p}{(}\PY{n}{gamma}\PY{p}{)}\PY{o}{/}\PY{n}{I\PYZus{}0}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}1/2\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}

    \PY{n}{plt}\PY{o}{.}\PY{n}{axvline}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{black}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{i} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}

\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}I(}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{varepsilon) / I(0)\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.grid()}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mf}{1.1}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_23_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{ux43dux435ux43bux438ux43dux435ux439ux43dux44bux439-ux43eux441ux446ux438ux43bux43bux44fux442ux43eux440-ux434ux443ux444ux444ux438ux43dux433ux430}{%
\section{3. Нелинейный осциллятор
Дуффинга}\label{ux43dux435ux43bux438ux43dux435ux439ux43dux44bux439-ux43eux441ux446ux438ux43bux43bux44fux442ux43eux440-ux434ux443ux444ux444ux438ux43dux433ux430}}

Наибольший интерес с точки зрения исследования хаоса в динамических
системах представляет как раз нелинейный осциллятор. Уравнение такого
осциллятора запишется как:

\begin{equation}
    \label{2}
    \ddot{x} + 2 \gamma \dot{x} + \omega_{0}^{2} x + \beta x^3 = F \cos(\Omega t).
\end{equation}

Так как точное аналитическое решение невозможно, следует использовать
приближенные методы. В данном случае был выбрал метод усреденения
Ван-дер-Поля.

Метод Ван-дер-Поля представляет собой простейший вариант метода
усреднения. Он был разработан Б. Ван-дер-Полем (1920) для исследования
различных автоколебательных процессов в ламповом генераторе.
Математическое обоснование этого метода было дано Л.И. Мандельштамоми,
Н.Д. Папалекси (1934). Дальнейшее развитие метод усреднения получил в
работах Н.М. Крылова, Н.Н. Боголюбова, Ю.А. Митропольского и др.

Перепишем уравнение \eqref{2} в виде: \begin{equation}
    \label{3}
    \ddot{x} + \omega_0^{2} x = -2 \gamma \dot{x} - \beta x^3 + F \cos(\Omega t), 
\end{equation}

причем будем считать, что частота внешнего воздействия близка к
собственной частоте осциллятора, \(\Omega = \omega_0 + \delta\), где
расстройка частот \(\delta\) мала. Члены, фигурирующие в правой части,
отвечают за диссипацию, нелинейность и внешнее воздействие. Если ими
пренебречь,система превращается в гармонический осциллятор. Если же они
малы, то решение целесообразно искать в виде квазигармонического
колебания с медленно меняющейся амплитудой, для которой можно получить
укороченное уравнение. Вообще, близость к линейной консервативной
системе является условием применимости метода Ван-дер-Поля. Это
позволяет представить решение в виде:

\begin{equation}
x(t)=\operatorname{Re}\left[A(t) e^{i \omega_{0} t}\right],
\end{equation}

где \(A(t)\) - медленно меняющаяся по сравнениюс \(e^{i \omega_0 t}\)
комплексная амплитуда (в связи с чем этот метод называют также методом
медленно меняющихсяа мплитуд). Продифференциируем \(x(t)\):

\begin{equation}
\dot{x}=\dot{A} e^{i \omega_0 t}+i A e^{i \omega_0 t}+\dot{A}^{*} e^{-i \omega_0 t}-i A^{*} e^{-i \omega_0 t}.
\end{equation}

Стоит отметить, что вместо одной зависимой переменной \(x\) введены две:
\(A\) и \(A^{*}\). Поэтому можно наложить между этими величинами
дополнительную связь. Удобно потребовать, чтобы

\begin{equation}
    \dot{A} e^{i \omega_0 t} + \dot{A}^{*} e^{-i \omega_0 t} = 0.
\end{equation}

Тогда

\begin{equation}
\dot{x}=i A e^{i \omega_0 t}-i A^{*} e^{-i \omega_0 t},
\end{equation}

Продифференцируем это уравнение ещё раз. Получим

\begin{equation}
\ddot{x}=i \dot{A} e^{i \omega_0 t}-A e^{i \omega_0 t}-i \dot{A}^{*} e^{-i \omega_0 t}+A^{*} e^{-i \omega_0 t}
\end{equation}

Представим член, ответственный за внешнее воздействие, в виде

\begin{equation}
F \cos \Omega t=\operatorname{Re} F e^{i \Omega t}=\dfrac{f e^{i \Omega t}+f^{*} e^{-i \Omega t}}{2}
\end{equation}

Подставляя все в исходное уравнение, можно получить:

\begin{equation}
\begin{array}{l}
i \omega_{0} \dot{A} e^{i \omega_{0} t}=-i \omega_{0} \gamma A e^{i \omega_{0} t}-i \omega_{0} \gamma A^{*} e^{-i \omega_{0} t} \\
\quad+\beta\left(\frac{1}{8} A^{3} e^{3 i \omega_{0} t}+\frac{3}{8}|A|^{2} A e^{i \omega_{0} t}+\frac{3}{8}|A|^{2} A^{*} e^{-i \omega_{0} t}+\frac{1}{8}\left(A^{*}\right)^{3} e^{-3 i \omega_{0} t}\right)+\frac{1}{2} F e^{i \Omega t}+\frac{1}{2} f^{*} e^{-i \Omega t}
\end{array}
\end{equation}

Отметим, что в уравнении все члены одного порядка малости: они либо
содержат производные от медленно меняющейся амплитуды, либо
пропорциональны малым параметрам \(\gamma, \beta\). Умножим обе части
уравнения на \(e^{- i \omega_0 t} / i \omega_0\) и проведем усреднение
по периоду основной частоты \(T = 2 \pi / \omega_0\). Операция усреднее
осуществляется следующим образом:

\begin{equation}
\langle f(t)\rangle=\frac{1}{T} \int_{0}^{T} f(t) d t.
\end{equation}

Считаем, что на этом масштабе времени изменением комплексных амплитуд
можно пренебречь. Кроме того поскольку мы рассматриваем случай, когда
частоты \(\Omega\) и \(\omega_0\) близки, то член, содержащий экспоненту
\(\exp \left[i\left(\Omega-\omega_{0}\right) t\right]=\exp [i \delta t]\),
также будет медленно меняющимся. Тогда после устранения быстро
осциллирующих членов приходим к укороченному уравнению

\begin{equation}
\label{33}
\dot{A}=-\gamma A-\frac{3 i \beta}{8 \omega_{0}}|A|^{2} A-\frac{i f}{2 \omega_{0}} e^{i \delta t}
\end{equation}

Для начала рассмотрим случай в отсутствии внешнего воздействия.

\hypertarget{ux43dux435ux43bux438ux43dux435ux439ux43dux44bux439-ux43eux441ux446ux438ux43bux43bux44fux442ux43eux440-ux434ux443ux444ux444ux438ux43dux433ux430-ux43fux440ux438}{%
\subsection{\texorpdfstring{3.1. Нелинейный осциллятор Дуффинга при \$
\mathbf{ F = 0 }\$}{3.1. Нелинейный осциллятор Дуффинга при \$ \$}}\label{ux43dux435ux43bux438ux43dux435ux439ux43dux44bux439-ux43eux441ux446ux438ux43bux43bux44fux442ux43eux440-ux434ux443ux444ux444ux438ux43dux433ux430-ux43fux440ux438}}

В отсутствии внешнего воздействия, когда \(F = 0\) , уравнение
\eqref{33} переходит в укороченное уравнение для автономного осциллятора
Дуффинга:

\begin{equation}
\label{34}
\dot{A}+\gamma A-\frac{3 i \beta|A|^{2} A}{2}=0.
\end{equation}

Перейдем к уравнениям для вещественных амплитуды и фазы. Полагая
\(A(t) = a(t) \exp{i \varphi(t)}\), отделим в \eqref{34} вещественную и
мнимую части. Получим

\begin{equation}
\label{35}
\begin{aligned}
\dot{a} =& - \gamma a,  \\
\dot{\varphi} =& \frac{3 \beta a^{2}}{8 \omega_{0}}.
\end{aligned}
\end{equation}

Решая данную систему дифференциальных уравнений, полагая, что
\(a(0) = a_0, \varphi(0) = \varphi_0\), находим уравнения для
\(a(t), \varphi(t)\):

\begin{equation}
\label{36}
\begin{aligned}
a(t) &= a_0 e^{(-\gamma t)},  \\
\varphi(t) &= \dfrac{ e^{-2 \gamma t} (3 a_0^2 \beta - 3 a_0^2 \beta e^{2 \gamma t} + 
  16 e^{2 \gamma t} \gamma \varphi_0 \omega_0 + 16 \delta e^{2 \gamma t} \gamma t \omega_0) }{ 16 \gamma \omega_0 },
\end{aligned}
\end{equation}

где \(a_0\) и \(\varphi_0\) определяются начальными условиями:

\begin{equation}
\label{37}
\begin{aligned}
a(0) &= \sqrt{x_0^2 + \dfrac{p_0}{\omega_0}},  \\
\varphi(0) &= \arctan(- \dfrac{p_0}{\omega_0 x_0}).
\end{aligned}
\end{equation}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{15}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{nonlinear\PYZus{}noforce}\PY{p}{(}\PY{n}{t}\PY{p}{)}\PY{p}{:}
    
    \PY{k+kn}{import} \PY{n+nn}{numpy}
    
    \PY{k}{return} \PY{n}{a0} \PY{o}{*} \PY{p}{(} \PY{n}{numpy}\PY{o}{.}\PY{n}{e} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{*} \PY{n}{gamma} \PY{o}{*} \PY{n}{t} \PY{p}{)} \PY{o}{*} \PY{n}{numpy}\PY{o}{.}\PY{n}{cos}\PY{p}{(} \PY{l+m+mi}{1}\PY{o}{/}\PY{l+m+mi}{16} \PY{o}{*} \PY{p}{(} \PY{n}{numpy}\PY{o}{.}\PY{n}{e} \PYZbs{}
    \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{2} \PY{o}{*} \PY{n}{gamma} \PY{o}{*} \PY{n}{t} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{gamma} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{omega0} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{l+m+mi}{3} \PY{o}{*} \PY{p}{(} \PYZbs{}
    \PY{n}{a0} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{*} \PY{n}{beta} \PY{o}{+} \PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{3} \PY{o}{*} \PY{p}{(} \PY{n}{a0} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{*} \PY{n}{beta} \PY{o}{*} \PY{p}{(} \PY{n}{numpy}\PY{o}{.}\PY{n}{e} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{o}{*} \PYZbs{}
    \PY{n}{gamma} \PY{o}{*} \PY{n}{t} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{l+m+mi}{16} \PY{o}{*} \PY{p}{(} \PY{n}{numpy}\PY{o}{.}\PY{n}{e} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{o}{*} \PY{n}{gamma} \PY{o}{*} \PY{n}{t} \PY{p}{)} \PY{o}{*} \PY{n}{gamma} \PY{o}{*} \PY{n}{phi0} \PY{o}{*} \PYZbs{}
    \PY{n}{omega0} \PY{o}{+} \PY{l+m+mi}{16} \PY{o}{*} \PY{n}{delta} \PY{o}{*} \PY{p}{(} \PY{n}{numpy}\PY{o}{.}\PY{n}{e} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{o}{*} \PY{n}{gamma} \PY{o}{*} \PY{n}{t} \PY{p}{)} \PY{o}{*} \PY{n}{gamma} \PY{o}{*} \PY{n}{t} \PY{o}{*} \PY{n}{omega0} \PY{p}{)} \PY{p}{)} \PYZbs{}
    \PY{p}{)} \PY{p}{)}


\PY{c+c1}{\PYZsh{}  нелинейные колебания с трением gamma \PYZlt{} omega0 и beta \PYZgt{} 0}
\PY{c+c1}{\PYZsh{}  analytical}
\PY{n}{x0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{p0} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{omega0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{gamma} \PY{o}{=} \PY{l+m+mf}{0.05}
\PY{n}{F} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{Fm} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{OMEGA} \PY{o}{=} \PY{l+m+mf}{1.01}
\PY{n}{beta} \PY{o}{=} \PY{l+m+mf}{0.0}

\PY{n}{a0} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{x0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{n}{p0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{/} \PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n}{phi0} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arctan}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{p0} \PY{o}{/} \PY{n}{x0} \PY{o}{/} \PY{n}{omega0}\PY{p}{)}

\PY{n}{delta} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{n}{omega0}

\PY{n}{t} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mf}{0.1}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{o}{/}\PY{n}{omega0}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{nonlinear\PYZus{}noforce}\PY{p}{(}\PY{n}{t}\PY{p}{)}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Approximation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}

\PY{c+c1}{\PYZsh{}  numerical}
\PY{n}{T} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi} \PY{o}{/} \PY{n}{OMEGA}
\PY{n}{k} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}

\PY{n}{z0} \PY{o}{=} \PY{p}{[}\PY{n}{x0}\PY{p}{,} \PY{n}{p0}\PY{p}{]}
\PY{n}{sol1} \PY{o}{=} \PY{n}{odeintw}\PY{p}{(}\PY{n}{diff\PYZus{}eq}\PY{p}{,} \PY{n}{z0}\PY{p}{,} \PY{n}{t}\PY{p}{,} \PY{n}{atol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{rtol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{mxstep}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{num\PYZus{}p} \PY{o}{=} \PY{n}{sol1}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{sol1}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ODEint}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.legend(bbox\PYZus{}to\PYZus{}anchor=(1.05, 1), loc=\PYZsq{}upper left\PYZsq{})}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.xlim([10, 20])}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time series for \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{gamma\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{gamma}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{omega\PYZus{}0\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{omega}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{F}\PY{p}{)} \PY{o}{+}
         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F\PYZus{}m=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{Fm}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Omega=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{OMEGA}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_25_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{16}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}  numerical}
\PY{n}{signal} \PY{o}{=} \PY{n}{num\PYZus{}q}
\PY{n}{fourier} \PY{o}{=} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{sp}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fft}\PY{p}{(}\PY{n}{signal}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}
\PY{c+c1}{\PYZsh{}fourier = np.mean(fourier)}
\PY{n}{fourier} \PY{o}{/}\PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{fourier}\PY{p}{)}

\PY{n}{n} \PY{o}{=} \PY{n}{signal}\PY{o}{.}\PY{n}{size}
\PY{n}{timestep} \PY{o}{=} \PY{l+m+mf}{0.1}
\PY{n}{freq} \PY{o}{=} \PY{n}{sp}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fftfreq}\PY{p}{(}\PY{n}{n}\PY{p}{,} \PY{n}{d}\PY{o}{=}\PY{n}{timestep}\PY{p}{)}
\PY{n}{mask} \PY{o}{=} \PY{n}{freq}\PY{o}{\PYZgt{}}\PY{o}{=}\PY{l+m+mi}{0}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{freq}\PY{p}{[}\PY{n}{mask}\PY{p}{]}\PY{p}{,} \PY{n}{fourier}\PY{p}{[}\PY{n}{mask}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SciPy PSD}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.plot(freq[\PYZti{}mask], fourier[\PYZti{}mask])  \PYZsh{}  отрицательная часть ввиду симметрии преобразования Фурье}

\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{omega\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}|x( }\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{omega)|\PYZca{}2\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_26_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{ux43dux435ux43bux438ux43dux435ux439ux43dux44bux439-ux43eux441ux446ux438ux43bux43bux44fux442ux43eux440-ux434ux443ux444ux444ux438ux43dux433ux430-ux43fux440ux438}{%
\subsection{\texorpdfstring{3.1. Нелинейный осциллятор Дуффинга при \$
\mathbf{ F > 0 }\$}{3.1. Нелинейный осциллятор Дуффинга при \$ \$}}\label{ux43dux435ux43bux438ux43dux435ux439ux43dux44bux439-ux43eux441ux446ux438ux43bux43bux44fux442ux43eux440-ux434ux443ux444ux444ux438ux43dux433ux430-ux43fux440ux438}}

В случае, когда \(F > 0\) , уравнение \eqref{33} переходит в укороченное
уравнение:

\begin{equation}
\label{38}
\dot{A}=-\gamma A-\frac{3 i \beta}{8 \omega_{0}}|A|^{2} A-\frac{i F}{2 \omega_{0}} e^{i \delta t}.
\end{equation}

Процедура аналогична вышеописанной, переходим к переменным амплитуда и
фаза:

\begin{equation}
\label{39}
\begin{aligned}
\dot{a} + \gamma a = \dfrac{F}{2 \omega_{0}} \sin(\delta t-\varphi), \\
\dot{\varphi} = \dfrac{3 \beta a^{2}}{8 \omega_{0}} &-\frac{F}{2 a \omega_{0}} \cos(\delta t-\varphi).
\end{aligned}
\end{equation}

Система уравнений \eqref{39} является неавтономной, так как содержит
члены зависящие явным образом от времени. Однако, вводя величину
\(\psi = \delta − \varphi\) можно получить автономную систему вида

\begin{equation}
\label{40}
\begin{array}{c}
\dot{a}+\gamma a = \dfrac{F}{2 \omega_{0}} \sin( \psi), \\
\dot{\psi} = \delta-\dfrac{3 \beta a^{2}}{8 \omega_{0}}+\dfrac{F}{2 a \omega_{0}} \cos( \psi).
\end{array}
\end{equation}

Аналитическое решение данной системы затруднено, поскольку она сама
нелинейна. Поэтому ограничимся в этом случае численным решением.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{17}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}  нелинейные колебания с трением gamma \PYZlt{} omega0 и beta \PYZgt{} 0, F \PYZgt{} 0}
\PY{n}{x0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{p0} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{omega0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{gamma} \PY{o}{=} \PY{l+m+mf}{0.05}
\PY{n}{F} \PY{o}{=} \PY{l+m+mf}{0.1}
\PY{n}{Fm} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{OMEGA} \PY{o}{=} \PY{l+m+mf}{1.01}
\PY{n}{beta} \PY{o}{=} \PY{l+m+mf}{0.0}

\PY{n}{delta} \PY{o}{=} \PY{n}{OMEGA} \PY{o}{\PYZhy{}} \PY{n}{omega0}
\PY{n}{T} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi} \PY{o}{/} \PY{n}{OMEGA}
\PY{n}{k} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}

\PY{n}{t} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{200}\PY{p}{,} \PY{l+m+mf}{0.01}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{o}{/}\PY{n}{OMEGA}\PY{p}{)}

\PY{n}{z0} \PY{o}{=} \PY{p}{[}\PY{n}{x0}\PY{p}{,} \PY{n}{p0}\PY{p}{]}
\PY{n}{sol1} \PY{o}{=} \PY{n}{odeintw}\PY{p}{(}\PY{n}{diff\PYZus{}eq}\PY{p}{,} \PY{n}{z0}\PY{p}{,} \PY{n}{t}\PY{p}{,} \PY{n}{atol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{rtol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{mxstep}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{num\PYZus{}p} \PY{o}{=} \PY{n}{sol1}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{sol1}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ODEint}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.legend(bbox\PYZus{}to\PYZus{}anchor=(1.05, 1), loc=\PYZsq{}upper left\PYZsq{})}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.xlim([10, 20])}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time series for \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{gamma\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{gamma}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{omega\PYZus{}0\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{omega}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{F}\PY{p}{)} \PY{o}{+}
         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F\PYZus{}m=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{Fm}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Omega=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{OMEGA}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}


\PY{c+c1}{\PYZsh{}  numerical}
\PY{n}{signal} \PY{o}{=} \PY{n}{num\PYZus{}q}
\PY{n}{fourier} \PY{o}{=} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{sp}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fft}\PY{p}{(}\PY{n}{signal}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}
\PY{c+c1}{\PYZsh{}fourier = np.mean(fourier)}
\PY{n}{fourier} \PY{o}{/}\PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{fourier}\PY{p}{)}

\PY{n}{n} \PY{o}{=} \PY{n}{signal}\PY{o}{.}\PY{n}{size}
\PY{n}{timestep} \PY{o}{=} \PY{l+m+mf}{0.01}
\PY{n}{freq} \PY{o}{=} \PY{n}{sp}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fftfreq}\PY{p}{(}\PY{n}{n}\PY{p}{,} \PY{n}{d}\PY{o}{=}\PY{n}{timestep}\PY{p}{)}
\PY{n}{mask} \PY{o}{=} \PY{n}{freq}\PY{o}{\PYZgt{}}\PY{o}{=}\PY{l+m+mi}{0}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{freq}\PY{p}{[}\PY{n}{mask}\PY{p}{]}\PY{p}{,} \PY{n}{fourier}\PY{p}{[}\PY{n}{mask}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SciPy PSD}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.plot(freq[\PYZti{}mask], fourier[\PYZti{}mask])  \PYZsh{}  отрицательная часть ввиду симметрии преобразования Фурье}

\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{omega\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}|x( }\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{omega)|\PYZca{}2\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_28_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_28_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Естественно ожидать, что в установившемся режиме вынужденных колебаний
амплитуда постоянна, а частота равна частоте внешнего воздействия. Этому
режиму соответствуют положения равновесия системы:
\(a = a_0, \psi = \psi_0\). Действительно, нетрудно убедиться, что в
этом случае

\begin{equation}
\begin{array}{c}
A(t)=a \exp (i \varphi)=a_{0} \exp \left[i\left(\delta t-\psi_{0}\right)\right] \\
x(t)=\operatorname{Re}\left(A e^{i \omega_{0} t}\right)=a_{0} \cos \left(\Omega t-\psi_{0}\right)
\end{array}
\end{equation}

т.е. колебания происходят точно на частоте воздействия. Для определения
положений равновесия получаем из \(\dot{a} =0, \dot{\psi} = 0\)
следующие уравнения:

\begin{equation}
\begin{array}{c}
\gamma a_{0}=\frac{f}{2 \omega_{0}} \sin \psi_{0} \\
\left(\delta-\frac{3 a_{0}^{2}}{8 \omega_{0}}\right) a_{0}=-\frac{f}{2 \omega_{0}} \cos \psi_{0}
\end{array}
\end{equation}

Удобно исключить отсюда \(\psi_0\). Возводя уравнения в квадрат и
складывая, получаем соотношение, которое неявным образом определяет
амплитуду колебаний как функцию амплитуды и частоты вынуждающей силы

\begin{equation}
\left(\gamma a_{0}\right)^{2}+a_{0}^{2}\left(\delta-\frac{3 \beta a_{0}^{2}}{8 \omega_{0}}\right)^{2}=\frac{f^{2}}{4 \omega_{0}^{2}}.
\end{equation}

Если устремить параметр диссипации \(\gamma\) к нулю, то

\begin{equation}
a_{0}=\frac{f}{\left|2 \omega_{0} \delta-3 \beta a_{0}^{2} / 4\right|}.
\end{equation}

Ввиду близости частот \(\omega_0\) и \(\Omega\) справедливо приближенное
соотношение
\(\Omega^2 - \omega_0^2 = (\Omega - \omega_0) (\Omega + \omega_0) \approx 2 \omega_0 \delta\).

Мы хотели бы детально проанализировать соотношение, описывающее
нелинейный резонанс в присутствии диссипации. Для этого преобразуем его
к более удобной форме, минимизируя количество переменных и параметров.
Для определенности далее будем считать параметр нелинейности \(\beta\)
положительным.

Введем следующие обозначения:
\(P=\left(3 \beta F^{2}\right) /\left(32 \gamma^{3} \omega_{0}^{3}\right)\)
- безразмерный параметр, характеризующий интенсивность внешнего
воздействия,
\(X=\left(3 \beta a_{0}^{2}\right) /\left(8 \gamma \omega_{0}\right)-\)
безразмерный параметр, характеризующий интенсивность вынужденных
колебаний, \(\Delta=\delta / \gamma\) - безразмерная расстройка частоты.
Тогда соотношение

\begin{equation}
\label{X}
X=\frac{P}{(X-\Delta)^{2}+1}
\end{equation}

Придавая различные значения параметру интенсивности воздействия \(P,\)
мы можем построить семейство кривых \(X=X(\Delta),\) представляющих
собой резонансные кривые нелинейного осциллятора в безразмерных
координатах \(X\) и \(\Delta\)

Если внешнее воздействие мало, т.е. \(P \ll 1,\) то амплитуда
вынужденных колебаний тоже мала \((X\) порядка \(P),\) и формула
\eqref{X} приближенно приводится к виду

\begin{equation}
X=\frac{P}{\Delta^{2}+1}
\end{equation}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{18}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{x0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{p0} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{omega0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{gamma} \PY{o}{=} \PY{l+m+mf}{0.5}
\PY{n}{F} \PY{o}{=} \PY{l+m+mf}{0.5}
\PY{n}{Fm} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{OMEGA} \PY{o}{=} \PY{l+m+mf}{1.01}
\PY{n}{beta} \PY{o}{=} \PY{l+m+mf}{0.1}

\PY{n}{delta} \PY{o}{=} \PY{n}{OMEGA} \PY{o}{\PYZhy{}} \PY{n}{omega0}

\PY{n}{xrange} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{yrange} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{Y}\PY{p}{,} \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{meshgrid}\PY{p}{(}\PY{n}{xrange}\PY{p}{,}\PY{n}{yrange}\PY{p}{)}

\PY{c+c1}{\PYZsh{} F is one side of the equation, G is the other}
\PY{n}{P} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mf}{0.4}\PY{p}{,} \PY{l+m+mf}{3.0}\PY{p}{,} \PY{l+m+mf}{0.4}\PY{p}{)}

\PY{n}{fmt} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
\PY{n}{strs} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{P}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{n}{strs}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{P= }\PY{l+s+si}{\PYZpc{}.1f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{P}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}

    
\PY{k}{for} \PY{n}{l}\PY{p}{,} \PY{n}{p}\PY{p}{,} \PY{n}{s} \PY{o+ow}{in} \PY{n+nb}{zip}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{P}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{P}\PY{p}{,} \PY{n}{strs}\PY{p}{)}\PY{p}{:}
    \PY{n}{F} \PY{o}{=} \PY{n}{X}
    \PY{n}{G} \PY{o}{=} \PY{n}{p} \PY{o}{/} \PY{p}{(} \PY{p}{(}\PY{n}{X} \PY{o}{\PYZhy{}} \PY{n}{Y}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+}\PY{l+m+mi}{1} \PY{p}{)}
    \PY{n}{CS} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{Y}\PY{p}{,} \PY{n}{X}\PY{p}{,} \PY{p}{(}\PY{n}{F} \PY{o}{\PYZhy{}} \PY{n}{G}\PY{p}{)}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{fmt}\PY{p}{[}\PY{n}{l}\PY{p}{]} \PY{o}{=} \PY{n}{s}
    \PY{n}{plt}\PY{o}{.}\PY{n}{clabel}\PY{p}{(}\PY{n}{CS}\PY{p}{,} \PY{n}{inline}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{fmt}\PY{o}{=}\PY{n}{fmt}\PY{p}{[}\PY{n}{l}\PY{p}{]}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mf}{8.5}\PY{p}{)}
    
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Delta\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}        
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}X (}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Delta) \PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_30_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Соответствующий график имеет вид колоколообразной кривой, характерной
для линейного резонанса и известной как «лоренцевский контур». С ростом
параметра \(P\) амплитуда растет, поправка \(X\) в знаменателе формулы
\eqref{X} становится существенной, верхняя часть резонансной кривой
постепенно отклоняется вправо, и кривая становится все более
асимметричной. Обратим внимание, что максимумы резонансных кривых
\(X=P\) достигаются при \(X=\Delta,\) т.е. при

\[
\delta=\frac{3 \beta a_{0}^{2}}{8 \omega_{0}}=\Delta \omega\left(a_{0}\right).
\]

Следовательно, при заданной амплитуде внешней силы амплитуда вынужденных
колебаний будет максимальна, когда расстройка в точности равна
нелинейному сдвигу частоты свободных колебаний автономного осциллятора.

В линейном приближении зависимость амплитуды \(b\) вынужденных колебаний
от амплитуды \(f\) и частоты \(\Omega\) внешней силы дается вблизи
резонанса формулой аналогичной разобранной выше:

\[
b^{2}\left(\varepsilon^{2}+\gamma^{2}\right)=F^{2} / 4 \omega_{0}^{2}
\] Нелинейность колебаний приводит к появлению зависимоcтии их
собственной частоты от амплитуды; напишем ее в виде \[
\omega_{0}+ \kappa b^{2},
\] где постоянная \(\kappa\) выражается определенным образом через
корфициент ангармоничности - нелинейный сдвиг частот. Соответственно
этому заменяем в малой разнице \((\Omega - \omega_0) \omega_0\) на
\(\omega_{0}+ \kappa b^{2}\).

Сохранив обозначение \(\varepsilon = \Omega - \omega_0\), получим
уравнение: \[
b^{2}\left[\left(\varepsilon-x b^{2}\right)^{2}+\gamma^{2}\right]=F^{2} / 4 \omega_{0}^{2}
\]

По мере увеличения \(F\) кривая деформируется, сохраняя сначала свой
характер - с одним максимумом, он смещается в сторону положительных
\(\Delta\).

При \(F > F_k\) характер кривой меняется, при каждом значении
\(F > F_k\) существует определенная область частот, в которой 3 корня.
Границы этой области определяются следующим выражением:

\begin{equation}
\frac{d b}{d \varepsilon}=\dfrac{-\varepsilon b+ \kappa b^{3}}{\varepsilon^{2}+\gamma ^{2}-4 \kappa \varepsilon b^{2}+3 \kappa^{2} b^{4}}
\end{equation}

При достаточно больших амплитудах зависимость амплитуды колебаний от
расстройки становится неоднозначной. В рассматриваемом случае, когда
параметр нелинейности \(\beta\) положителен, область неоднозначности
располагается при частотах воздействия несколько больших частоты
линейного резонанса.

\hypertarget{ux431ux438ux444ux443ux440ux43aux430ux446ux438ux438-ux43fux440ux438-ux43dux435ux43bux438ux43dux435ux439ux43dux43eux43c-ux440ux435ux437ux43eux43dux430ux43dux441ux435}{%
\subsubsection{3.1.1. Бифуркации при нелинейном
резонансе}\label{ux431ux438ux444ux443ux440ux43aux430ux446ux438ux438-ux43fux440ux438-ux43dux435ux43bux438ux43dux435ux439ux43dux43eux43c-ux440ux435ux437ux43eux43dux430ux43dux441ux435}}

Прежде всего исследуем резонансную кривую на устойчивость. Зададим малые
отклонения от состояний равновесия, полагая
\(a(t)=a_{0}+\xi(t), \psi(t)=\psi_{0}+\eta(t),\) и ли- неаризуем
уравнения (14.17). Получим \[
\begin{array}{c}
\dot{\xi}+\gamma \xi=\frac{f \eta}{2 \omega_{0}} \cos \psi_{0} \\
a_{0} \dot{\eta}=\delta \xi-\frac{9 \beta a_{0}^{2} \xi}{8 \omega_{0}}-\frac{f \eta}{2 \omega_{0}} \sin \psi_{0}
\end{array}
\] Исключим отсюда \(\psi_{0}\) при помощи соотношений:

\[
\begin{array}{l}
\dot{\xi}+\gamma \xi=-\left(\delta a_{0}-\frac{3 \beta a_{0}^{3}}{8 \omega_{0}}\right) \eta \\
a_{0} \dot{\eta}=\left(\delta-\frac{9 \beta a_{0}^{2}}{8 \omega_{0}}\right) \xi-\gamma a_{0} \eta
\end{array}
\] Полагая, что решения имеют вид \(\xi, \eta \sim \exp (r t),\)
приходим к характеристическому уравнению, которое после несложных
преобразований можно записать в виде \[
(r+\gamma)^{2}=-(\delta-\Delta \omega)(\delta-3 \Delta \omega)
\] где
\(\Delta \omega\left(a_{0}\right)=3 \beta a_{0}^{2} / 8 \omega_{0}-\)
нелинейный сдвиг частоты собственных колебаний осциллятора. Корни
уравнения есть \[
r_{\pm}=-\gamma \pm \sqrt{-(\delta-\Delta \omega)(\delta-3 \Delta \omega)}
\] Нетрудно видеть, что при \(\delta<\Delta \omega\) и при
\(\delta>3 \Delta \omega\) корни \(r_{\pm}\) комплексны, и состояние
равновесия представляет собой устойчивый фокус. При
\(\Delta \omega<\delta<3 \Delta \omega\) корни вещественны. Поскольку
корень \(r_{-},\) очевидно, всегда отрицателен, состояние равновесия
может быть либо устойчивым узлом, либо седлом. Смена характера
устойчивости происходит при \(r_{+}=0,\) т.е. при \[
(\delta-\Delta \omega)(\delta-3 \Delta \omega)=-\gamma^{2}
\] Переходя к безразмерным переменным, введенным в предыдущем разделе,
можно переписать это уравнение в виде \[
(\Delta-X)(\Delta-3 X)=-1
\] В то же время, если продифференцировать уравнение резонансной кривой
по \(X\), получим следующее соотношение

\[
(\Delta-X)^{2}+2 X(\Delta-X)\left(\frac{\partial \Delta}{\partial X}-1\right)+1=0
\] В области неоднозначности резонансная кривая имеет три ветви, границы
между которыми определяются из условия
\(\partial \Delta / \partial X=0 .\) Следовательно, вся промежуточная
ветвь резонансной кривой отвечает неустойчивым состояниям равновесия, а
верхняя и нижняя - устойчивым.

    \hypertarget{ux441ux43bux43eux436ux43dux430ux44f-ux434ux438ux43dux430ux43cux438ux43aux430-ux438-ux445ux430ux43eux441-ux43fux440ux438-ux432ux44bux43dux443ux436ux434ux435ux43dux43dux44bux445-ux43aux43eux43bux435ux431ux430ux43dux438ux44fux445-ux43dux435ux43bux438ux43dux435ux439ux43dux43eux433ux43e-ux43eux441ux446ux438ux43bux43bux44fux442ux43eux440ux430}{%
\subsection{3.2. Сложная динамика и хаос при вынужденных колебаниях
нелинейного
осциллятора}\label{ux441ux43bux43eux436ux43dux430ux44f-ux434ux438ux43dux430ux43cux438ux43aux430-ux438-ux445ux430ux43eux441-ux43fux440ux438-ux432ux44bux43dux443ux436ux434ux435ux43dux43dux44bux445-ux43aux43eux43bux435ux431ux430ux43dux438ux44fux445-ux43dux435ux43bux438ux43dux435ux439ux43dux43eux433ux43e-ux43eux441ux446ux438ux43bux43bux44fux442ux43eux440ux430}}

Ключевую роль играет представление о нелинейном резонансе, на основании
которого формулируется простое условие возникновения хаоса --
\emph{критерий перекрытия резонансов} Б.В. Чирикова.

\hypertarget{ux440ux435ux437ux43eux43dux430ux43dux441-ux43dux430-ux433ux430ux440ux43cux43eux43dux438ux43aux430ux445-ux438-ux441ux443ux431ux433ux430ux440ux43cux43eux43dux438ux43aux430ux445}{%
\subsubsection{3.2.1. Резонанс на гармониках и
субгармониках}\label{ux440ux435ux437ux43eux43dux430ux43dux441-ux43dux430-ux433ux430ux440ux43cux43eux43dux438ux43aux430ux445-ux438-ux441ux443ux431ux433ux430ux440ux43cux43eux43dux438ux43aux430ux445}}

Рассмотрим консервативный осциллятор при воздействии внешней силы,
зависящей от времени с периодом \(T=2 \pi / \Omega .\) Представим ее в
виде ряда Фурье, причем коэффициенты разложения будем считать зависящими
от текущего значения обобщенной координаты \(x:\) \begin{equation}
\label{reson}
\ddot{x}+\omega_{0}^{2} x=F(x, t)=\sum_{m=-\infty}^{\infty} f_{m}(x) e^{i m \Omega t}, f_{m}(x)=\frac{\Omega}{2 \pi} \int_{0}^{2 \pi / \Omega} F(x, t) e^{-i m \Omega t} d t.
\end{equation}

Это очень общая форма уравнения. Нелинейные осцилляторы, как с силовым,
так и с параметрическим внешним воздействием, представляют собой его
определенные частные случаи.

В нулевом приближении, пренебрегая совсем правой частью уравнения
\eqref{reson}, находим решение в виде \(x^{(0)}=A \cos \omega_{0} t,\)
где \(A-\) константа, определяющая амплитуду колебаний. Намереваясь
получить следующее приближение, мы должны подставить Это выражение в
правую часть. При этом каждый коэффициент \(f_{m}(x)\) становится
периодической функцией времени и может быть, в свою очередь, представлен
в виде ряда Фуpьe: \[
f_{m}\left(A \cos \omega_{0} t\right)=\sum_{m=-\infty}^{\infty} f_{m n} e^{i n \omega_{0} t}, f_{m n}=\frac{\omega_{0}}{2 \pi} \int_{0}^{2 \pi / \omega_{0}} f_{m}\left(A \cos \omega_{0} t\right) e^{-i n \omega_{0} t} d t.
\] Поэтому для первого приближения получаем \[
\ddot{x}^{(1)}+\omega_{0}^{2} x^{(1)}=\sum_{m=-\infty}^{\infty} \sum_{n=-\infty}^{\infty} f_{m n} e^{i\left(m \Omega+n \omega_{0}\right) t}.
\] Если какой-либо из членов в правой части отвечает колебаниям точно на
собственной частоте осциллятора \(\omega_{0},\) то возникает резонанс: в
решении \(x^{(1)}\) появится колебательная составляющая, амплитуда
которой будет нарастать во времени по линейному закону - секулярный, или
вековой член (термин из небесной механики).

Резонанс и появление секулярных членов будет иметь место не только при
совпадении частоты внешнего воздействия с собственной частотой, но и при
выполнении соотношения между частотами вида
\(m \Omega+n \omega_{0}=\pm \omega_{0},\) или, что то же самое, \[
m \Omega+k \omega_{0}=0,
\] где \(m\) и \(k=n \mp 1-\) целые числа. В этом случае говорят о
резонансе на гармониках и субгармониках основной частоты \Omega. Обычно
коэффициенты Фурье \(f_{m n}\) достаточно быстро убывают с ростом
индексов, так что существенными оказываются только «главные резонансы»,
характеризуемые относительно небольшими \(m\) и \(n .\)

Чтобы избежать секулярного роста возмущений, метод последовательных
приближений модифицируют, принимая во внимание зависимость частоты
собственных колебаний от амплитуды \(\omega=\omega(A).\)

Предположим, что имеет место отстройка по частоте от резонанса
\(\Delta \omega .\) Тогда амплитуда резонансного возмущения будет равна
по порядку величины, очевидно,

\(\Delta A \cong f_{m n} /[\omega(A) \Delta \omega],\) откуда
\(\Delta \omega \cong f_{m n} /[\omega(A) \Delta A] .\) С другой
стороны, изменение частоты в силу неизохронности осциллятора при
изменении амплитуды на величину \(\Delta A\) составит
\(\Delta \omega \cong|d \omega(A) / d A| \Delta A .\) Потребуем, чтобы
оба частотных сдвига были одного порядка. Отсюда получаем величину, о
которой будем говорить как о ширине нелинейного резонанса по амплитуде
\[
\Delta A \cong \sqrt{\left| \frac{f_{m n}}{\omega(A) \cdot d \omega(A) / d A} \right|}
\] и, соответственно, ширину нелинейного резонанса по частоте \[
\Delta \omega \cong|d \omega(A) / d A| \Delta A \cong \sqrt{\left|f_{m n}[\omega(A)]^{-1} d \omega(A) / d A\right|}.
\]

    \hypertarget{ux444ux430ux437ux43eux432ux43eux435-ux43fux440ux43eux441ux442ux440ux430ux43dux441ux442ux432ux43e}{%
\subsection{3.3. Фазовое
пространство}\label{ux444ux430ux437ux43eux432ux43eux435-ux43fux440ux43eux441ux442ux440ux430ux43dux441ux442ux432ux43e}}

Вернемся к уравнению (1), положив в нем
\(\gamma =0.15, \omega_0^2 = -1, \beta = 1, \Omega = 1.2, F = 0.2\).
Получим:

\[\ddot{x} - x + 0.3 \dot{x} + x^3 =0.2 \cos(1.2 t)\]

Численно решим это уравнение и построим фазовый портрет:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{19}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{diff\PYZus{}eq1}\PY{p}{(}\PY{n}{z}\PY{p}{,} \PY{n}{t}\PY{p}{)}\PY{p}{:}
    \PY{n}{q}\PY{p}{,} \PY{n}{p} \PY{o}{=} \PY{n}{z}
    \PY{k}{return} \PY{p}{[}\PY{n}{p}\PY{p}{,} \PY{n}{F}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{o}{/}\PY{n}{T} \PY{o}{*} \PY{n}{t}\PY{p}{)} \PY{o}{+} \PY{n}{Fm}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{l+m+mi}{3}\PY{o}{*}\PY{n}{OMEGA} \PY{o}{*} \PY{n}{t}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{gamma}\PY{o}{*}\PY{n}{p} \PY{o}{\PYZhy{}} \PY{n}{k}\PY{o}{*}\PY{p}{(}\PY{n}{omega0}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{*} \PY{n}{q} \PY{o}{\PYZhy{}} \PY{n}{beta} \PY{o}{*} \PY{n}{q}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{3}\PY{p}{]}

\PY{k}{def} \PY{n+nf}{poincare}\PY{p}{(}\PY{n}{z0}\PY{p}{,} \PY{n}{N}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{,} \PY{n}{steps}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{)}\PY{p}{:}

    \PY{n}{n\PYZus{}steps} \PY{o}{=} \PY{n}{N}       \PY{c+c1}{\PYZsh{}  number of periods}


    \PY{n}{X} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{n\PYZus{}steps} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{complex}\PY{p}{)} 
    \PY{n}{P} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{n\PYZus{}steps} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{complex}\PY{p}{)}    
    
    \PY{n}{q0}\PY{p}{,} \PY{n}{p0} \PY{o}{=} \PY{n}{z0}
    
    \PY{n}{P}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{n}{p0}
    \PY{n}{X}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{n}{q0}
    

    \PY{c+c1}{\PYZsh{}  solution for Poincare map}

    \PY{c+c1}{\PYZsh{}  mapping for (p, q, u, v)}
    \PY{k}{for} \PY{n}{n} \PY{o+ow}{in} \PY{n}{notebook}\PY{o}{.}\PY{n}{tqdm}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{n\PYZus{}steps} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{:}

        \PY{n}{tn} \PY{o}{=} \PY{n}{T} \PY{o}{*} \PY{p}{(}\PY{n}{n} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{)}

        \PY{n}{p0} \PY{o}{=} \PY{n}{P}\PY{p}{[}\PY{n}{n} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{x0} \PY{o}{=} \PY{n}{X}\PY{p}{[}\PY{n}{n} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{]}

        \PY{n}{z0} \PY{o}{=} \PY{p}{[}\PY{n}{x0}\PY{p}{,} \PY{n}{p0}\PY{p}{]}

        \PY{n}{sol} \PY{o}{=} \PY{n}{odeintw}\PY{p}{(}\PY{n}{diff\PYZus{}eq1}\PY{p}{,} \PY{n}{z0}\PY{p}{,} \PY{p}{[}\PY{n}{tn}\PY{p}{,} \PY{n}{tn} \PY{o}{+} \PY{n}{T}\PY{p}{]}\PY{p}{,} \PY{n}{atol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}12}\PY{p}{,} \PY{n}{rtol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}12}\PY{p}{,} \PY{n}{mxstep}\PY{o}{=}\PY{n}{steps}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}print(sol)}
        \PY{n}{X}\PY{p}{[}\PY{n}{n}\PY{p}{]} \PY{o}{=} \PY{n}{sol}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}
        \PY{n}{P}\PY{p}{[}\PY{n}{n}\PY{p}{]} \PY{o}{=} \PY{n}{sol}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}
    \PY{k}{return} \PY{n}{X}\PY{p}{,} \PY{n}{P}


\PY{n}{x0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{p0} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{omega0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{gamma} \PY{o}{=} \PY{l+m+mf}{0.15}
\PY{n}{F} \PY{o}{=} \PY{l+m+mf}{0.2}
\PY{n}{Fm} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{OMEGA} \PY{o}{=} \PY{l+m+mf}{1.2}
\PY{n}{T} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi} \PY{o}{/} \PY{n}{OMEGA}
\PY{n}{beta} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{k} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}

\PY{n}{tmax} \PY{o}{=} \PY{l+m+mi}{500}
\PY{n}{dt} \PY{o}{=} \PY{l+m+mf}{1e\PYZhy{}1}
\PY{n}{t} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{tmax}\PY{p}{,} \PY{n}{dt}\PY{p}{)}


\PY{n}{z0} \PY{o}{=} \PY{p}{[}\PY{n}{x0}\PY{p}{,} \PY{n}{p0}\PY{p}{]}
\PY{n}{sol} \PY{o}{=} \PY{n}{odeintw}\PY{p}{(}\PY{n}{diff\PYZus{}eq1}\PY{p}{,} \PY{n}{z0}\PY{p}{,} \PY{n}{t}\PY{p}{,} \PY{n}{atol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{rtol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{mxstep}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{num\PYZus{}p} \PY{o}{=} \PY{n}{sol}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{sol}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ODEint}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.legend(bbox\PYZus{}to\PYZus{}anchor=(1.05, 1), loc=\PYZsq{}upper left\PYZsq{})}
\PY{c+c1}{\PYZsh{}plt.legend()}
\PY{c+c1}{\PYZsh{}plt.xlim([10, 20])}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}x(t)\PYZdl{} for \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{gamma\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{gamma}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{omega\PYZus{}0\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{omega}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{F}\PY{p}{)} \PY{o}{+}
         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F\PYZus{}m=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{Fm}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Omega=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{OMEGA}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}t\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}x(t)\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{num\PYZus{}p}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{phase trajectories}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}x\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}p\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Phase Portrait}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_34_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_34_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Фазовое пространство выглядит достаточно сложным, однако оно также
включает в себя и процесс затухания собственных колебаний. Как видно они
затухают на временах \textasciitilde30. Построим фазовый портрет на
промежутке веремени от 60 до 120, например:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{20}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{tleft} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{l+m+mi}{60}\PY{o}{/}\PY{n}{dt}\PY{p}{)}
\PY{n}{tright} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{l+m+mi}{120}\PY{o}{/}\PY{n}{dt}\PY{p}{)}

\PY{n}{sol1} \PY{o}{=} \PY{n}{poincare}\PY{p}{(}\PY{n}{z0}\PY{p}{)}
\PY{n}{xT}\PY{p}{,} \PY{n}{pT} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{real}\PY{p}{(}\PY{n}{sol1}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{num\PYZus{}q}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{,} \PY{n}{num\PYZus{}p}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{phase trajectories}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{xT}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{,} \PY{n}{pT}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Poincare map}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}x\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}p\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Phase Portrait}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{,}\PY{n}{num\PYZus{}q}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}x(t)\PYZdl{} for \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{gamma\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{gamma}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{omega\PYZus{}0\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{omega}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{F}\PY{p}{)} \PY{o}{+}
         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F\PYZus{}m=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{Fm}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Omega=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{OMEGA}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}t\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}x(t)\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    
    \begin{Verbatim}[commandchars=\\\{\}]
HBox(children=(HTML(value=''), FloatProgress(value=0.0, max=1000.0), HTML(value='')))
    \end{Verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_36_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_36_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Фазовая траектория стала заметно проще и представляет собой предельный
цикл. Не представляет труда проверить, что период равен
\(\frac{2 \pi }{\Omega }\)

\hypertarget{ux443ux434ux432ux43eux435ux43dux438ux435-ux43fux435ux440ux438ux43eux434ux430}{%
\subsubsection{3.3.1 Удвоение
периода}\label{ux443ux434ux432ux43eux435ux43dux438ux435-ux43fux435ux440ux438ux43eux434ux430}}

Исследуем поведение системы в зависимости от амплитуды вынужденных
колебаний. Все графики будут приведены для времен, когда собственные
колебания практически затухли.

Увеличим амплитуду вынужденных колебаний с \(f\) = 0.15 до \(f\) =0.23.
Получим:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{21}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{x0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{p0} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{omega0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{gamma} \PY{o}{=} \PY{l+m+mf}{0.15}
\PY{n}{F} \PY{o}{=} \PY{l+m+mf}{0.28}
\PY{n}{Fm} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{OMEGA} \PY{o}{=} \PY{l+m+mf}{1.2}
\PY{n}{T} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi} \PY{o}{/} \PY{n}{OMEGA}
\PY{n}{beta} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{k} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}

\PY{n}{tmax} \PY{o}{=} \PY{l+m+mi}{500}
\PY{n}{dt} \PY{o}{=} \PY{l+m+mf}{1e\PYZhy{}1}
\PY{n}{t} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{tmax}\PY{p}{,} \PY{n}{dt}\PY{p}{)}


\PY{n}{z0} \PY{o}{=} \PY{p}{[}\PY{n}{x0}\PY{p}{,} \PY{n}{p0}\PY{p}{]}
\PY{n}{sol} \PY{o}{=} \PY{n}{odeintw}\PY{p}{(}\PY{n}{diff\PYZus{}eq1}\PY{p}{,} \PY{n}{z0}\PY{p}{,} \PY{n}{t}\PY{p}{,} \PY{n}{atol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{rtol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{mxstep}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{num\PYZus{}p} \PY{o}{=} \PY{n}{sol}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{sol}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}

\PY{n}{sol1} \PY{o}{=} \PY{n}{poincare}\PY{p}{(}\PY{n}{z0}\PY{p}{)}
\PY{n}{xT}\PY{p}{,} \PY{n}{pT} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{real}\PY{p}{(}\PY{n}{sol1}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{xT}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{,} \PY{n}{pT}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Poincare map}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{num\PYZus{}q}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{,} \PY{n}{num\PYZus{}p}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{phase trajectories}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}x\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}p\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Phase Portrait}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{,}\PY{n}{num\PYZus{}q}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}x(t)\PYZdl{} for \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{gamma\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{gamma}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{omega\PYZus{}0\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{omega}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{F}\PY{p}{)} \PY{o}{+}
         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F\PYZus{}m=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{Fm}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Omega=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{OMEGA}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}t\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}x(t)\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    
    \begin{Verbatim}[commandchars=\\\{\}]
HBox(children=(HTML(value=''), FloatProgress(value=0.0, max=1000.0), HTML(value='')))
    \end{Verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_38_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_38_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    И на фазовом пространстве и на графике решения хорошо видно, что
произошло удвоение периода. Теперь он равен \(4 \pi / \Omega\). Еще раз
увеличим амплитуду вынужденных колебаний. Получим:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{22}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{x0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{p0} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{omega0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{gamma} \PY{o}{=} \PY{l+m+mf}{0.15}
\PY{n}{F} \PY{o}{=} \PY{l+m+mf}{0.29}
\PY{n}{Fm} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{OMEGA} \PY{o}{=} \PY{l+m+mf}{1.2}
\PY{n}{T} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi} \PY{o}{/} \PY{n}{OMEGA}
\PY{n}{beta} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{k} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}

\PY{n}{tmax} \PY{o}{=} \PY{l+m+mi}{500}
\PY{n}{dt} \PY{o}{=} \PY{l+m+mf}{1e\PYZhy{}1}
\PY{n}{t} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{tmax}\PY{p}{,} \PY{n}{dt}\PY{p}{)}


\PY{n}{z0} \PY{o}{=} \PY{p}{[}\PY{n}{x0}\PY{p}{,} \PY{n}{p0}\PY{p}{]}
\PY{n}{sol} \PY{o}{=} \PY{n}{odeintw}\PY{p}{(}\PY{n}{diff\PYZus{}eq1}\PY{p}{,} \PY{n}{z0}\PY{p}{,} \PY{n}{t}\PY{p}{,} \PY{n}{atol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{rtol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{mxstep}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{num\PYZus{}p} \PY{o}{=} \PY{n}{sol}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{sol}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}

\PY{n}{sol1} \PY{o}{=} \PY{n}{poincare}\PY{p}{(}\PY{n}{z0}\PY{p}{)}
\PY{n}{xT}\PY{p}{,} \PY{n}{pT} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{real}\PY{p}{(}\PY{n}{sol1}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{xT}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{,} \PY{n}{pT}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Poincare map}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{num\PYZus{}q}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{,} \PY{n}{num\PYZus{}p}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{phase trajectories}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}x\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}p\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Phase Portrait}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{,}\PY{n}{num\PYZus{}q}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}x(t)\PYZdl{} for \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{gamma\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{gamma}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{omega\PYZus{}0\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{omega}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{F}\PY{p}{)} \PY{o}{+}
         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F\PYZus{}m=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{Fm}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Omega=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{OMEGA}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}t\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}x(t)\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    
    \begin{Verbatim}[commandchars=\\\{\}]
HBox(children=(HTML(value=''), FloatProgress(value=0.0, max=1000.0), HTML(value='')))
    \end{Verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_40_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_40_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    И на фазовом пространстве и на графике решения хорошо видно, что
произошло удвоение периода. Теперь он равен \(8 \pi / \Omega\). Еще раз
увеличим амплитуду вынужденных колебаний. Получим:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{23}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}  F = 0.37}
\PY{n}{x0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{p0} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{omega0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{gamma} \PY{o}{=} \PY{l+m+mf}{0.15}
\PY{n}{F} \PY{o}{=} \PY{l+m+mf}{0.37}
\PY{n}{Fm} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{OMEGA} \PY{o}{=} \PY{l+m+mf}{1.2}
\PY{n}{T} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi} \PY{o}{/} \PY{n}{OMEGA}
\PY{n}{beta} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{k} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}

\PY{n}{tmax} \PY{o}{=} \PY{l+m+mi}{500}
\PY{n}{dt} \PY{o}{=} \PY{l+m+mf}{1e\PYZhy{}1}
\PY{n}{t} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{tmax}\PY{p}{,} \PY{n}{dt}\PY{p}{)}


\PY{n}{z0} \PY{o}{=} \PY{p}{[}\PY{n}{x0}\PY{p}{,} \PY{n}{p0}\PY{p}{]}
\PY{n}{sol} \PY{o}{=} \PY{n}{odeintw}\PY{p}{(}\PY{n}{diff\PYZus{}eq1}\PY{p}{,} \PY{n}{z0}\PY{p}{,} \PY{n}{t}\PY{p}{,} \PY{n}{atol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{rtol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{mxstep}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{num\PYZus{}p} \PY{o}{=} \PY{n}{sol}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{sol}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}

\PY{n}{sol1} \PY{o}{=} \PY{n}{poincare}\PY{p}{(}\PY{n}{z0}\PY{p}{)}
\PY{n}{xT}\PY{p}{,} \PY{n}{pT} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{real}\PY{p}{(}\PY{n}{sol1}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{xT}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{,} \PY{n}{pT}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Poincare map}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{num\PYZus{}q}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{,} \PY{n}{num\PYZus{}p}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{phase trajectories}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}x\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}p\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Phase Portrait, F = }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{F}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{,}\PY{n}{num\PYZus{}q}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}x(t)\PYZdl{} for \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{gamma\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{gamma}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{omega\PYZus{}0\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{omega}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{F}\PY{p}{)} \PY{o}{+}
         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F\PYZus{}m=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{Fm}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Omega=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{OMEGA}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}t\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}x(t)\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}


\PY{c+c1}{\PYZsh{}  F = 0.5}
\PY{n}{F} \PY{o}{=} \PY{l+m+mf}{0.5}
\PY{n}{tmax} \PY{o}{=} \PY{l+m+mi}{2000}
\PY{n}{dt} \PY{o}{=} \PY{l+m+mf}{1e\PYZhy{}1}
\PY{n}{t} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{tmax}\PY{p}{,} \PY{n}{dt}\PY{p}{)}
\PY{n}{z0} \PY{o}{=} \PY{p}{[}\PY{n}{x0}\PY{p}{,} \PY{n}{p0}\PY{p}{]}
\PY{n}{sol} \PY{o}{=} \PY{n}{odeintw}\PY{p}{(}\PY{n}{diff\PYZus{}eq1}\PY{p}{,} \PY{n}{z0}\PY{p}{,} \PY{n}{t}\PY{p}{,} \PY{n}{atol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{rtol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{mxstep}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{num\PYZus{}p} \PY{o}{=} \PY{n}{sol}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{sol}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}

\PY{n}{sol1} \PY{o}{=} \PY{n}{poincare}\PY{p}{(}\PY{n}{z0}\PY{p}{)}
\PY{n}{xT}\PY{p}{,} \PY{n}{pT} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{real}\PY{p}{(}\PY{n}{sol1}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{xT}\PY{p}{,} \PY{n}{pT}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Poincare map}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{num\PYZus{}p}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{phase trajectories}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}x\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}p\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Phase Portrait, F = }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{F}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{n}{num\PYZus{}q}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}x(t)\PYZdl{} for \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{gamma\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{gamma}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{omega\PYZus{}0\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{omega}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{F}\PY{p}{)} \PY{o}{+}
         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F\PYZus{}m=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{Fm}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Omega=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{OMEGA}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}t\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}x(t)\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}


\PY{c+c1}{\PYZsh{}  F = 0.65}
\PY{n}{F} \PY{o}{=} \PY{l+m+mf}{0.65}
\PY{n}{tmax} \PY{o}{=} \PY{l+m+mi}{500}
\PY{n}{dt} \PY{o}{=} \PY{l+m+mf}{1e\PYZhy{}1}
\PY{n}{t} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{tmax}\PY{p}{,} \PY{n}{dt}\PY{p}{)}
\PY{n}{z0} \PY{o}{=} \PY{p}{[}\PY{n}{x0}\PY{p}{,} \PY{n}{p0}\PY{p}{]}
\PY{n}{sol} \PY{o}{=} \PY{n}{odeintw}\PY{p}{(}\PY{n}{diff\PYZus{}eq1}\PY{p}{,} \PY{n}{z0}\PY{p}{,} \PY{n}{t}\PY{p}{,} \PY{n}{atol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{rtol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{mxstep}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{num\PYZus{}p} \PY{o}{=} \PY{n}{sol}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{sol}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}

\PY{n}{sol1} \PY{o}{=} \PY{n}{poincare}\PY{p}{(}\PY{n}{z0}\PY{p}{)}
\PY{n}{xT}\PY{p}{,} \PY{n}{pT} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{real}\PY{p}{(}\PY{n}{sol1}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{xT}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{,} \PY{n}{pT}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Poincare map}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{num\PYZus{}q}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{,} \PY{n}{num\PYZus{}p}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{phase trajectories}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}x\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}p\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Phase Portrait, F = }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{F}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{,}\PY{n}{num\PYZus{}q}\PY{p}{[}\PY{n}{tleft}\PY{p}{:}\PY{n}{tright}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}x(t)\PYZdl{} for \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{gamma\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{gamma}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{omega\PYZus{}0\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{omega}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{F}\PY{p}{)} \PY{o}{+}
         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F\PYZus{}m=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{Fm}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Omega=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{OMEGA}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}t\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}x(t)\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    
    \begin{Verbatim}[commandchars=\\\{\}]
HBox(children=(HTML(value=''), FloatProgress(value=0.0, max=1000.0), HTML(value='')))
    \end{Verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_42_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_42_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    
    \begin{Verbatim}[commandchars=\\\{\}]
HBox(children=(HTML(value=''), FloatProgress(value=0.0, max=1000.0), HTML(value='')))
    \end{Verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_42_6.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_42_7.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    
    \begin{Verbatim}[commandchars=\\\{\}]
HBox(children=(HTML(value=''), FloatProgress(value=0.0, max=1000.0), HTML(value='')))
    \end{Verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_42_10.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_42_11.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{ux441ux435ux447ux435ux43dux438ux435-ux43fux443ux430ux43dux43aux430ux440ux435}{%
\subsection{3.4 Сечение
Пуанкаре}\label{ux441ux435ux447ux435ux43dux438ux435-ux43fux443ux430ux43dux43aux430ux440ux435}}

При дальнейшем увеличении амплитуды вынуждающей силы такой способ
изучения не слишком практичен. Удобно строить сечение Пуанкаре, которое
представляет собой отображение положения системы в моменты времени
\(t_0, t_0+T, t_0 + 2T...\) Понятно, что при удвоении периода вместо
одной точки на фазовой диаграмме появятся две и т.д.

Сечение Пуанкаре для случая \(F = 0.5\) выглядит следующим образом:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{24}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}  F = 0.5}
\PY{n}{x0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{p0} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{omega0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{gamma} \PY{o}{=} \PY{l+m+mf}{0.15}
\PY{n}{F} \PY{o}{=} \PY{l+m+mf}{0.5}
\PY{n}{Fm} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{OMEGA} \PY{o}{=} \PY{l+m+mf}{1.2}
\PY{n}{T} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi} \PY{o}{/} \PY{n}{OMEGA}
\PY{n}{beta} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{k} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}

\PY{n}{tmax} \PY{o}{=} \PY{l+m+mi}{2000}
\PY{n}{dt} \PY{o}{=} \PY{l+m+mf}{1e\PYZhy{}3}
\PY{n}{t} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{tmax}\PY{p}{,} \PY{n}{dt}\PY{p}{)}
\PY{n}{z0} \PY{o}{=} \PY{p}{[}\PY{n}{x0}\PY{p}{,} \PY{n}{p0}\PY{p}{]}
\PY{n}{sol} \PY{o}{=} \PY{n}{odeintw}\PY{p}{(}\PY{n}{diff\PYZus{}eq1}\PY{p}{,} \PY{n}{z0}\PY{p}{,} \PY{n}{t}\PY{p}{,} \PY{n}{atol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{rtol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{mxstep}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{num\PYZus{}p} \PY{o}{=} \PY{n}{sol}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{sol}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}

\PY{n}{N} \PY{o}{=} \PY{l+m+mi}{4000}
\PY{n}{sol1} \PY{o}{=} \PY{n}{poincare}\PY{p}{(}\PY{n}{z0}\PY{p}{,} \PY{n}{N}\PY{p}{)}
\PY{n}{xT}\PY{p}{,} \PY{n}{pT} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{real}\PY{p}{(}\PY{n}{sol1}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{xT}\PY{p}{,} \PY{n}{pT}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Poincare map}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.plot(num\PYZus{}q, num\PYZus{}p, label=\PYZsq{}phase trajectories\PYZsq{}, lw=0.5)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}x\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}p\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Poincare map, F = }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{F}\PY{p}{)}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.legend(bbox\PYZus{}to\PYZus{}anchor=(1.05, 1), loc=\PYZsq{}upper left\PYZsq{})}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{num\PYZus{}p}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{phase trajectories}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mf}{0.1}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}x\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}p\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Phase Trajectories, F = }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{F}\PY{p}{)}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.legend(bbox\PYZus{}to\PYZus{}anchor=(1.05, 1), loc=\PYZsq{}upper left\PYZsq{})}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    
    \begin{Verbatim}[commandchars=\\\{\}]
HBox(children=(HTML(value=''), FloatProgress(value=0.0, max=4000.0), HTML(value='')))
    \end{Verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_44_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_44_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    При хаотическом движеним каждый период создает точку в произвольном
месте на плоскости \((x,p)\), и «сумма» отдельных ``снимков'' может
создавать странные узоры из точек со сложными границами в плоскости
\((x,p)\). Эти геометрические формы называют странными аттракторами и
характеризуются дробными размерностями.

    \hypertarget{ux434ux438ux430ux433ux43dux43eux441ux442ux438ux43aux430-ux445ux430ux43eux441ux430}{%
\section{4. Диагностика
хаоса}\label{ux434ux438ux430ux433ux43dux43eux441ux442ux438ux43aux430-ux445ux430ux43eux441ux430}}

\hypertarget{ux441ux43fux435ux43aux442ux440-ux43cux43eux449ux43dux43eux441ux442ux438.-ux43aux440ux438ux442ux435ux440ux438ux439-ux43fux435ux440ux435ux43aux440ux44bux442ux438ux44f-ux440ux435ux437ux43eux43dux430ux43dux441ux43eux432-ux447ux438ux440ux438ux43aux43eux432ux430}{%
\subsection{4.1. Спектр мощности. Критерий перекрытия резонансов
Чирикова}\label{ux441ux43fux435ux43aux442ux440-ux43cux43eux449ux43dux43eux441ux442ux438.-ux43aux440ux438ux442ux435ux440ux438ux439-ux43fux435ux440ux435ux43aux440ux44bux442ux438ux44f-ux440ux435ux437ux43eux43dux430ux43dux441ux43eux432-ux447ux438ux440ux438ux43aux43eux432ux430}}

При малой амплитуде внешней силы ширина резонансов по частоте мала по
сравнению с расстоянием между ними, и их можно рассматривать независимо.
Однако при достаточно большой амплитуде ширина резонансов становится
сравнимой с расстоянием между ними, и говорят о перекрытии резонансов. В
этом случае характер динамики изменяется. Качественно ее можно
представить себе как блуждание между различными резонансами, так что
изображающая точка получает возможность посещать достаточно обширную
область фазового пространства, и колебания становятся хаотическими.
Утверждение, что перекрытие резонансов отвечает возникновению хаоса,
составляет содержание \emph{критерия Чирикова.}

Ограничимся для простоты учетом резонансов только на гармониках частоты
воздействия: \(m \Omega=\omega(A) .\) Каждой \(m\) -ой гармонике будет
соответствовать некоторый интервал по амплитуде, где имеет место
резонанс: его центр располагается вблизи значения \(A_{m},\) получаемого
как корень уравнения \(\quad m \Omega=\omega\left(A_{m}\right) .\)
Расстояние по частоте между соседними резонансами равно, очевидно,
\(\Omega,\) а ширина резонанса дается формулой
\(\Delta \omega \cong \sqrt{\left|f_{m 0} \omega^{\prime}(A) / \omega(A)\right|}\).
Введем параметр, определяющий отношение двух указанных величин \[
K=\frac{\Delta \omega}{\Omega}=\Omega^{-1} \sqrt{\frac{f_{m 0} \omega^{\prime}\left(A_{m}\right)}{\omega\left(A_{m}\right)}} \mid
\] При \(K<<1\) резонансы изолированы друг от друга, и динамика
регулярная. При \(K \approx 1\) воЗ- никает перекрытие резонансов, и
колебания могут стать хаотическими. При \(K>>1\) будет наблюдаться
развитый хаос.

Если рассмотреть задачу о вынужденных колебаниях маятника или другого
осциллятора, имеющего наряду с устойчивыми также неустойчивые состояния
равновесия (седла), то наиболее благоприятными для возникновения хаоса
оказываются области в окрестности сепаратрис. В самом деле, вблизи
сепаратрисы период колебаний стремится к бесконечности, т.е. зависимость
периода и частоты колебаний от частоты очень сильная, а в формуле
величина \(\left|\omega^{\prime}(A)\right|,\) как можно видеть,
фигурирует в числителе. Поэтому даже при небольшой амплитуде
воздействия, когда в остальных областях фазового пространства движение
еще вполне регулярное, вблизи сепаратрисы образуется область хаоса, так
называемых стохастический слой.

С ростом амплитуды воздействия ширина этого слоя, разумеется,
увеличивается. С физической точки зрения, ситуация вполне очевидна.
Колебания вблизи сепаратрисы отвечают тому, что маятник при максимальном
отклонении почти достигает верхней точки. Если его в этот момент
подтолкнуть, то он пойдет, соответственно, вперед или назад. Роль такого
толчка выполняет внешняя сила, а результат зависит от того, на какой
момент по отношению к фазе воздействи япридется максимальное отклонение
маятника. Существенное обстоятельство состоит в том, что движение
обладает чувствительной зависимостью от начальных условий, а это как раз
основной атрибут хаотической динамики. В самом деле, если скорость
чуть-чуть больше, то маятник проскочит верхнее положение равновесия,
если скорость чуть-чуть меньше - не дойдет до него и двинется назад.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{25}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{scipy} \PY{k+kn}{import} \PY{n}{signal}
\PY{c+c1}{\PYZsh{}  нелинейные колебания с трением gamma \PYZlt{} omega0 и beta \PYZgt{} 0, F \PYZgt{} 0}
\PY{n}{x0} \PY{o}{=} \PY{l+m+mf}{0.01}
\PY{n}{p0} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{omega0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{gamma} \PY{o}{=} \PY{l+m+mf}{0.0}
\PY{n}{F} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{Fm} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{OMEGA} \PY{o}{=} \PY{l+m+mf}{0.33}
\PY{n}{beta} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{k} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}

\PY{n}{delta} \PY{o}{=} \PY{n}{OMEGA} \PY{o}{\PYZhy{}} \PY{n}{omega0}
\PY{n}{T} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi} \PY{o}{/} \PY{n}{OMEGA}

\PY{n}{t} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{,} \PY{l+m+mf}{0.01}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{o}{/}\PY{n}{OMEGA}\PY{p}{)}

\PY{n}{z0} \PY{o}{=} \PY{p}{[}\PY{n}{x0}\PY{p}{,} \PY{n}{p0}\PY{p}{]}
\PY{n}{sol1} \PY{o}{=} \PY{n}{odeintw}\PY{p}{(}\PY{n}{diff\PYZus{}eq1}\PY{p}{,} \PY{n}{z0}\PY{p}{,} \PY{n}{t}\PY{p}{,} \PY{n}{atol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{rtol}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}13}\PY{p}{,} \PY{n}{mxstep}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{)}
\PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{num\PYZus{}p} \PY{o}{=} \PY{n}{sol1}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{sol1}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{num\PYZus{}q}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ODEint}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.legend(bbox\PYZus{}to\PYZus{}anchor=(1.05, 1), loc=\PYZsq{}upper left\PYZsq{})}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.xlim([10, 20])}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time series for \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{gamma\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{gamma}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{omega\PYZus{}0\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{omega0}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{F}\PY{p}{)} \PY{o}{+}
         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}F\PYZus{}m=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{Fm}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Omega=\PYZdl{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{OMEGA}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}

\PY{n}{N} \PY{o}{=} \PY{l+m+mi}{1001}
\PY{n}{steps}\PY{o}{=}\PY{l+m+mi}{5000000}
\PY{n}{sol1} \PY{o}{=} \PY{n}{poincare}\PY{p}{(}\PY{n}{z0}\PY{p}{,} \PY{n}{N}\PY{p}{,} \PY{n}{steps}\PY{p}{)}
\PY{n}{xT}\PY{p}{,} \PY{n}{pT} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{real}\PY{p}{(}\PY{n}{sol1}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{xT}\PY{p}{,} \PY{n}{pT}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Poincare map}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.plot(num\PYZus{}q, num\PYZus{}p, label=\PYZsq{}phase trajectories\PYZsq{}, lw=0.5)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}x\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}p\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Poincare map, F = }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{F}\PY{p}{)}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.legend(bbox\PYZus{}to\PYZus{}anchor=(1.05, 1), loc=\PYZsq{}upper left\PYZsq{})}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{num\PYZus{}q}\PY{p}{)}\PY{p}{)}
\PY{n}{data} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{real}\PY{p}{(}\PY{n}{num\PYZus{}q}\PY{p}{)}
\PY{n}{fourier} \PY{o}{=} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{sp}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fft}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}
\PY{c+c1}{\PYZsh{}fourier = np.mean(fourier)}
\PY{n}{fourier} \PY{o}{/}\PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{fourier}\PY{p}{)}

\PY{n}{n} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{size}
\PY{n}{timestep} \PY{o}{=} \PY{l+m+mf}{0.01}
\PY{n}{freq} \PY{o}{=} \PY{n}{sp}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fftfreq}\PY{p}{(}\PY{n}{n}\PY{p}{,} \PY{n}{d}\PY{o}{=}\PY{n}{timestep}\PY{p}{)}
\PY{n}{mask} \PY{o}{=} \PY{n}{freq}\PY{o}{\PYZgt{}}\PY{o}{=}\PY{l+m+mi}{0}

\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{freq}\PY{p}{[}\PY{n}{mask}\PY{p}{]}\PY{p}{,} \PY{n}{fourier}\PY{p}{[}\PY{n}{mask}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SciPy PSD}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.plot(freq[\PYZti{}mask], fourier[\PYZti{}mask])  \PYZsh{}  отрицательная часть ввиду симметрии преобразования Фурье}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{omega\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}|x( }\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{omega)|\PYZca{}2\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}


\PY{n}{fs} \PY{o}{=} \PY{l+m+mf}{1e1}
\PY{c+c1}{\PYZsh{} signal.welch}
\PY{n}{f}\PY{p}{,} \PY{n}{Pxx\PYZus{}spec} \PY{o}{=} \PY{n}{signal}\PY{o}{.}\PY{n}{welch}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{fs}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{flattop}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{1024}\PY{p}{,} \PY{n}{scaling}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spectrum}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{semilogy}\PY{p}{(}\PY{n}{f}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{Pxx\PYZus{}spec}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{frequency}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Linear spectrum}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Power spectrum (scipy.signal.welch)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{}labels = [\PYZsq{}\PYZdl{}\PYZbs{}omega\PYZdl{}\PYZsq{}, \PYZsq{}\PYZdl{}2 \PYZbs{}omega\PYZdl{}\PYZsq{}, \PYZsq{}\PYZdl{}4 \PYZbs{}omega\PYZdl{}\PYZsq{}, \PYZsq{}\PYZdl{}6 \PYZbs{}omega\PYZdl{}\PYZsq{}, \PYZsq{}\PYZdl{}8 \PYZbs{}omega\PYZdl{}\PYZsq{}, \PYZsq{}\PYZdl{}10 \PYZbs{}omega\PYZdl{}\PYZsq{}]}
\PY{c+c1}{\PYZsh{}plt.xticks(np.arange(0, freqs[\PYZhy{}1] + 1, 1000), labels)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_47_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    
    \begin{Verbatim}[commandchars=\\\{\}]
HBox(children=(HTML(value=''), FloatProgress(value=0.0, max=1001.0), HTML(value='')))
    \end{Verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_47_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
5253
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_47_5.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_47_6.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{26}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{math}
\PY{k}{def} \PY{n+nf}{chirikov}\PY{p}{(}\PY{n}{z0}\PY{p}{)}\PY{p}{:}
    \PY{n}{x0}\PY{p}{,} \PY{n}{p0} \PY{o}{=} \PY{n}{z0}
    \PY{n}{a} \PY{o}{=} \PY{n}{math}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{x0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{n}{p0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{/} \PY{n}{omega0}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
    \PY{n}{wa} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{/}\PY{l+m+mi}{8} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{p}{(} \PY{n}{a} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{delta} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{n}{a} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{gamma} \PYZbs{}
    \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{l+m+mi}{3} \PY{o}{*} \PY{p}{(} \PY{n}{a} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{4} \PY{p}{)} \PY{o}{*} \PY{n}{beta} \PY{o}{*} \PY{n}{delta} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PYZbs{}
    \PY{l+m+mi}{32} \PY{o}{*} \PY{p}{(} \PY{n}{a} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{delta} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{*} \PY{n}{F} \PY{o}{+} \PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{9} \PY{o}{*} \PY{p}{(} \PY{n}{a} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{8} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PYZbs{}
    \PY{n}{beta} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{gamma} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{l+m+mi}{32} \PY{o}{*} \PY{p}{(} \PY{n}{a} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{*} \PY{n}{F} \PY{o}{*} \PY{p}{(} \PY{n}{gamma} \PYZbs{}
    \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{1}\PY{o}{/}\PY{l+m+mi}{2} \PY{p}{)} \PY{p}{)}
    
    \PY{n}{dwa} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{/}\PY{l+m+mi}{4} \PY{o}{*} \PY{p}{(} \PY{n}{a} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{p}{(} \PY{n}{delta} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{p}{(} \PY{n}{gamma} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PYZbs{}
    \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{p}{(} \PY{n}{a} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{l+m+mi}{32} \PY{o}{*} \PY{p}{(} \PY{n}{delta} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{*} \PY{n}{F} \PY{o}{+} \PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{9} \PY{o}{*} \PY{p}{(} \PY{n}{a} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PYZbs{}
    \PY{l+m+mi}{6} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{beta} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{l+m+mi}{32} \PY{o}{*} \PY{n}{F} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{gamma} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{o}{/}\PY{l+m+mi}{2} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PYZbs{}
    \PY{o}{\PYZhy{}}\PY{l+m+mi}{16} \PY{o}{*} \PY{p}{(} \PY{n}{delta} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{*} \PY{n}{F} \PY{o}{+} \PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{*} \PY{p}{(} \PY{l+m+mi}{9} \PY{o}{*} \PY{p}{(} \PY{n}{a} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{6} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{beta} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PYZbs{}
    \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{l+m+mi}{16} \PY{o}{*} \PY{n}{F} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{gamma} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{l+m+mi}{3} \PY{o}{*} \PY{p}{(} \PY{n}{a} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{*} \PY{n}{beta} \PY{o}{*} \PY{n}{delta} \PY{o}{*} \PYZbs{}
    \PY{p}{(} \PY{p}{(} \PY{n}{a} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{l+m+mi}{32} \PY{o}{*} \PY{p}{(} \PY{n}{delta} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{*} \PY{n}{F} \PY{o}{+} \PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{9} \PY{o}{*} \PY{p}{(} \PY{n}{a} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{6} \PY{p}{)} \PY{o}{*} \PYZbs{}
    \PY{p}{(} \PY{n}{beta} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{o}{+} \PY{l+m+mi}{32} \PY{o}{*} \PY{n}{F} \PY{p}{)} \PY{o}{*} \PY{p}{(} \PY{n}{gamma} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{2} \PY{p}{)} \PY{p}{)} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{l+m+mi}{1}\PY{o}{/}\PY{l+m+mi}{2} \PY{p}{)} \PY{p}{)} \PY{p}{)}
    
    \PY{n}{chir} \PY{o}{=} \PY{n}{math}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(} \PY{n}{F} \PY{o}{*} \PY{n}{dwa} \PY{o}{*} \PY{p}{(} \PY{n}{wa} \PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{)} \PY{p}{)} \PY{p}{)}
    \PY{k}{return}\PY{p}{(}\PY{n}{chir}\PY{p}{)}

\PY{n}{chirikov}\PY{p}{(}\PY{n}{z0}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{26}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
10.000002651648671
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{ux431ux438ux444ux443ux440ux43aux430ux446ux438ux43eux43dux43dux430ux44f-ux434ux438ux430ux433ux440ux430ux43cux43cux430-ux438-ux433ux43bux430ux432ux43dux44bux439-ux43fux43eux43aux430ux437ux430ux442ux435ux43bux44c-ux43bux44fux43fux443ux43dux43eux432ux430}{%
\subsection{4.2 Бифуркационная диаграмма и главный показатель
Ляпунова}\label{ux431ux438ux444ux443ux440ux43aux430ux446ux438ux43eux43dux43dux430ux44f-ux434ux438ux430ux433ux440ux430ux43cux43cux430-ux438-ux433ux43bux430ux432ux43dux44bux439-ux43fux43eux43aux430ux437ux430ux442ux435ux43bux44c-ux43bux44fux43fux443ux43dux43eux432ux430}}

На рисунке показана возможная бифуркационная диаграмма для системы при
амплитудах воздействия в диапазоне \(0 < F < 0.7\). Вертикальная ось,
помеченная \(r\), представляет собой расстояние от точки на отображении
Пуанкаре до начала координат \((r = \sqrt{x^2 + p^2})\).

\textbf{Старший показатель Ляпунова}. Для оценки хаотичности системы
используется старший показатель Ляпунова. Критерий стохастичности
формулируется так: если все установившееся траектории, располагающиеся в
ограниченной области фазового пространства, неустойчивы, то их поведение
стохастическое. Если установившееся траектория находится в ограниченной
области фазового пространства, то она рано или поздно подойдет к той
точке, из которой вышла (в гамильтоновых системах это верно для любых
траекторий). Пойдет ли она дальше по этому пути? Нет, если траектория
неустойчива, то отклонение должно нарастать. Таким образом, если у
траекторий и есть похожие участки, то через определенное время схожесть
исчезнет.

Простейший способ исследования устойчивости состоит в следующем: сначала
вычисляется некоторое решение \(x_1(t)\). Затем задается смещение
начальных условий и процедура повторяется, находится новое решение
\(x_2(t)\). Логарифм разности \(\ln{|x_1(t) - x_2(t)|}\) строится как
функция времени: траектории разбиваются на последовательные ортезки, на
каждом из них высчитывается логарифм разности, и среднее значение от
логарифмов в конце отрезков дает искомую величину \(\lambda\). Если
\(\lambda < 0\), то движение считается регулярным, если \(\lambda > 0\)
- стохастическим.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{27}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{integrate} \PY{k+kn}{import} \PY{n}{odeint}
\PY{n}{x0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{p0} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{omega0} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{gamma} \PY{o}{=} \PY{l+m+mf}{0.15}
\PY{n}{Fm} \PY{o}{=} \PY{l+m+mf}{0.0}
\PY{n}{OMEGA} \PY{o}{=} \PY{l+m+mf}{1.2}
\PY{n}{T} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi} \PY{o}{/} \PY{n}{OMEGA}
\PY{n}{beta} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{k} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}

\PY{n}{rs\PYZus{}up} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{rs\PYZus{}down} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{steps} \PY{o}{=} \PY{l+m+mi}{5000}

\PY{c+c1}{\PYZsh{} Take num\PYZus{}steps=4000 to get Figure 9.13.}
\PY{n}{num\PYZus{}steps} \PY{o}{=} \PY{l+m+mi}{7002}
\PY{n}{step} \PY{o}{=} \PY{l+m+mf}{0.0001}
\PY{n}{interval} \PY{o}{=} \PY{n}{num\PYZus{}steps} \PY{o}{*} \PY{n}{step}
\PY{n}{a}\PY{p}{,} \PY{n}{b} \PY{o}{=} \PY{n}{x0}\PY{p}{,} \PY{n}{p0}
\PY{n}{ns} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{num\PYZus{}steps}\PY{p}{,} \PY{n}{num\PYZus{}steps}\PY{p}{)}
\PY{n}{lyaps} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{lyaps1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{chirikovs} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{chirikovs1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{shift} \PY{o}{=} \PY{l+m+mf}{1e\PYZhy{}1}

\PY{c+c1}{\PYZsh{} Ramp the amplitude of vibration, gamma, up.}
\PY{k}{for} \PY{n}{n} \PY{o+ow}{in} \PY{n}{notebook}\PY{o}{.}\PY{n}{tqdm}\PY{p}{(}\PY{n}{ns}\PY{p}{)}\PY{p}{:}
    \PY{n}{F} \PY{o}{=} \PY{n}{step} \PY{o}{*} \PY{n}{n}
    \PY{n}{t} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mf}{0.0}\PY{p}{,} \PY{p}{(}\PY{l+m+mi}{4}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{p}{)} \PY{o}{/} \PY{n}{OMEGA}\PY{p}{,} \PY{l+m+mi}{200}\PY{p}{)}
    \PY{n}{xs} \PY{o}{=} \PY{n}{odeint}\PY{p}{(}\PY{n}{diff\PYZus{}eq1}\PY{p}{,} \PY{p}{[}\PY{n}{a}\PY{p}{,} \PY{n}{b}\PY{p}{]}\PY{p}{,} \PY{n}{t}\PY{p}{,} \PY{n}{mxstep}\PY{o}{=}\PY{n}{steps}\PY{p}{)}
    \PY{n}{xs1} \PY{o}{=} \PY{n}{odeint}\PY{p}{(}\PY{n}{diff\PYZus{}eq1}\PY{p}{,} \PY{p}{[}\PY{n}{a} \PY{o}{+} \PY{n}{shift}\PY{p}{,} \PY{n}{b}\PY{p}{]}\PY{p}{,} \PY{n}{t}\PY{p}{,} \PY{n}{mxstep}\PY{o}{=}\PY{n}{steps}\PY{p}{)}
    \PY{n}{dx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{xs}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{xs1}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
    \PY{n}{dp} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{xs}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{xs1}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
    \PY{n}{Dist} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{dx}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{n}{dp}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
    \PY{n}{LogDist} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{Dist}\PY{p}{)}
    \PY{n}{lyaps}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{LogDist}\PY{p}{)}\PY{p}{)}
    \PY{n}{chirikovs}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{chirikov}\PY{p}{(}\PY{p}{[}\PY{n}{a}\PY{p}{,} \PY{n}{b}\PY{p}{]}\PY{p}{)}\PY{p}{)}
    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{:}
        \PY{n}{a} \PY{o}{=} \PY{n}{xs}\PY{p}{[}\PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}
        \PY{n}{b} \PY{o}{=} \PY{n}{xs}\PY{p}{[}\PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{r} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{a}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{n}{b}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{rs\PYZus{}up}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{n}\PY{p}{,} \PY{n}{r}\PY{p}{]}\PY{p}{)} 
    
\PY{n}{rs\PYZus{}up} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{rs\PYZus{}up}\PY{p}{)}
\PY{n}{lyaps} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{lyaps}\PY{p}{)}
\PY{n}{chirikovs} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{chirikovs}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Ramp the amplitude of vibration, gamma, down.}
\PY{k}{for} \PY{n}{n} \PY{o+ow}{in} \PY{n}{notebook}\PY{o}{.}\PY{n}{tqdm}\PY{p}{(}\PY{n}{ns}\PY{p}{)}\PY{p}{:}
    \PY{n}{F} \PY{o}{=} \PY{n}{interval} \PY{o}{\PYZhy{}} \PY{n}{step} \PY{o}{*} \PY{n}{n}
    \PY{n}{t} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mf}{0.0}\PY{p}{,} \PY{p}{(}\PY{l+m+mi}{4}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{p}{)} \PY{o}{/} \PY{n}{OMEGA}\PY{p}{,} \PY{l+m+mi}{200}\PY{p}{)}
    \PY{n}{xs} \PY{o}{=} \PY{n}{odeint}\PY{p}{(}\PY{n}{diff\PYZus{}eq1}\PY{p}{,} \PY{p}{[}\PY{n}{a}\PY{p}{,} \PY{n}{b}\PY{p}{]}\PY{p}{,} \PY{n}{t}\PY{p}{,} \PY{n}{mxstep}\PY{o}{=}\PY{n}{steps}\PY{p}{)}
    \PY{n}{xs1} \PY{o}{=} \PY{n}{odeint}\PY{p}{(}\PY{n}{diff\PYZus{}eq1}\PY{p}{,} \PY{p}{[}\PY{n}{a} \PY{o}{+} \PY{n}{shift}\PY{p}{,} \PY{n}{b}\PY{p}{]}\PY{p}{,} \PY{n}{t}\PY{p}{,} \PY{n}{mxstep}\PY{o}{=}\PY{n}{steps}\PY{p}{)}
    \PY{n}{dx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{xs}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{xs1}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
    \PY{n}{dp} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{xs}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{xs1}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
    \PY{n}{Dist} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{dx}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{n}{dp}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
    \PY{n}{LogDist} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{Dist}\PY{p}{)}
    \PY{n}{lyaps1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{LogDist}\PY{p}{)}\PY{p}{)}
    \PY{n}{chirikovs1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{chirikov}\PY{p}{(}\PY{p}{[}\PY{n}{a}\PY{p}{,} \PY{n}{b}\PY{p}{]}\PY{p}{)}\PY{p}{)}
    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{:}
        \PY{n}{a} \PY{o}{=} \PY{n}{xs}\PY{p}{[}\PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}
        \PY{n}{b} \PY{o}{=} \PY{n}{xs}\PY{p}{[}\PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{r} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{a}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{n}{b}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{rs\PYZus{}down}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{num\PYZus{}steps} \PY{o}{\PYZhy{}} \PY{n}{n}\PY{p}{,} \PY{n}{r}\PY{p}{]}\PY{p}{)} 
    
\PY{n}{rs\PYZus{}down} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{rs\PYZus{}down}\PY{p}{)}
\PY{n}{lyaps1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{lyaps1}\PY{p}{)}
\PY{n}{chirikovs1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{chirikovs1}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    
    \begin{Verbatim}[commandchars=\\\{\}]
HBox(children=(HTML(value=''), FloatProgress(value=0.0, max=7002.0), HTML(value='')))
    \end{Verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
<ipython-input-26-d6f121899cda>:6: RuntimeWarning: invalid value encountered in
double\_scalars
  )**( 2 ) ) )**( -1 ) * ( 3 * ( a )**( 4 ) * beta * delta -1 * ( ( \textbackslash{}
<ipython-input-26-d6f121899cda>:12: RuntimeWarning: invalid value encountered in
double\_scalars
  -1 ) * ( ( a )**( 2 ) * ( 32 * ( delta )**( 2 ) * F + ( -9 * ( a )**( \textbackslash{}
<ipython-input-26-d6f121899cda>:16: RuntimeWarning: invalid value encountered in
double\_scalars
  ( ( a )**( 2 ) * ( 32 * ( delta )**( 2 ) * F + ( -9 * ( a )**( 6 ) * \textbackslash{}
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]

    \end{Verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
HBox(children=(HTML(value=''), FloatProgress(value=0.0, max=7002.0), HTML(value='')))
    \end{Verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]

    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{28}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{rs\PYZus{}up}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{n}{step}\PY{p}{,} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{rs\PYZus{}up}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{+} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ms}\PY{o}{=}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}4r + 2\PYZdl{} up}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{rs\PYZus{}down}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{n}{step}\PY{p}{,} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{rs\PYZus{}down}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{+} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ms}\PY{o}{=}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}4r + 2\PYZdl{} down}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{axhline}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{ns}\PY{o}{*}\PY{n}{step}\PY{p}{,} \PY{n}{lyaps}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ms}\PY{o}{=}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{lambda\PYZdl{} (LogDist) up, shift=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{shift}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{ns}\PY{o}{*}\PY{n}{step}\PY{p}{,} \PY{n}{lyaps1}\PY{p}{[}\PY{p}{:}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{l+m+mi}{5}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{orange}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ms}\PY{o}{=}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{lambda\PYZdl{} (LogDist) down, shift=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{shift}\PY{p}{)} \PY{o}{+} 
         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{,}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{ zero at y=\PYZhy{}5}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{axhline}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}F\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}r\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{} Plot legend.}
\PY{n}{lgnd} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{}change the marker size manually for both lines}
\PY{n}{lgnd}\PY{o}{.}\PY{n}{legendHandles}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{\PYZus{}legmarker}\PY{o}{.}\PY{n}{set\PYZus{}markersize}\PY{p}{(}\PY{l+m+mi}{6}\PY{p}{)}
\PY{n}{lgnd}\PY{o}{.}\PY{n}{legendHandles}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{\PYZus{}legmarker}\PY{o}{.}\PY{n}{set\PYZus{}markersize}\PY{p}{(}\PY{l+m+mi}{6}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.ylim([\PYZhy{}0.1,0.1])}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
   
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{ns}\PY{o}{*}\PY{n}{step}\PY{p}{,} \PY{n}{chirikovs}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cyan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Chirikov}\PY{l+s+se}{\PYZbs{}\PYZsq{}}\PY{l+s+s1}{s up}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{ns}\PY{o}{*}\PY{n}{step}\PY{p}{,} \PY{n}{chirikovs1}\PY{p}{[}\PY{p}{:}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{green}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Chirikov}\PY{l+s+se}{\PYZbs{}\PYZsq{}}\PY{l+s+s1}{s down}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{axhline}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}F\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}Chirikov\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{} Plot legend.}
\PY{n}{lgnd} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{}change the marker size manually for both lines}
\PY{n}{lgnd}\PY{o}{.}\PY{n}{legendHandles}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{\PYZus{}legmarker}\PY{o}{.}\PY{n}{set\PYZus{}markersize}\PY{p}{(}\PY{l+m+mi}{6}\PY{p}{)}
\PY{n}{lgnd}\PY{o}{.}\PY{n}{legendHandles}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{\PYZus{}legmarker}\PY{o}{.}\PY{n}{set\PYZus{}markersize}\PY{p}{(}\PY{l+m+mi}{6}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}

\PY{n}{fig}\PY{p}{,} \PY{n}{axs} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{subplots\PYZus{}adjust}\PY{p}{(}\PY{n}{hspace}\PY{o}{=}\PY{l+m+mf}{0.7}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{rs\PYZus{}up}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{n}{step}\PY{p}{,} \PY{n}{rs\PYZus{}up}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ms}\PY{o}{=}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}4r + 2\PYZdl{} up}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{rs\PYZus{}down}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{n}{step}\PY{p}{,} \PY{n}{rs\PYZus{}down}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ms}\PY{o}{=}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}4r + 2\PYZdl{} down}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{axhline}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Largest Lyapunov exponent}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{ns}\PY{o}{*}\PY{n}{step}\PY{p}{,} \PY{n}{chirikovs}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Chirikov}\PY{l+s+se}{\PYZbs{}\PYZsq{}}\PY{l+s+s1}{s up}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{ns}\PY{o}{*}\PY{n}{step}\PY{p}{,} \PY{n}{chirikovs1}\PY{p}{[}\PY{p}{:}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Chirikov}\PY{l+s+se}{\PYZbs{}\PYZsq{}}\PY{l+s+s1}{s down}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{axhline}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Chirikov}\PY{l+s+se}{\PYZbs{}\PYZsq{}}\PY{l+s+s1}{s criteria}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{xlabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}F\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ylabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Chirikov}\PY{l+s+se}{\PYZbs{}\PYZsq{}}\PY{l+s+s1}{s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{xlabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}F\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ylabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{lambda\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{fig}\PY{p}{,} \PY{n}{axs} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{subplots\PYZus{}adjust}\PY{p}{(}\PY{n}{hspace}\PY{o}{=}\PY{l+m+mf}{0.7}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Largest Lyapunov exponent}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{ns}\PY{o}{*}\PY{n}{step}\PY{p}{,} \PY{n}{lyaps}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ms}\PY{o}{=}\PY{l+m+mf}{0.1}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{axhline}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{lambda\PYZdl{} (LogDist) up}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{ns}\PY{o}{*}\PY{n}{step}\PY{p}{,} \PY{n}{lyaps1}\PY{p}{[}\PY{p}{:}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{orange}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ms}\PY{o}{=}\PY{l+m+mf}{0.1}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{axhline}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{)}
\PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{k}{for} \PY{n}{ax} \PY{o+ow}{in} \PY{n}{axs}\PY{o}{.}\PY{n}{flat}\PY{p}{:}
    \PY{n}{ax}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{xlabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}F\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ylabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{lambda\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_51_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_51_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_51_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_51_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Параметр \(F\) увеличивается от нуля до 0.7, а затем уменьшается с
\(F = 0.4\) до нуля. Было использовано 4000 итераций. Сплошная кривая,
лежащая приблизительно между \(0 \leq F \leq 0.29\), соответствует
регулярному движению. Когда \(F\) превышает значение 0.29, система
переходит в хаотический режим и возвращается к периодическому поведению
в точке \(F = 0.34\), затем подобная картина наблюдается еще раз. При
уменьшении параметра \(F\) система возвращается по периодическим путям,
входит в хаотическую область, возвращаясь к стационарному решению при
\(F \approx 0.28\). Обратите внимание, что на этапе увеличения амплитуды
силы, установившееся состояние переходит в область, где система имеет
два периода, примерно \$ 0.28 \textless{} F \textless{} 0.29\$.

    \hypertarget{ux43aux43eux440ux440ux435ux43bux44fux446ux438ux43eux43dux43dux430ux44f-ux444ux443ux43dux43aux446ux438ux44f}{%
\subsection{4.3 Корреляционная
функция}\label{ux43aux43eux440ux440ux435ux43bux44fux446ux438ux43eux43dux43dux430ux44f-ux444ux443ux43dux43aux446ux438ux44f}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{29}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{num\PYZus{}q}\PY{p}{)}\PY{p}{)}
\PY{n}{data} \PY{o}{=} \PY{n}{num\PYZus{}q}
\PY{n}{Mc} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{data}\PY{p}{)} \PY{o}{/} \PY{l+m+mi}{2}\PY{p}{)}
\PY{n}{Mc} \PY{o}{=} \PY{l+m+mi}{500}
\PY{n}{sx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{data}\PY{p}{)}
\PY{n}{Vx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{var}\PY{p}{(}\PY{n}{data}\PY{p}{)}
\PY{n}{Nsteps} \PY{o}{=} \PY{l+m+mi}{500}

\PY{n}{dxt} \PY{o}{=} \PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{sx} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{Mc}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}

\PY{n}{R} \PY{o}{=} \PY{p}{[}\PY{p}{]}

\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{Mc}\PY{p}{)}\PY{p}{:}
    
    \PY{n}{summ} \PY{o}{=} \PY{l+m+mi}{0}
    
    \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{i}\PY{p}{,} \PY{n}{Nsteps}\PY{p}{)}\PY{p}{:}
        
        \PY{n}{summ} \PY{o}{+}\PY{o}{=} \PY{n}{dxt}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{o}{*}\PY{n}{dxt}\PY{p}{[}\PY{n}{j} \PY{o}{\PYZhy{}} \PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{]}
    \PY{n}{R}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{summ} \PY{o}{/} \PY{p}{(}\PY{p}{(}\PY{n}{Nsteps} \PY{o}{+} \PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{i}\PY{p}{)} \PY{o}{*} \PY{n}{Vx}\PY{p}{)}\PY{p}{)}

    
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}i\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}R\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{}plt.tick\PYZus{}params(labelsize=lblsize)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{R}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
5253
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_54_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{30}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Plot autocorrelation}
\PY{n}{plt}\PY{o}{.}\PY{n}{acorr}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{maxlags}\PY{o}{=}\PY{n}{data}\PY{o}{.}\PY{n}{size}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Add labels to autocorrelation plot}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Autocorrelation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Lag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Autocorrelation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Display the autocorrelation plot}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Lab_work_files/Lab_work_55_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]

\end{Verbatim}
\end{tcolorbox}


    % Add a bibliography block to the postdoc
    
    
    
\end{document}
